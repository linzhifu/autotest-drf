webpackJsonp([1],{"7xIN":function(e,t){},"9X0j":function(e,t){},CuRo:function(e,t){},ExMG:function(e,t){},HjVx:function(e,t){},HxVy:function(e,t){},K67B:function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("7+uW"),r={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var i=s("VU/8")({name:"App"},r,!1,function(e){s("HxVy")},null,null).exports,n=s("/ocq"),o={name:"Login",data:function(){return{url:this.url,imageUrl:"../assets/img/login-img.png",axios:this.axios,username:"",email:"",password:"",captcha:"",activeName:"",storage:this.storage,is_ok:!1,captcha_button:"获取验证码"}},methods:{login:function(e){var t=this;if("email"!=e||this.check_email(this.email)){if("username"==e){if(!this.username)return void this.$message({message:"用户名不能为空",type:"error",center:!0});if(!this.password)return void this.$message({message:"密码不能为空",type:"error",center:!0})}var s={type:e,username:this.username,password:this.password,email:this.email,captcha:this.captcha};this.axios({baseURL:this.url,url:"api/v1/login/",method:"post",data:s}).then(function(e){e.data.errcode?t.$message({message:e.data.errmsg,type:"error",center:!0}):(t.storage.setItem("userId",e.data.data.id),t.storage.setItem("token",e.data.token),t.$router.push({path:"/home/"}))},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}},get_captcha:function(){var e=this;if(this.check_email(this.email)){var t={email:this.email};this.captcha_button="发送中...",this.axios({baseURL:this.url,url:"api/v1/captcha/",method:"get",params:t}).then(function(t){if(t.data.errcode)e.$message({message:t.data.errmsg,type:"error",center:!0}),e.is_ok=!1;else{e.$message({message:"发送成功",type:"success",center:!0});var s=60;e.captcha_button=s+"s";var a=setInterval(function(){s<=1?(e.is_ok=!1,clearInterval(a),e.captcha_button="获取验证码"):(s--,e.captcha_button=s+"s")},1e3)}},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0}),e.is_ok=!1})}},check_email:function(e){return!!/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/.test(e)||(this.$message({message:"邮箱格式不对，请重新输入",type:"error",center:!0}),!1)}}},l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e._m(0),e._v(" "),s("el-tabs",{attrs:{type:"border-card",value:"first"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"用户名登陆"}},[s("el-input",{attrs:{placeholder:"请输入用户名",clearable:"",required:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),e._v(" "),s("el-input",{attrs:{placeholder:"请输入登陆密码","show-password":"",clearable:""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),e._v(" "),s("el-button",{attrs:{id:"login",type:"primary"},on:{click:function(t){return e.login("username")}}},[e._v("登陆")])],1),e._v(" "),s("el-tab-pane",{attrs:{label:"邮箱登陆",name:"second"}},[s("el-input",{attrs:{type:"email",placeholder:"请输入邮箱",clearable:""},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),e._v(" "),s("el-input",{attrs:{placeholder:"请输入验证码",clearable:""},model:{value:e.captcha,callback:function(t){e.captcha=t},expression:"captcha"}},[s("el-button",{staticStyle:{margin:"-10px 0"},attrs:{slot:"append",disabled:e.is_ok},on:{click:e.get_captcha},slot:"append"},[e._v(e._s(e.captcha_button))])],1),e._v(" "),s("el-button",{attrs:{id:"login",type:"primary"},on:{click:function(t){return e.login("email")}}},[e._v("登陆")])],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"login_img"}},[t("img",{attrs:{src:s("xzo/"),alt:""}})])}]};var c=s("VU/8")(o,l,!1,function(e){s("asmU")},"data-v-219f2d65",null).exports,p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("el-header",[s("el-menu",{attrs:{mode:"horizontal","default-active":e.$route.path,"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b",router:""}},[s("el-menu-item",{attrs:{index:"/home/user"}},[s("i",{staticClass:"el-icon-thirdshanghuhaopeizhi"}),e._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[e._v("用户中心")])]),e._v(" "),s("el-menu-item",{attrs:{index:"/home/project"}},[s("i",{staticClass:"el-icon-menu"}),e._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[e._v("项目中心")])]),e._v(" "),s("el-menu-item",{attrs:{index:"/home/report/"}},[s("i",{staticClass:"el-icon-document"}),e._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[e._v("测试报告")])]),e._v(" "),s("el-menu-item",{attrs:{index:"/home/log/"}},[s("i",{staticClass:"el-icon-document"}),e._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[e._v("测试LOG")])])],1)],1),e._v(" "),s("el-main",[s("router-view")],1)],1)},staticRenderFns:[]};var d=s("VU/8")({name:"Home"},p,!1,function(e){s("adur")},"data-v-6a6f1d10",null).exports,u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-collapse",{attrs:{accordion:""},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-collapse-item",{attrs:{title:"个人资料",name:"1"}},[s("p",[e._v("用户名："+e._s(e.username))]),e._v(" "),s("p",[e._v("邮箱    ："+e._s(e.email))])]),e._v(" "),s("el-collapse-item",{attrs:{title:"修改用户名",name:"2"}},[s("br"),e._v(" "),s("el-input",{attrs:{placeholder:"请输入用户名",clearable:""},model:{value:e.username_new,callback:function(t){e.username_new=t},expression:"username_new"}}),e._v(" "),s("br"),s("br"),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.update_username}},[e._v("确认")])],1),e._v(" "),s("el-collapse-item",{attrs:{title:"修改密码",name:"3"}},[s("br"),e._v(" "),s("el-input",{attrs:{placeholder:"请输入密码，确保两次输入一致","show-password":"",clearable:""},model:{value:e.password_1,callback:function(t){e.password_1=t},expression:"password_1"}},[s("template",{slot:"prepend"},[e._v("密码")])],2),e._v(" "),s("br"),s("br"),e._v(" "),s("el-input",{attrs:{placeholder:"请输入密码，确保两次输入一致","show-password":"",clearable:""},model:{value:e.password_2,callback:function(t){e.password_2=t},expression:"password_2"}},[s("template",{slot:"prepend"},[e._v("密码")])],2),e._v(" "),s("br"),s("br"),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.update_password}},[e._v("修改密码")])],1)],1),e._v(" "),s("br"),s("br"),e._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:e.logout}},[e._v("注销用户")])],1)},staticRenderFns:[]};var m=s("VU/8")({name:"User",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),username:"",username_new:"",email:"",password_1:"",password_2:"",activeName:"1"}},methods:{get_user:function(){var e=this,t={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"v1/user/"+this.userId+"/",method:"get",params:t}).then(function(t){e.username=t.data.data.username,e.email=t.data.data.email},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},update_username:function(){var e=this,t={userId:this.userId,token:this.token},s={username:this.username_new};this.axios({baseURL:this.url,url:"v1/user/"+this.userId+"/",method:"patch",params:t,data:s}).then(function(t){t.data.errcode?e.$message({message:"修改失败",type:"error",center:!0}):(e.$message({message:"修改成功",type:"success",center:!0}),e.username=e.username_new,e.username_new="")},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})},update_password:function(){var e=this;if(this.password_1&&this.password_1==this.password_2){var t={userId:this.userId,token:this.token},s={password:this.password_1};this.axios({baseURL:this.url,url:"v1/user/"+this.userId+"/",method:"patch",params:t,data:s}).then(function(t){t.data.errcode?e.$message({message:"修改失败",type:"error",center:!0}):e.$message({message:"修改成功",type:"success",center:!0})},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"两次密码不一致，请重新输入",type:"error",center:!0});this.password_1=this.password_2=""},logout:function(){this.storage.removeItem("userId"),this.storage.removeItem("token"),this.$router.push("/")}},beforeCreate:function(){},created:function(){this.get_user()}},u,!1,function(e){s("9X0j")},"data-v-4f7c8363",null).exports,h=s("NC6I"),g=s.n(h),b={name:"Project",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),testUserId:this.storage.getItem("testUserId"),testUserToken:this.storage.getItem("testUserToken"),adminUserId:this.storage.getItem("adminUserId"),adminUserToken:this.storage.getItem("adminUserToken"),adminUser:"",adminPsw:"",testUser:"",testPsw:"",testBtn:"开始测试",loading:!1,passText:"PASS",failText:"FAIL",proname:"",prodes:"",projects:[],search:"",pre:"",next:"",isNextDisabled:!1,isPreDisabled:!1,dialogFormVisible:!1,editObj:{id:"",proname:"",prodes:""}}},methods:{get_testUser:function(){var e=this,t="https://mpstest.longsys.com",s={email:this.adminUser,pswmd5:g()(this.adminPsw),timestamp:Date.parse(new Date)},a={email:this.testUser,pswmd5:g()(this.testPsw),timestamp:Date.parse(new Date)};this.axios({baseURL:t,url:"/api/v1/user/login",method:"post",data:s}).then(function(s){"0"==s.data.errcode?(e.storage.setItem("adminUserId",s.data.data.userid),e.storage.setItem("adminUserToken",s.data.data.token),e.adminUserId=s.data.data.userid,e.adminUserToken=s.data.data.token,e.axios({baseURL:t,url:"/api/v1/user/login",method:"post",data:a}).then(function(t){"0"==t.data.errcode?(e.storage.setItem("testUserId",t.data.data.userid),e.storage.setItem("testUserToken",t.data.data.token),e.testUserId=e.storage.getItem("testUserId"),e.testUserToken=e.storage.getItem("testUserToken")):(e.$message({message:"测试用户账户密码异常，请重新设置",type:"error",center:!0,showClose:!0,duration:0}),e.testUserFormVisible=!0)},function(t){e.$message({message:"服务器错误，请检查 "+e.baseurl+" 服务器是否正常",type:"error",center:!0,showClose:!0,duration:0})})):(e.$message({message:"管理员账户密码异常，请重新设置",type:"error",center:!0,showClose:!0,duration:0}),e.testUserFormVisible=!0)},function(t){e.$message({message:"服务器错误，请检查 "+e.baseurl+" 服务器是否正常",type:"error",center:!0,showClose:!0,duration:0})})},projectTest:function(e){var t=this;this.$confirm("项目测试需要等待时间较长, 是否开始测试?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$message({message:"测试开始",type:"success",center:!0,showClose:!0}),t.passText=t.failText='<p class="el-icon-loading"></p>';var s={userId:t.userId,token:t.token,projectId:e.id},a={};if("量产云平台"==e.proname)a={testUserInfo:{testUserId:t.testUserId,testUserToken:t.testUserToken,adminUserId:t.adminUserId,adminUserToken:t.adminUserToken}};t.axios({baseURL:t.url,url:"/api/v1/projectTest/",method:"post",params:s,data:a}).then(function(s){s.data.errcode?t.$message({message:s.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):t.$message({message:e.proname+" 测试 PASS",type:"success",center:!0,showClose:!0,duration:0}),t.passText="PASS",t.failText="FAIL",t.get_projects()},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),t.passText="PASS",t.failText="FAIL",t.testBtn="开始测试"})}).catch(function(){})},get_projects:function(){var e=this,t={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/project/",method:"get",params:t}).then(function(t){e.projects=t.data.results,e.pre=t.data.previous;for(var s=0,a=e.projects.length;s<a;s++)"量产云平台"==e.projects[s].proname&&(e.adminUser=e.projects[s].adminUser,e.adminPsw=e.projects[s].adminPsw,e.testUser=e.projects[s].testUser,e.testPsw=e.projects[s].testPsw,e.get_testUser());e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},open_edit:function(e){this.dialogFormVisible=!0,this.editObj.id=e.id,this.editObj.proname=e.proname,this.editObj.prodes=e.prodes},handleEdit:function(e){var t=this;if(e.proname&&e.prodes){this.dialogFormVisible=!1;var s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/project/"+e.id+"/",method:"patch",params:s,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),t.get_projects())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"项目名称和描述不能为空",type:"error",center:!0})},handleDelete:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/project/"+t.id+"/",method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):s.$message({message:"删除成功",type:"success",center:!0}),s.get_projects()},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(e){})},new_product:function(){var e=this;if(this.proname&&this.prodes){var t={proname:this.proname,prodes:this.prodes,user:this.userId},s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/project/",method:"post",params:s,data:t}).then(function(t){t.data.errcode?e.$message({message:"新建失败",type:"error",center:!0}):(e.$message({message:"新建成功",type:"success",center:!0}),e.get_projects())},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.proname="",this.prodes=""}else this.$message({message:"项目名称和描述不能为空",type:"error",center:!0})},get_pre:function(){var e=this;this.axios({url:this.pre,method:"get"}).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.projects=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},get_next:function(){var e=this;this.axios({url:this.next,method:"get"}).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.projects=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},go_webTest:function(e){var t={projectId:e.id,projectName:e.proname};this.$router.push({path:"/home/webManager/",query:t})},go_apiTest:function(e){var t={projectId:e.id,projectName:e.proname,adminUser:e.adminUser,adminPsw:e.adminPsw,testUser:e.testUser,testPsw:e.testPsw};this.$router.push({path:"/home/apiManager/",query:t})},go_appTest:function(e){var t={projectId:e.id,projectName:e.proname};this.$router.push({path:"/home/appManager/",query:t})},go_report:function(e){var t={projectName:e.proname};this.$router.push({path:"/home/report/",query:t})}},beforeCreate:function(){},created:function(){this.get_projects()},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}}},f={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{attrs:{id:"add_project"}},[s("el-button",{attrs:{type:"primary"},on:{click:e.new_product}},[e._v("新建项目")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"项目名称"},model:{value:e.proname,callback:function(t){e.proname=t},expression:"proname"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"项目描述"},model:{value:e.prodes,callback:function(t){e.prodes=t},expression:"prodes"}}),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{stripe:"",border:"",data:e.projects.filter(function(t){return!e.search||t.proname.toLowerCase().includes(e.search.toLowerCase())||t.prodes.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"项目名称",align:"center",prop:"proname",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{label:"项目描述",align:"center",prop:"prodes"}}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center",prop:"update_time",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"前端",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击加入前端测试",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.go_webTest(t.row)}}},[t.row.webresult?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"后端",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击加入后端测试",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.go_apiTest(t.row)}}},[t.row.apiresult?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"移动端",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击加入移动端测试",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.go_appTest(t.row)}}},[t.row.appresult?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"测试结果",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击开始项目测试(前端+后端)",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.projectTest(t.row)}}},[t.row.result?s("p",{staticStyle:{color:"green"},domProps:{innerHTML:e._s(e.passText)}}):s("p",{staticStyle:{color:"red"},domProps:{innerHTML:e._s(e.failText)}})])])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"测试报告",placement:"top"}},[s("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-document"},on:{click:function(s){return e.go_report(t.row)}}})],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"项目名称","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.proname,callback:function(t){e.$set(e.editObj,"proname",t)},expression:"editObj.proname"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"项目描述","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.prodes,callback:function(t){e.$set(e.editObj,"prodes",t)},expression:"editObj.prodes"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(e.editObj)}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var _=s("VU/8")(b,f,!1,function(e){s("wZ+D")},"data-v-091d6694",null).exports,v={name:"WebManager",data:function(){return{activeName:"1",axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),testBtn:"开始测试",loading:!1,webname:"",webdes:"",weburl:"",appsrcname:"",appsrcdes:"",search:"",webManagers:[],appSrcCases:[],webAutoTests:[],project_options:[],pre:"",next:"",isNextDisabled:!1,isPreDisabled:!1,pre_src:"",next_src:"",isNextDisabled_src:!1,isPreDisabled_src:!1,projectId:this.$route.query.projectId,dialogFormVisible:!1,dialogFormVisible_src:!1,editObj:{id:"",webname:"",webdes:"",weburl:"",appname:"",appdes:""}}},methods:{go_back:function(){this.$router.back(-1)},selectAll:function(e,t){for(var s,a,r=t.options,i=0,n=r.length;i<n;i++)for(a in s=r[i])s[a]=e},apiManagerTest:function(){var e=this;this.$confirm("1 请确认是否已打开浏览器服务端 </br> 2 测试大约需几分钟请耐心等待 </br>3 即将开始全部自定义测试","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...";var t={userId:e.userId,token:e.token,projectId:e.projectId};e.axios({baseURL:e.url,url:"/api/v1/webManagerTest/",method:"get",params:t}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:"PASS",type:"success",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试",e.get_webManagers()},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.get_webManagers(),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},appSrcTest:function(){var e=this;this.$confirm("1 请确认移动端是否开启开发者模式并连接测试PC </br>                 2 请确认是否已打开appium服务端 </br>                 3 测试大约需几分钟请耐心等待 </br>                 4 即将开始全部脚本测试","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...";var t={userId:e.userId,token:e.token,project:e.projectId,type:"web"};e.axios({baseURL:e.url,url:"/api/v1/appSrcTest/",method:"get",params:t}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:"PASS",type:"success",center:!0,showClose:!0,duration:0}),e.get_appSrcCases(),e.loading=!1,e.testBtn="开始测试"},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.get_appSrcCases(),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},testMpcloudCase:function(e){var t=this;this.$confirm("1 请确认是否已打开浏览器服务端 </br>2 测试大约需几分钟请耐心等待 </br>3 即将开始 "+e.role+" 测试","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){t.$message({message:"测试开始",type:"success",center:!0}),t.loading=!0,t.testBtn="测试中...",t.axios({baseURL:t.url,url:"/api/v1/webAutoTest/",method:"patch",data:e}).then(function(e){e.data.errcode?t.$message({message:e.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):t.$message({message:e.data.errmsg,type:"success",center:!0,showClose:!0,duration:0}),t.loading=!1,t.testBtn="开始测试"},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),t.loading=!1,t.testBtn="开始测试"})}).catch(function(){})},testMpcloud:function(){var e=this;this.$confirm("1 请确认是否已打开浏览器服务端 </br> 2 测试大约需30分钟请耐心等待 </br>3 即将开始全部角色测试","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...",e.axios({baseURL:e.url,url:"/api/v1/webAutoTest/",method:"post",data:e.webAutoTests}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:"量产云平台测试 PASS",type:"success",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试"},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},get_webAutotest:function(){var e=this,t="api/v1/webAutoTest/";this.$route.query.projectName&&(t=t+"?project="+this.$route.query.projectName);var s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:t,method:"get",params:s}).then(function(t){e.webAutoTests=t.data},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0})})},get_webManagers:function(){var e=this,t="api/v1/webManager/";this.$route.query.projectId&&(t=t+"?project="+this.$route.query.projectId);var s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:t,method:"get",params:s}).then(function(t){e.webManagers=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},get_appSrcCases:function(){var e=this,t={userId:this.userId,token:this.token,project:this.$route.query.projectId,src_type:"web"};this.axios({baseURL:this.url,url:"api/v1/appSrcCase/",method:"get",params:t}).then(function(t){e.appSrcCases=t.data.results,e.pre_src=t.data.previous,e.pre_src?e.isPreDisabled_src=!1:e.isPreDisabled_src=!0,e.next_src=t.data.next,e.next_src?e.isNextDisabled_src=!1:e.isNextDisabled_src=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},open_edit:function(e){this.dialogFormVisible=!0,this.editObj.id=e.id,this.editObj.webname=e.webname,this.editObj.webdes=e.webdes,this.editObj.weburl=e.weburl},open_edit_src:function(e){this.dialogFormVisible_src=!0,this.editObj.id=e.id,this.editObj.appname=e.appname,this.editObj.appdes=e.appdes},handleEdit:function(e){var t=this;if(e.webname&&e.webdes&&e.weburl){this.dialogFormVisible=!1;var s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/webManager/"+e.id+"/",method:"patch",params:s,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),t.get_webManagers())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"名称、描述和URL不能为空",type:"error",center:!0})},handleEdit_src:function(e){var t=this,s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!s||e.appname&&e.appdes){this.dialogFormVisible_src=!1;var a={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/appSrcCase/"+e.id+"/",method:"patch",params:a,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),s&&t.get_appSrcCases())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"名称、描述不能为空",type:"error",center:!0})},handleDelete:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/webManager/"+t.id+"/",method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):(s.$message({message:"删除成功",type:"success",center:!0}),s.get_webManagers())},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(){})},handleDeleteSrc:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/appSrcCase/"+t.id+"/",method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):(s.$message({message:"删除成功",type:"success",center:!0}),s.get_appSrcCases())},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(){})},new_webcase:function(){var e=this;if(this.webname&&this.webdes&&this.weburl){var t={webname:this.webname,webdes:this.webdes,weburl:this.weburl,user:this.userId,project:this.projectId},s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/webManager/",method:"post",params:s,data:t}).then(function(t){t.data.errcode?e.$message({message:"添加失败",type:"error",center:!0}):(e.$message({message:"添加成功",type:"success",center:!0}),e.get_webManagers())},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.webname="",this.webdes="",this.weburl=""}else this.$message({message:"名称、描述和URL不能为空",type:"error",center:!0})},new_appsrc:function(){var e=this;if(this.appsrcname&&this.appsrcdes){var t={appname:this.appsrcname,appdes:this.appsrcdes,user:this.userId,project:this.projectId,src_type:"web"},s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/appSrcCase/",method:"post",params:s,data:t}).then(function(t){t.data.errcode?e.$message({message:"新建失败",type:"error",center:!0}):(e.$message({message:"添加成功",type:"success",center:!0}),e.get_appSrcCases())},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.appsrcname="",this.appsrcdes=""}else this.$message({message:"名称、描述不能为空",type:"error",center:!0})},get_pre:function(){var e=this;this.axios.get(this.pre).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0}):(e.webManagers=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0})})},get_next:function(){var e=this;this.axios.get(this.next).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0}):(e.webManagers=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0})})},get_pre_src:function(){var e=this;this.axios.get(this.pre_src).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.appSrcCases=t.data.results,e.pre_src=t.data.previous,e.pre_src?e.isPreDisabled_src=!1:e.isPreDisabled_src=!0,e.next_src=t.data.next,e.next_src?e.isNextDisabled_src=!1:e.isNextDisabled_src=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_next_src:function(){var e=this;this.axios.get(this.next_src).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.appSrcCases=t.data.results,e.pre_src=t.data.previous,e.pre_src?e.isPreDisabled_src=!1:e.isPreDisabled_src=!0,e.next_src=t.data.next,e.next_src?e.isNextDisabled_src=!1:e.isNextDisabled_src=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},go_webTest:function(e){var t={object_id:e.id,content_type:e.contenttype,weburl:e.weburl,projectName:e.proname,webName:e.webname};this.$router.push({path:"/home/webType/",query:t})},go_src:function(e){var t={id:e.id,userid:e.user,project:e.project,projectName:e.proname,appName:e.appname,type:e.src_type};this.$router.push({path:"/home/src/",query:t})},get_projects:function(){var e=this,t={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/project/",method:"get",params:t}).then(function(t){if(t.data.errcode)e.$message({message:"加载失败",type:"error",center:!0,showClose:!0});else{e.project_options=[];for(var s=0;s<t.data.results.length;s++){var a={value:t.data.results[s].id,label:t.data.results[s].proname};e.project_options.push(a)}e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0}},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})}},watch:{"$route.query.projectId":function(e){e||(this.get_projects(),this.get_webManagers(),this.get_appSrcCases())}},beforeCreate:function(){},created:function(){this.get_webManagers(),this.get_webAutotest(),this.get_appSrcCases(),this.$route.query.projectId||this.get_projects()},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}}},y={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[this.$route.query.projectId?s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级"),s("br"),s("br")]),e._v(" "),this.$route.query.projectName?s("span",{staticStyle:{"font-size":"17px"}},[e._v("\r\n            项目："+e._s(this.$route.query.projectName)+"\r\n        ")]):e._e(),s("br"),s("br")]):e._e(),e._v(" "),s("el-collapse",{attrs:{accordion:""},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-collapse-item",{staticStyle:{"font-size":"17px"},attrs:{title:"脚本测试",name:"1"}},[s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.new_appsrc}},[e._v("添加app")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.appsrcname,callback:function(t){e.appsrcname=t},expression:"appsrcname"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入描述"},model:{value:e.appsrcdes,callback:function(t){e.appsrcdes=t},expression:"appsrcdes"}}),e._v(" "),this.$route.query.projectId?e._e():s("el-select",{attrs:{placeholder:"请选择项目"},model:{value:e.projectId,callback:function(t){e.projectId=t},expression:"projectId"}},e._l(e.project_options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),this.$route.query.projectId?s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",loading:e.loading},on:{click:e.appSrcTest}},[e._v(e._s(e.testBtn))]):e._e(),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{stripe:"",border:"",data:e.appSrcCases.filter(function(t){return!e.search||t.appname.toLowerCase().includes(e.search.toLowerCase())||t.appdes.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"名称",align:"center",prop:"appname"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击进入脚本编辑",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.go_src(t.row)}}},[s("p",[e._v(e._s(t.row.appname))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"描述",align:"center",prop:"appdes"}}),e._v(" "),s("el-table-column",{attrs:{label:"项目",align:"center",prop:"proname"}}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center",prop:"update_time"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"测试结果",align:"center",prop:"result",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.result?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit_src(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDeleteSrc(t.$index,t.row)}}}):e._e()],1)]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入项目名称关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled_src},on:{click:e.get_pre_src}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled_src},on:{click:e.get_next_src}},[e._v("下一页")])],1)],1),e._v(" "),s("el-collapse-item",{staticStyle:{"font-size":"17px"},attrs:{title:"自定义测试",name:"2"}},[s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.new_webcase}},[e._v("添加测试")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.webname,callback:function(t){e.webname=t},expression:"webname"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入描述"},model:{value:e.webdes,callback:function(t){e.webdes=t},expression:"webdes"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入URL"},model:{value:e.weburl,callback:function(t){e.weburl=t},expression:"weburl"}}),e._v(" "),this.$route.query.projectId?e._e():s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.projectId,callback:function(t){e.projectId=t},expression:"projectId"}},e._l(e.project_options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),this.$route.query.projectId?s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",loading:e.loading},on:{click:e.apiManagerTest}},[e._v(e._s(e.testBtn))]):e._e(),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{stripe:"",border:"",data:e.webManagers.filter(function(t){return!e.search||t.webname.toLowerCase().includes(e.search.toLowerCase())||t.webdes.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击进入 "+t.row.webname+" 测试项",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.go_webTest(t.row)}}},[s("p",[e._v(e._s(t.row.webname))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"描述",align:"center",prop:"webdes"}}),e._v(" "),s("el-table-column",{attrs:{label:"URL",align:"center",prop:"weburl"}}),e._v(" "),s("el-table-column",{attrs:{label:"项目",align:"center",prop:"proname"}}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center",prop:"update_time"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"测试结果",align:"center",prop:"result",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.result?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入名称关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1)],1),e._v(" "),s("el-collapse-item",{staticStyle:{"font-size":"17px"},attrs:{title:"自动化测试",name:"3"}},[[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.webAutoTests}},[s("el-table-column",{attrs:{prop:"role",label:"角色",width:"180",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"测试项",align:"",width:"800"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-checkbox",{attrs:{checked:""},on:{change:function(s){return e.selectAll(s,t.row)}}},[e._v("全部")]),e._v(" "),e._l(t.row.options,function(t,a){return s("span",{key:a},e._l(t,function(a,r,i){return s("span",{key:i},[s("el-checkbox",{model:{value:t[r],callback:function(s){e.$set(t,r,s)},expression:"option[key]"}},[e._v(e._s(r))]),e._v("\r\n                                  \r\n                            ")],1)}),0)})]}}])}),e._v(" "),"量产云平台"==this.$route.query.projectName?s("el-table-column",{attrs:{align:""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(s){return e.testMpcloudCase(t.row)}}},[e._v(e._s(e.testBtn))])]}}],null,!1,960019931)},[s("template",{slot:"header"},[s("el-button",{attrs:{type:"primary",align:"center",loading:e.loading},on:{click:function(t){return e.testMpcloud()}}},[e._v(e._s(e.testBtn))])],1)],2):e._e()],1)]],2)],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"名称","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.webname,callback:function(t){e.$set(e.editObj,"webname",t)},expression:"editObj.webname"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"描述","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.webdes,callback:function(t){e.$set(e.editObj,"webdes",t)},expression:"editObj.webdes"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"URL","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.weburl,callback:function(t){e.$set(e.editObj,"weburl",t)},expression:"editObj.weburl"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(e.editObj)}}},[e._v("确 定")])],1)],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible_src},on:{"update:visible":function(t){e.dialogFormVisible_src=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"名称","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.appname,callback:function(t){e.$set(e.editObj,"appname",t)},expression:"editObj.appname"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"描述","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.appdes,callback:function(t){e.$set(e.editObj,"appdes",t)},expression:"editObj.appdes"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit_src(e.editObj)}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var x=s("VU/8")(v,y,!1,function(e){s("ukAO")},"data-v-39fd5225",null).exports,w={name:"ApiManager",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),testUserId:this.storage.getItem("testUserId"),testUserToken:this.storage.getItem("testUserToken"),adminUserId:this.storage.getItem("adminUserId"),adminUserToken:this.storage.getItem("adminUserToken"),baseurl:"",testBtn:"开始测试",loading:!1,adminUser:this.$route.query.adminUser,adminPsw:this.$route.query.adminPsw,testUser:this.$route.query.testUser,testPsw:this.$route.query.testPsw,apiname:"",apides:"",apiurl:"",search:"",appsrcname:"",appsrcdes:"",apiManagers:[],appSrcCases:[],project_options:[],activeName:"1",pre:"",next:"",projectId:this.$route.query.projectId,projectName:this.$route.query.projectName,isNextDisabled:!1,isPreDisabled:!1,pre_src:"",next_src:"",isNextDisabled_src:!1,isPreDisabled_src:!1,dialogFormVisible:!1,dialogFormVisible_src:!1,testUserFormVisible:!1,editObj:{id:"",apiname:"",apides:"",apiurl:"",appname:"",appdes:""}}},methods:{go_back:function(){this.$router.back(-1)},get_testUser:function(){var e=this,t={email:this.adminUser,pswmd5:g()(this.adminPsw),timestamp:Date.parse(new Date)},s={email:this.testUser,pswmd5:g()(this.testPsw),timestamp:Date.parse(new Date)};this.axios({baseURL:this.baseurl,url:"/api/v1/user/login",method:"post",data:t}).then(function(t){"0"==t.data.errcode?(e.storage.setItem("adminUserId",t.data.data.userid),e.storage.setItem("adminUserToken",t.data.data.token),e.adminUserId=t.data.data.userid,e.adminUserToken=t.data.data.token,e.axios({baseURL:e.baseurl,url:"/api/v1/user/login",method:"post",data:s}).then(function(t){"0"==t.data.errcode?(e.storage.setItem("testUserId",t.data.data.userid),e.storage.setItem("testUserToken",t.data.data.token),e.testUserId=e.storage.getItem("testUserId"),e.testUserToken=e.storage.getItem("testUserToken")):(e.$message({message:"测试用户账户密码异常，请重新设置",type:"error",center:!0,showClose:!0,duration:0}),e.testUserFormVisible=!0)},function(t){e.$message({message:"服务器错误，请检查 "+e.baseurl+" 服务器是否正常",type:"error",center:!0,showClose:!0,duration:0})})):(e.$message({message:"管理员账户密码异常，请重新设置",type:"error",center:!0,showClose:!0,duration:0}),e.testUserFormVisible=!0)},function(t){e.$message({message:"服务器错误，请检查 "+e.baseurl+" 服务器是否正常",type:"error",center:!0,showClose:!0,duration:0})})},setTestUser:function(){var e=this,t={userId:this.userId,token:this.token},s={adminUser:this.adminUser,adminPsw:this.adminPsw,testUser:this.testUser,testPsw:this.testPsw};this.axios({baseURL:this.url,url:"api/v1/project/"+this.projectId+"/",method:"patch",params:t,data:s}).then(function(t){t.data.errcode?e.$message({message:"测试用户设置失败",type:"error",center:!0}):(e.$message({message:"测试用户设置成功",type:"success",center:!0}),e.testUserFormVisible=!1)},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})},add_testUser:function(){var e=this,t={email:this.adminUser,pswmd5:g()(this.adminPsw),timestamp:Date.parse(new Date)},s={email:this.testUser,pswmd5:g()(this.testPsw),timestamp:Date.parse(new Date)};this.axios({baseURL:this.baseurl,url:"/api/v1/user/login",method:"post",data:t}).then(function(t){"0"==t.data.errcode?(e.storage.setItem("adminUserId",t.data.data.userid),e.storage.setItem("adminUserToken",t.data.data.token),e.axios({baseURL:e.baseurl,url:"/api/v1/user/login",method:"post",data:s}).then(function(t){"0"==t.data.errcode?(e.storage.setItem("testUserId",t.data.data.userid),e.storage.setItem("testUserToken",t.data.data.token),e.setTestUser()):(e.$message({message:"测试用户账户密码异常，请重新设置",type:"error",center:!0}),e.testUserFormVisible=!0)},function(t){e.$message({message:"服务器错误，请检查 "+e.baseurl+" 服务器是否正常",type:"error",center:!0})})):(e.$message({message:"管理员账户密码异常，请重新设置",type:"error",center:!0}),e.testUserFormVisible=!0)},function(t){e.$message({message:"服务器错误，请检查 "+e.baseurl+" 服务器是否正常",type:"error",center:!0})})},apiManagerTest:function(){var e=this;this.$confirm("即将开始 "+this.$route.query.projectName+" 后端测试，请耐心等待","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...";var t={userId:e.userId,token:e.token,projectId:e.projectId},s={};if("量产云平台"==e.$route.query.projectName)s={testUserInfo:{testUserId:e.testUserId,testUserToken:e.testUserToken,adminUserId:e.adminUserId,adminUserToken:e.adminUserToken}};e.axios({baseURL:e.url,url:"/api/v1/apiManagerTest/",method:"post",params:t,data:s}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:e.$route.query.projectName+" 后端测试 PASS",type:"success",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试",e.get_apiManagers()},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.get_apiManagers(),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},appSrcTest:function(){var e=this;this.$confirm("1 请确认移动端是否开启开发者模式并连接测试PC </br>                 2 请确认是否已打开appium服务端 </br>                 3 测试大约需几分钟请耐心等待 </br>                 4 即将开始全部脚本测试","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...";var t={userId:e.userId,token:e.token,project:e.projectId,type:"api"};e.axios({baseURL:e.url,url:"/api/v1/appSrcTest/",method:"get",params:t}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:"PASS",type:"success",center:!0,showClose:!0,duration:0}),e.get_appSrcCases(),e.loading=!1,e.testBtn="开始测试"},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.get_appSrcCases(),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},get_apiManagers:function(){var e=this,t="api/v1/apiManager/";this.$route.query.projectId&&(t=t+"?project="+this.$route.query.projectId);var s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:t,method:"get",params:s}).then(function(t){if(e.apiManagers=t.data.results,e.baseurl=t.data.results[0].apiurl,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0,"量产云平台"==e.$route.query.projectName){if(!(e.$route.query.adminUser&&e.$route.query.adminPsw&&e.$route.query.testUser&&e.$route.query.testPsw))return e.testUserFormVisible=!0,void e.$message({message:"API测试用户不能为空",type:"error",center:!0,showClose:!0,duration:0});e.get_testUser()}},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},get_appSrcCases:function(){var e=this,t={userId:this.userId,token:this.token,project:this.$route.query.projectId,src_type:"api"};this.axios({baseURL:this.url,url:"api/v1/appSrcCase/",method:"get",params:t}).then(function(t){e.appSrcCases=t.data.results,e.pre_src=t.data.previous,e.pre_src?e.isPreDisabled_src=!1:e.isPreDisabled_src=!0,e.next_src=t.data.next,e.next_src?e.isNextDisabled_src=!1:e.isNextDisabled_src=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},open_edit:function(e){this.dialogFormVisible=!0,this.editObj.id=e.id,this.editObj.apiname=e.apiname,this.editObj.apides=e.apides,this.editObj.apiurl=e.apiurl},open_edit_src:function(e){this.dialogFormVisible_src=!0,this.editObj.id=e.id,this.editObj.appname=e.appname,this.editObj.appdes=e.appdes},handleEdit:function(e){var t=this;if(e.apiname&&e.apides&&e.apiurl){this.dialogFormVisible=!1;var s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/apiManager/"+e.id+"/",method:"patch",params:s,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),t.get_apiManagers())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"名称、描述、URL不能为空",type:"error",center:!0})},handleEdit_src:function(e){var t=this,s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!s||e.appname&&e.appdes){this.dialogFormVisible_src=!1;var a={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/appSrcCase/"+e.id+"/",method:"patch",params:a,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),s&&t.get_appSrcCases())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"名称、描述不能为空",type:"error",center:!0})},handleDelete:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/apiManager/"+t.id+"/",method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):(s.$message({message:"删除成功",type:"success",center:!0}),s.get_apiManagers())},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(){})},handleDeleteSrc:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/appSrcCase/"+t.id+"/",method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):(s.$message({message:"删除成功",type:"success",center:!0}),s.get_appSrcCases())},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(){})},new_webcase:function(){var e=this;if(this.apiname&&this.apides&&this.apiurl){var t={apiname:this.apiname,apides:this.apides,apiurl:this.apiurl,user:this.userId,project:this.projectId},s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/apiManager/",method:"post",params:s,data:t}).then(function(t){t.data.errcode?e.$message({message:"新建失败",type:"error",center:!0}):(e.$message({message:"添加成功",type:"success",center:!0}),e.get_apiManagers())},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.apiname="",this.apides="",this.apiurl=""}else this.$message({message:"名称、描述、URL不能为空",type:"error",center:!0})},new_appsrc:function(){var e=this;if(this.appsrcname&&this.appsrcdes){var t={appname:this.appsrcname,appdes:this.appsrcdes,user:this.userId,project:this.projectId,src_type:"api"},s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/appSrcCase/",method:"post",params:s,data:t}).then(function(t){t.data.errcode?e.$message({message:"新建失败",type:"error",center:!0}):(e.$message({message:"添加成功",type:"success",center:!0}),e.get_appSrcCases())},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.appsrcname="",this.appsrcdes=""}else this.$message({message:"名称、描述不能为空",type:"error",center:!0})},get_pre:function(){var e=this;this.axios.get(this.pre).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.apiManagers=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_next:function(){var e=this;this.axios.get(this.next).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.apiManagers=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_pre_src:function(){var e=this;this.axios.get(this.pre_src).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.appSrcCases=t.data.results,e.pre_src=t.data.previous,e.pre_src?e.isPreDisabled_src=!1:e.isPreDisabled_src=!0,e.next_src=t.data.next,e.next_src?e.isNextDisabled_src=!1:e.isNextDisabled_src=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_next_src:function(){var e=this;this.axios.get(this.next_src).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.appSrcCases=t.data.results,e.pre_src=t.data.previous,e.pre_src?e.isPreDisabled_src=!1:e.isPreDisabled_src=!0,e.next_src=t.data.next,e.next_src?e.isNextDisabled_src=!1:e.isNextDisabled_src=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},go_apiTest:function(e){var t={object_id:e.id,content_type:e.contenttype,apiurl:e.apiurl,projectName:e.proname,apiName:e.apiname};this.$router.push({path:"/home/ApiType/",query:t})},go_src:function(e){var t={id:e.id,userid:e.user,project:e.project,projectName:e.proname,appName:e.appname,type:e.src_type};this.$router.push({path:"/home/src/",query:t})},get_projects:function(){var e=this,t={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/project/",method:"get",params:t}).then(function(t){if(t.data.errcode)e.$message({message:"加载失败",type:"error",center:!0});else{e.project_options=[];for(var s=0;s<t.data.results.length;s++){var a={value:t.data.results[s].id,label:t.data.results[s].proname};e.project_options.push(a)}e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0}},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})}},watch:{"$route.query.projectId":function(e){e||(this.get_projects(),this.get_apiManagers(),this.get_appSrcCases())}},beforeCreate:function(){},created:function(){this.get_apiManagers(),this.get_appSrcCases(),this.$route.query.projectId||this.get_projects()},beforeMount:function(){},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}}},k={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[this.$route.query.projectId?s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级"),s("br"),s("br")]),e._v(" "),this.$route.query.projectName?s("span",{staticStyle:{"font-size":"17px"}},[e._v("\r\n            项目："+e._s(this.$route.query.projectName)+"\r\n        ")]):e._e(),s("br"),s("br")]):e._e(),e._v(" "),s("el-collapse",{attrs:{accordion:""},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-collapse-item",{staticStyle:{"font-size":"17px"},attrs:{title:"脚本测试",name:"1"}},[s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.new_appsrc}},[e._v("添加app")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.appsrcname,callback:function(t){e.appsrcname=t},expression:"appsrcname"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入描述"},model:{value:e.appsrcdes,callback:function(t){e.appsrcdes=t},expression:"appsrcdes"}}),e._v(" "),this.$route.query.projectId?e._e():s("el-select",{attrs:{placeholder:"请选择项目"},model:{value:e.projectId,callback:function(t){e.projectId=t},expression:"projectId"}},e._l(e.project_options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),this.$route.query.projectId?s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",loading:e.loading},on:{click:e.appSrcTest}},[e._v(e._s(e.testBtn))]):e._e(),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{stripe:"",border:"",data:e.appSrcCases.filter(function(t){return!e.search||t.appname.toLowerCase().includes(e.search.toLowerCase())||t.appdes.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"名称",align:"center",prop:"appname"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击进入脚本编辑",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.go_src(t.row)}}},[s("p",[e._v(e._s(t.row.appname))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"描述",align:"center",prop:"appdes"}}),e._v(" "),s("el-table-column",{attrs:{label:"项目",align:"center",prop:"proname"}}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center",prop:"update_time"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"测试结果",align:"center",prop:"result",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.result?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit_src(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDeleteSrc(t.$index,t.row)}}}):e._e()],1)]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入项目名称关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled_src},on:{click:e.get_pre_src}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled_src},on:{click:e.get_next_src}},[e._v("下一页")])],1)],1),e._v(" "),s("el-collapse-item",{staticStyle:{"font-size":"17px"},attrs:{title:"自定义测试",name:"2"}},[s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.new_webcase}},[e._v("添加模块")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.apiname,callback:function(t){e.apiname=t},expression:"apiname"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入描述"},model:{value:e.apides,callback:function(t){e.apides=t},expression:"apides"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入URL"},model:{value:e.apiurl,callback:function(t){e.apiurl=t},expression:"apiurl"}}),e._v(" "),this.$route.query.projectId?e._e():s("el-select",{attrs:{placeholder:"请选择项目"},model:{value:e.projectId,callback:function(t){e.projectId=t},expression:"projectId"}},e._l(e.project_options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设置API测试用户账号",placement:"top-start"}},["量产云平台"==this.$route.query.projectName?s("el-button",{staticStyle:{float:"right","margin-left":"10px"},attrs:{icon:"el-icon-edit",type:"primary"},on:{click:function(t){e.testUserFormVisible=!0}}}):e._e()],1),e._v(" "),this.$route.query.projectId?s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",loading:e.loading},on:{click:e.apiManagerTest}},[e._v(e._s(e.testBtn))]):e._e(),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{stripe:"",border:"",data:e.apiManagers.filter(function(t){return!e.search||t.apiname.toLowerCase().includes(e.search.toLowerCase())||t.apides.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"名称",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击进入 "+t.row.apiname+" 模块",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.go_apiTest(t.row)}}},[s("p",[e._v(e._s(t.row.apiname))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"描述",align:"center",prop:"apides"}}),e._v(" "),s("el-table-column",{attrs:{label:"URL",align:"center",prop:"apiurl"}}),e._v(" "),s("el-table-column",{attrs:{label:"项目",align:"center",prop:"proname"}}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center",prop:"update_time"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"测试结果",align:"center",prop:"result",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.result?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入项目名称关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"名称","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.apiname,callback:function(t){e.$set(e.editObj,"apiname",t)},expression:"editObj.apiname"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"描述","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.apides,callback:function(t){e.$set(e.editObj,"apides",t)},expression:"editObj.apides"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"URL","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.apiurl,callback:function(t){e.$set(e.editObj,"apiurl",t)},expression:"editObj.apiurl"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(e.editObj)}}},[e._v("确 定")])],1)],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible_src},on:{"update:visible":function(t){e.dialogFormVisible_src=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"名称","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.appname,callback:function(t){e.$set(e.editObj,"appname",t)},expression:"editObj.appname"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"描述","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.appdes,callback:function(t){e.$set(e.editObj,"appdes",t)},expression:"editObj.appdes"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit_src(e.editObj)}}},[e._v("确 定")])],1)],1),e._v(" "),s("el-dialog",{attrs:{width:"500px",visible:e.testUserFormVisible},on:{"update:visible":function(t){e.testUserFormVisible=t}}},[s("div",{staticClass:"operator"},[e._v("管理员账户:")]),s("br"),e._v(" "),s("el-form",{attrs:{inline:""}},[s("el-form-item",[s("el-input",{attrs:{autocomplete:"off",placeholder:"请输入邮箱"},model:{value:e.adminUser,callback:function(t){e.adminUser=t},expression:"adminUser"}})],1),e._v(" "),s("el-form-item",[s("el-input",{attrs:{autocomplete:"off",placeholder:"请输入密码"},model:{value:e.adminPsw,callback:function(t){e.adminPsw=t},expression:"adminPsw"}})],1)],1),e._v(" "),s("div",{staticClass:"operator"},[e._v("测试账户:")]),s("br"),e._v(" "),s("el-form",{attrs:{inline:""}},[s("el-form-item",[s("el-input",{attrs:{autocomplete:"off",placeholder:"请输入邮箱"},model:{value:e.testUser,callback:function(t){e.testUser=t},expression:"testUser"}})],1),e._v(" "),s("el-form-item",[s("el-input",{attrs:{autocomplete:"off",placeholder:"请输入密码"},model:{value:e.testPsw,callback:function(t){e.testPsw=t},expression:"testPsw"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.testUserFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.add_testUser()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var $=s("VU/8")(w,k,!1,function(e){s("gmSH")},"data-v-517d4c70",null).exports,I=s("mvHQ"),C=s.n(I),j={name:"AppManager",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),editParam:"提交修改",testBtn:"开始测试",loading:!1,appname:"",appdes:"",appsrcname:"",appsrcdes:"",search:"",appManagers:[],appSrcCases:[],project_options:[],pre:"",next:"",isNextDisabled:!1,isPreDisabled:!1,pre_src:"",next_src:"",isNextDisabled_src:!1,isPreDisabled_src:!1,activeName:"1",projectId:this.$route.query.projectId,projectName:this.$route.query.projectName,dialogFormVisible:!1,dialogFormVisible_src:!1,testUserFormVisible:!1,editObj:{id:"",appname:"",appdes:""},desired_caps:{}}},methods:{go_back:function(){this.$router.back(-1)},appManagerTest:function(){var e=this;this.$confirm("1 请确认移动端是否开启开发者模式并连接测试PC </br>                 2 请确认是否已打开appium服务端 </br>                 3 测试大约需几分钟请耐心等待 </br>                 4 即将开始全部自定义测试","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...";var t={userId:e.userId,token:e.token,projectId:e.projectId};e.axios({baseURL:e.url,url:"/api/v1/appManagerTest/",method:"get",params:t}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:"PASS",type:"success",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试",e.get_appManagers()},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.get_appManagers(),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},appSrcTest:function(){var e=this;this.$confirm("1 请确认移动端是否开启开发者模式并连接测试PC </br>                 2 请确认是否已打开appium服务端 </br>                 3 测试大约需几分钟请耐心等待 </br>                 4 即将开始全部脚本测试","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...";var t={userId:e.userId,token:e.token,project:e.projectId,type:"app"};e.axios({baseURL:e.url,url:"/api/v1/appSrcTest/",method:"get",params:t}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:"PASS",type:"success",center:!0,showClose:!0,duration:0}),e.get_appSrcCases(),e.loading=!1,e.testBtn="开始测试"},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.get_appSrcCases(),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},get_appManagers:function(){var e=this,t="api/v1/appManager/",s=[];this.$route.query.projectId&&(t=t+"?project="+this.$route.query.projectId);var a={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:t,method:"get",params:a}).then(function(t){e.appManagers=t.data.results;for(var a=0;a<t.data.results.length;a++){if(t.data.results[a].desired_caps){var r=JSON.parse(t.data.results[a].desired_caps);for(var i in r)s.push([i,r[i]])}else s=[];e.$set(e.desired_caps,t.data.results[a].id,s),s=[]}e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},get_appSrcCases:function(){var e=this,t={userId:this.userId,token:this.token,project:this.$route.query.projectId,src_type:"app"};this.axios({baseURL:this.url,url:"api/v1/appSrcCase/",method:"get",params:t}).then(function(t){e.appSrcCases=t.data.results,e.pre_src=t.data.previous,e.pre_src?e.isPreDisabled_src=!1:e.isPreDisabled_src=!0,e.next_src=t.data.next,e.next_src?e.isNextDisabled_src=!1:e.isNextDisabled_src=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},add_desired_caps:function(e){e.push(["",""]),this.editParam="提交修改*"},remove_desired_caps:function(e,t){var s=this;this.$confirm("提交修改后将永久删除, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){s.$delete(s.desired_caps[t],e.$index),s.editParam="提交修改*"}).catch(function(){})},edit_desired_caps:function(e,t,s){var a={};a.id=e;var r={};for(var i in s)""!=s[i][0]&&""!=s[i][1]&&(r[s[i][0]]=s[i][1]);a[t]=C()(r),this.handleEdit(a,!1),this.editParam="提交修改"},open_edit:function(e){this.dialogFormVisible=!0,this.editObj.id=e.id,this.editObj.appname=e.appname,this.editObj.appdes=e.appdes},open_edit_src:function(e){this.dialogFormVisible_src=!0,this.editObj.id=e.id,this.editObj.appname=e.appname,this.editObj.appdes=e.appdes},handleEdit:function(e){var t=this,s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!s||e.appname&&e.appdes){this.dialogFormVisible=!1;var a={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/appManager/"+e.id+"/",method:"patch",params:a,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),s&&t.get_appManagers())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"名称、描述不能为空",type:"error",center:!0})},handleEdit_src:function(e){var t=this,s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!s||e.appname&&e.appdes){this.dialogFormVisible_src=!1;var a={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/appSrcCase/"+e.id+"/",method:"patch",params:a,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),s&&t.get_appSrcCases())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"名称、描述不能为空",type:"error",center:!0})},handleDelete:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/appManager/"+t.id+"/",method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):(s.$message({message:"删除成功",type:"success",center:!0}),s.get_appManagers())},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(){})},handleDeleteSrc:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/appSrcCase/"+t.id+"/",method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):(s.$message({message:"删除成功",type:"success",center:!0}),s.get_appSrcCases())},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(){})},new_app:function(){var e=this;if(this.appname&&this.appdes){var t={appname:this.appname,appdes:this.appdes,user:this.userId,project:this.projectId},s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/appManager/",method:"post",params:s,data:t}).then(function(t){t.data.errcode?e.$message({message:"新建失败",type:"error",center:!0}):(e.$message({message:"添加成功",type:"success",center:!0}),e.get_appManagers())},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.appname="",this.appdes=""}else this.$message({message:"名称、描述不能为空",type:"error",center:!0})},new_appsrc:function(){var e=this;if(this.appsrcname&&this.appsrcdes){var t={appname:this.appsrcname,appdes:this.appsrcdes,user:this.userId,project:this.projectId,src_type:"app"},s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/appSrcCase/",method:"post",params:s,data:t}).then(function(t){t.data.errcode?e.$message({message:"新建失败",type:"error",center:!0}):(e.$message({message:"添加成功",type:"success",center:!0}),e.get_appSrcCases())},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.appsrcname="",this.appsrcdes=""}else this.$message({message:"名称、描述不能为空",type:"error",center:!0})},get_pre:function(){var e=this;this.axios.get(this.pre).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.appManagers=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_next:function(){var e=this;this.axios.get(this.next).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.appManagers=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_pre_src:function(){var e=this;this.axios.get(this.pre_src).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.appSrcCases=t.data.results,e.pre_src=t.data.previous,e.pre_src?e.isPreDisabled_src=!1:e.isPreDisabled_src=!0,e.next_src=t.data.next,e.next_src?e.isNextDisabled_src=!1:e.isNextDisabled_src=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_next_src:function(){var e=this;this.axios.get(this.next_src).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.appSrcCases=t.data.results,e.pre_src=t.data.previous,e.pre_src?e.isPreDisabled_src=!1:e.isPreDisabled_src=!0,e.next_src=t.data.next,e.next_src?e.isNextDisabled_src=!1:e.isNextDisabled_src=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},go_appTest:function(e){var t={object_id:e.id,content_type:e.contenttype,projectName:e.proname,appName:e.appname};this.$router.push({path:"/home/AppType/",query:t})},go_src:function(e){var t={id:e.id,userid:e.user,project:e.project,projectName:e.proname,appName:e.appname,type:e.src_type};this.$router.push({path:"/home/src/",query:t})},get_projects:function(){var e=this,t={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/project/",method:"get",params:t}).then(function(t){if(t.data.errcode)e.$message({message:"加载失败",type:"error",center:!0});else{e.project_options=[];for(var s=0;s<t.data.results.length;s++){var a={value:t.data.results[s].id,label:t.data.results[s].proname};e.project_options.push(a)}e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0}},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})}},watch:{"$route.query.projectId":function(e){e||(this.get_projects(),this.get_appManagers())}},beforeCreate:function(){},created:function(){this.get_appManagers(),this.get_appSrcCases(),this.$route.query.projectId||this.get_projects()},beforeMount:function(){},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}}},S={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[this.$route.query.projectId?s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级"),s("br"),s("br")]),e._v(" "),this.$route.query.projectName?s("span",{staticStyle:{"font-size":"17px"}},[e._v("\r\n            项目："+e._s(this.$route.query.projectName)+"\r\n        ")]):e._e(),s("br"),s("br")]):e._e(),e._v(" "),s("el-collapse",{attrs:{accordion:""},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-collapse-item",{staticStyle:{"font-size":"17px"},attrs:{title:"脚本测试",name:"1"}},[s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.new_appsrc}},[e._v("添加app")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.appsrcname,callback:function(t){e.appsrcname=t},expression:"appsrcname"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入描述"},model:{value:e.appsrcdes,callback:function(t){e.appsrcdes=t},expression:"appsrcdes"}}),e._v(" "),this.$route.query.projectId?e._e():s("el-select",{attrs:{placeholder:"请选择项目"},model:{value:e.projectId,callback:function(t){e.projectId=t},expression:"projectId"}},e._l(e.project_options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),this.$route.query.projectId?s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",loading:e.loading},on:{click:e.appSrcTest}},[e._v(e._s(e.testBtn))]):e._e(),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{stripe:"",border:"",data:e.appSrcCases.filter(function(t){return!e.search||t.appname.toLowerCase().includes(e.search.toLowerCase())||t.appdes.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"名称",align:"center",prop:"appname"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击进入脚本编辑",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.go_src(t.row)}}},[s("p",[e._v(e._s(t.row.appname))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"描述",align:"center",prop:"appdes"}}),e._v(" "),s("el-table-column",{attrs:{label:"项目",align:"center",prop:"proname"}}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center",prop:"update_time"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"测试结果",align:"center",prop:"result",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.result?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit_src(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDeleteSrc(t.$index,t.row)}}}):e._e()],1)]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入项目名称关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled_src},on:{click:e.get_pre_src}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled_src},on:{click:e.get_next_src}},[e._v("下一页")])],1)],1),e._v(" "),s("el-collapse-item",{staticStyle:{"font-size":"17px"},attrs:{title:"自定义测试",name:"2"}},[s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.new_app}},[e._v("添加app")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.appname,callback:function(t){e.appname=t},expression:"appname"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入描述"},model:{value:e.appdes,callback:function(t){e.appdes=t},expression:"appdes"}}),e._v(" "),this.$route.query.projectId?e._e():s("el-select",{attrs:{placeholder:"请选择项目"},model:{value:e.projectId,callback:function(t){e.projectId=t},expression:"projectId"}},e._l(e.project_options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),this.$route.query.projectId?s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",loading:e.loading},on:{click:e.appManagerTest}},[e._v(e._s(e.testBtn))]):e._e(),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{stripe:"",border:"",data:e.appManagers.filter(function(t){return!e.search||t.appname.toLowerCase().includes(e.search.toLowerCase())||t.appdes.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tabs",{attrs:{type:"border-card"}},[s("el-tab-pane",{attrs:{label:"desired_caps"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.desired_caps[t.row.id],"header-cell-style":{background:"#F2F6FC"}}},[s("el-table-column",{attrs:{label:"KEY"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{model:{value:t.row[0],callback:function(s){e.$set(t.row,0,s)},expression:"scope.row[0]"}})]}}],null,!0)}),e._v(" "),s("el-table-column",{attrs:{label:"VALUE"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{model:{value:t.row[1],callback:function(s){e.$set(t.row,1,s)},expression:"scope.row[1]"}})]}}],null,!0)}),e._v(" "),s("el-table-column",{attrs:{width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return s.preventDefault(),e.remove_desired_caps(a,t.row.id)}}})]}}],null,!0)})],1),e._v(" "),s("br"),e._v(" "),s("el-button",{staticClass:"el-icon-plus",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.add_desired_caps(e.desired_caps[t.row.id])}}},[e._v("添加参数\r\n                                ")]),e._v(" "),t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.edit_desired_caps(t.row.id,"desired_caps",e.desired_caps[t.row.id])}}},[e._v(e._s(e.editParam)+"\r\n                                ")]):e._e()],1)],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击进入 "+t.row.appname+" app测试",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.go_appTest(t.row)}}},[s("p",[e._v(e._s(t.row.appname))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"描述",align:"center",prop:"appdes"}}),e._v(" "),s("el-table-column",{attrs:{label:"项目",align:"center",prop:"proname"}}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center",prop:"update_time"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"测试结果",align:"center",prop:"result",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.result?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入项目名称关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"名称","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.appname,callback:function(t){e.$set(e.editObj,"appname",t)},expression:"editObj.appname"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"描述","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.appdes,callback:function(t){e.$set(e.editObj,"appdes",t)},expression:"editObj.appdes"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(e.editObj)}}},[e._v("确 定")])],1)],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible_src},on:{"update:visible":function(t){e.dialogFormVisible_src=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"名称","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.appname,callback:function(t){e.$set(e.editObj,"appname",t)},expression:"editObj.appname"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"描述","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.appdes,callback:function(t){e.$set(e.editObj,"appdes",t)},expression:"editObj.appdes"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit_src(e.editObj)}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var D=s("VU/8")(j,S,!1,function(e){s("hdYT")},"data-v-2b9798ca",null).exports,T=s("pFYg"),U=s.n(T),N=s("o4sT"),O=s.n(N),P=(s("NbQv"),s("h636"),s("1bTW"),s("y1DZ"),s("Dukv"),s("R3yc"),{name:"ApiCase",data:function(){return{options:{enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0,highlightActiveLine:!0},projectName:this.$route.query.projectName,axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),testUserId:this.storage.getItem("testUserId"),testUserToken:this.storage.getItem("testUserToken"),adminUserId:this.storage.getItem("adminUserId"),adminUserToken:this.storage.getItem("adminUserToken"),testUser:"",testBtn:"开始测试",loading:!1,allTestBtn:"开始测试",allTestLoading:!1,apiname:"",apiurl:"",apiparams:{},apibody:{},search:"",apiCases:[],pre:"",next:"",error:{},editParam:"提交修改",editBody:"提交修改",editForm:"提交修改",editResponse:"提交修改",editAuth:"提交修改",testType:this.$route.query.testType,baseurl:this.$route.query.apiurl,isNextDisabled:!1,isPreDisabled:!1,dialogFormVisible:!1,editObj:{id:"",apiname:"",apimethod:"",apiurl:"",index:""},method_options:[{label:"get",value:"get"},{label:"post",value:"post"},{label:"patch",value:"patch"},{label:"put",value:"put"},{label:"delete",value:"delete"}],params:{},body:{},body_form:{},response:{}}},components:{editor:O.a},methods:{json_change:function(){this.editBody="提交修改*"},changefile:function(e,t){t[2]=e.target.files[0]},go_back:function(){this.$router.back(-1)},asign_var:function(e){if(0!=e.indexOf("$")){if(0==e.indexOf("&i-"))return parseInt(this.storage.getItem(e.slice(3)));if(0==e.indexOf("&"))return this.storage.getItem(e.slice(1));if(0==e.indexOf("[")&&e.indexOf("]")==e.length-1){var t=JSON.parse(e);for(var s in t)"string"!=typeof t[s]&&"object"!=U()(t[s])||(t[s]=this.asign_var(t[s]));return C()(t)}return e}return"$Date"==e?Date.parse(new Date):"$true"==e||"$false"!=e&&void 0},parse_obj:function(e){if("string"==typeof e)return this.asign_var(e);if("object"==(void 0===e?"undefined":U()(e))){for(var t in e)e[t]=this.parse_obj(e[t]);return e}return e},save_userObj:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"response";if("string"==typeof e){if(0==e.indexOf("&"))this.storage.setItem(e.slice(1),t);else if(e!=t)throw s+" 不一致"}else if("object"==(void 0===e?"undefined":U()(e))){if("object"!=(void 0===t?"undefined":U()(t)))throw s+" 不一致";if("{}"==C()(e)&&e!=t)throw s+" 不一致";for(var a in e){if(void 0==t[a])throw a+" 不一致";this.save_userObj(e[a],t[a],a)}}else if(e!=t)throw s+" 不一致"},testUserLogin:function(){var e=this,t={email:"17388730192@163.com",pswmd5:"202cb962ac59075b964b07152d234b70",timestamp:Date.parse(new Date)};this.axios({baseURL:this.baseurl,url:"/api/v1/user/login",method:"post",data:t}).then(function(t){e.testUser=t.data,"0"==t.data.errcode?(e.testUserId=t.data.data.userid,e.testToken=t.data.data.token):e.$message({message:"测试用户登陆 FAIL-errcode 不一致",type:"error",center:!0,showClose:!0,duration:0})},function(t){e.$message({message:"测试用户登陆 FAIL-服务器错误，请检查 "+e.baseurl+" 服务器是否正常",type:"error",center:!0,showClose:!0,duration:0})})},adminLogin:function(){var e=this,t={email:"linzhifu221@163.com",pswmd5:"c313b271b06b2b50ad9a3e93e8744029",timestamp:Date.parse(new Date)};this.axios({baseURL:this.baseurl,url:"/api/v1/user/login",method:"post",data:t}).then(function(t){e.testUser=t.data,"0"==t.data.errcode?(e.adminUserId=t.data.data.userid,e.adminUserToken=t.data.data.token):e.$message({message:"管理员登陆 FAIL-errocde 不一致",type:"error",center:!0,showClose:!0,duration:0})},function(t){e.$message({message:"管理员登陆 FAIL-服务器错误，请检查 "+e.baseurl+" 服务器是否正常",type:"error",center:!0,showClose:!0,duration:0})})},deleteAdmin:function(e){var t=this,s={userid:this.adminUserId,token:this.adminUserToken},a={roleid:1,userid:Number(this.testUserId)};this.axios({baseURL:this.baseurl,url:"/api/v1/role/user",method:"delete",params:s,data:a}).then(function(s){return 0==s.data.errcode?void 0:void t.$message({message:e.apiname+" 删除管理员权限失败-errcode不一致",type:"error",center:!0,showClose:!0,duration:0})}).catch(function(s){t.$message({message:e.apiname+" 删除管理员权限失败-服务器错误，请检查 "+t.baseurl+" 服务器是否正常",type:"error",center:!0,showClose:!0,duration:0})})},deleteAuth:function(e){var t=this;if(""!=e.operatorType&&""!=e.operatorId&&""!=e.objectType&&""!=e.objectId&&""!=e.actions){var s={userid:this.adminUserId,token:this.adminUserToken},a={operator:{type:e.operatorType,id:Number(e.objectId)},object:{type:e.objectType,id:Number(e.objectId)},actions:e.actions.split(",")};this.axios({baseURL:this.baseurl,url:"/api/v1/role/permission",method:"delete",params:s,data:a}).then(function(s){return 0==s.data.errcode?void 0:void t.$message({message:e.apiname+" 删除权限失败-errcode不一致",type:"error",center:!0,showClose:!0,duration:0})}).catch(function(s){t.$message({message:e.apiname+" 删除权限失败-服务器错误，请检查 "+t.baseurl+" 服务器是否正常",type:"error",center:!0,showClose:!0,duration:0})})}else this.$message({message:"请确保必填项都已填写",type:"warning"})},apiTest:function(e){var t=this;if(this.isJsonString(this.response[e.id]))if(this.loading=!0,this.testBtn="测试中...",e.isAdmin){var s={userid:this.adminUserId,token:this.adminUserToken},a={roleid:1,userid:Number(this.testUserId)};this.axios({baseURL:this.baseurl,url:"/api/v1/role/user",method:"post",params:s,data:a}).then(function(s){if(0!=s.data.errcode)return t.$message({message:e.apiname+" 授予管理员权限失败",type:"error",center:!0}),t.loading=!1,void(t.testBtn="开始测试");var a={"Content-Type":e.contentType},r={};for(var i in t.params[e.id])if(""!=t.params[e.id][i][0]&&""!=t.params[e.id][i][1]){var n=t.asign_var(t.params[e.id][i][0]),o=t.asign_var(t.params[e.id][i][1]);r[n]=o}var l,c=r;if("application/x-www-form-urlencoded"==e.contentType){l=new FormData;var p=t.body_form[e.id],d={};for(var i in p)"file"==p[i][1]?(l.append(p[i][0],p[i][2]),console.log(U()(p[i][2]))):d[p[i][0]]=p[i][2];for(var i in d=t.parse_obj(d))l.append(i,d[i])}else{if(!t.isJsonString(t.body[e.id]))return void t.$message.error("body数据不符合json格式");l=JSON.parse(t.body[e.id]),l=t.parse_obj(l)}s=JSON.parse(t.response[e.id]);t.axios({baseURL:t.baseurl,url:e.apiurl,method:e.apimethod,params:c,data:l,headers:a,validateStatus:function(e){return e>=200&&e<=500}}).then(function(a){e.testdata=a.data;try{t.save_userObj(s,a.data)}catch(s){return t.$message({message:e.apiname+":"+s,type:"error",center:!0}),t.deleteAdmin(e),t.loading=!1,void(t.testBtn="开始测试")}t.$message({message:e.apiname+" 测试 PASS",type:"success",center:!0}),t.deleteAdmin(e),t.loading=!1,t.testBtn="开始测试"},function(s){console.log(s.response.data),e.testdata=s.response.data,t.$message({message:e.apiname+" 测试失败-服务器错误，请检查 "+t.baseurl+" 服务器是否正常",type:"error",center:!0}),t.deleteAdmin(e),t.loading=!1,t.testBtn="开始测试"})},function(s){t.$message({message:e.apiname+" 授予管理员权限失败-服务器错误，请检查 "+t.baseurl+" 服务器是否正常",type:"error",center:!0}),t.loading=!1,t.testBtn="开始测试"})}else if(e.isAuth){if(""==e.operatorType||""==e.operatorId||""==e.objectType||""==e.objectId||""==e.actions)return this.$message({message:"请确保必填项都已填写",type:"warning"}),this.loading=!1,void(this.testBtn="开始测试");var r={userid:this.adminUserId,token:this.adminUserToken},i={operator:{type:e.operatorType,id:Number(e.operatorId)},object:{type:e.objectType,id:Number(e.objectId)},actions:e.actions.split(",")};this.axios({baseURL:this.baseurl,url:"/api/v1/role/permission",method:"post",params:r,data:i}).then(function(s){if(0!=s.data.errcode)return t.$message({message:e.apiname+" 授予权限失败",type:"error",center:!0}),t.loading=!1,void(t.testBtn="开始测试");var a={"Content-Type":e.contentType},r={};for(var i in t.params[e.id])if(""!=t.params[e.id][i][0]&&""!=t.params[e.id][i][1]){var n=t.asign_var(t.params[e.id][i][0]),o=t.asign_var(t.params[e.id][i][1]);r[n]=o}var l,c=r;if("application/x-www-form-urlencoded"==e.contentType){l=new FormData;var p=t.body_form[e.id],d={};for(var i in p)d[p[i][0]]=p[i][2];for(var i in d=t.parse_obj(d))l.append(i,d[i])}else{if(!t.isJsonString(t.body[e.id]))return void t.$message.error("body数据不符合json格式");l=JSON.parse(t.body[e.id]),l=t.parse_obj(l)}s=JSON.parse(t.response[e.id]);t.axios({baseURL:t.baseurl,url:e.apiurl,method:e.apimethod,params:c,data:l,headers:a,validateStatus:function(e){return e>=200&&e<=500}}).then(function(a){e.testdata=a.data;try{t.save_userObj(s,a.data)}catch(s){return t.$message({message:e.apiname+":"+s,type:"error",center:!0}),t.deleteAdmin(e),t.loading=!1,void(t.testBtn="开始测试")}t.$message({message:e.apiname+" 测试 PASS",type:"success",center:!0}),t.deleteAuth(e),t.loading=!1,t.testBtn="开始测试"},function(s){console.log(s.response.data),e.testdata=s.response.data,t.$message({message:"请检查 "+t.baseurl+" 服务器是否正常",type:"error",center:!0}),t.deleteAuth(e),t.loading=!1,t.testBtn="开始测试"})},function(s){t.$message({message:e.apiname+" 授予权限失败-服务器错误，请检查 "+t.baseurl+" 服务器是否正常",type:"error",center:!0}),t.loading=!1,t.testBtn="开始测试"})}else{var n={"Content-Type":e.contentType},o={};for(var l in this.params[e.id])if(""!=this.params[e.id][l][0]&&""!=this.params[e.id][l][1]){var c=this.asign_var(this.params[e.id][l][0]),p=this.asign_var(this.params[e.id][l][1]);o[c]=p}var d,u=o;if("application/x-www-form-urlencoded"==e.contentType){d=new FormData;var m=this.body_form[e.id],h={};for(var l in m)"file"==m[l][1]?d.append(m[l][0],m[l][2]):h[m[l][0]]=m[l][2];for(var l in console.log(h),h=this.parse_obj(h))d.append(l,h[l])}else{if(!this.isJsonString(this.body[e.id]))return void this.$message.error("body数据不符合json格式");d=JSON.parse(this.body[e.id]),d=this.parse_obj(d)}var g=JSON.parse(this.response[e.id]);this.axios({baseURL:this.baseurl,url:e.apiurl,method:e.apimethod,params:u,data:d,headers:n,validateStatus:function(e){return e>=200&&e<=500}}).then(function(s){e.testdata=s.data;try{t.save_userObj(g,s.data)}catch(s){return t.$message({message:e.apiname+":"+s,type:"error",center:!0}),t.loading=!1,void(t.testBtn="开始测试")}t.$message({message:e.apiname+" 测试 PASS",type:"success",center:!0}),t.loading=!1,t.testBtn="开始测试"},function(s){e.testdata=s.response.data,t.$message({message:"请检查 "+t.baseurl+" 服务器是否正常",type:"error",center:!0}),t.loading=!1,t.testBtn="开始测试"})}else this.$message.error("response数据不符合json格式")},apiCaseTest:function(){var e=this;this.$confirm("即将开始 "+this.$route.query.apiCase+" api测试，请耐心等待","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.allTestLoading=!0,e.allTestBtn="测试中...";var t={userId:e.userId,token:e.token,testType:e.testType,url:e.baseurl},s={};if("量产云平台"==e.$route.query.projectName)s={testUserInfo:{testUserId:e.testUserId,testUserToken:e.testUserToken,adminUserId:e.adminUserId,adminUserToken:e.adminUserToken}};e.axios({baseURL:e.url,url:"/api/v1/apiCaseTest/",method:"post",params:t,data:s}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:e.$route.query.apiCase+" 测试 PASS",type:"success",center:!0,showClose:!0,duration:0}),e.allTestLoading=!1,e.allTestBtn="开始测试",e.get_apiCases()},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.allTestLoading=!1,e.allTestBtn="开始测试"})}).catch(function(){})},addParam:function(e){e.push(["",""]),this.editParam="提交修改*"},removeParam:function(e,t){var s=this;this.$confirm("提交修改后将永久删除, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){s.$delete(s.params[t],e.$index),s.editParam="提交修改*"}).catch(function(){})},edit_param:function(e,t,s){var a={};a.id=e;var r={};for(var i in s)""!=s[i][0]&&""!=s[i][1]&&(r[s[i][0]]=s[i][1]);a[t]=C()(r),this.handleEdit(a,!1),this.editParam="提交修改"},addForm:function(e){e.push(["","text",""]),this.editForm="提交修改*"},removeForm:function(e,t){var s=this;this.$confirm("提交修改后将永久删除, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){s.$delete(s.body_form[t],e.$index),s.editForm="提交修改*"}).catch(function(){})},edit_Form:function(e,t,s){var a={};a.id=e.id;var r={};for(var i in s){if(""==s[i][0]||""==s[i][2])return void this.$message({message:"参数不能为空",type:"error",center:!0,showClose:!0});r[s[i][0]]=s[i][1]+"$"+s[i][2]}a[t]=C()(r),a.contentType=e.contentType,this.handleEdit(a,!1),this.editForm="提交修改"},body_change:function(e){this.editBody="提交修改*",this.isJsonString(e)||this.$message({message:"body数据不符合json格式",type:"warning"})},edit_body:function(e,t,s){var a={};a.id=e.id,this.isJsonString(s)?(a[t]=s,a.contentType=e.contentType,this.handleEdit(a,!1),this.editBody="提交修改"):this.$message.error("body数据不符合json格式")},response_change:function(e){this.editResponse="提交修改*",this.isJsonString(e)||this.$message({message:"response数据不符合json格式",type:"warning"})},edit_response:function(e,t,s){var a={};a.id=e,this.isJsonString(s)?(a[t]=s,this.handleEdit(a,!1),this.editResponse="提交修改"):this.$message.error("response数据不符合json格式")},auth_change:function(e){this.editAuth="提交修改*"},edit_auth:function(e){var t={};!e.isAuth||e.operatorType&&e.operatorId&&e.objectType&&e.objectId&&!e.actions?(t.id=e.id,t.isAdmin=e.isAdmin,t.isAuth=e.isAuth,t.operatorType=e.operatorType,t.operatorId=e.operatorId,t.objectType=e.objectType,t.objectId=e.objectId,t.actions=e.actions,this.handleEdit(t,!1),this.editAuth="提交修改"):this.$message({message:"必填项不能为空",type:"error",center:!0})},get_apiCases:function(){var e,t,s=this,a=[],r=[],i={userId:this.userId,token:this.token,testType:this.testType};this.axios({baseURL:this.url,url:"api/v1/apiCase/",method:"get",params:i}).then(function(i){s.apiCases=i.data.results;for(var n=0;n<i.data.results.length;n++){if(i.data.results[n].apiparam){var o=JSON.parse(i.data.results[n].apiparam);for(var l in o)a.push([l,o[l]])}else a=[];if(s.$set(s.params,i.data.results[n].id,a),a=[],"application/x-www-form-urlencoded"==i.data.results[n].contentType)if(i.data.results[n].apijson){var c=JSON.parse(i.data.results[n].apijson);for(var l in c)r.push([l,c[l].slice(0,4),c[l].slice(5)])}else r=[];else if(i.data.results[n].apijson){c=JSON.parse(i.data.results[n].apijson);t=c}else t={};s.$set(s.body,i.data.results[n].id,C()(t,null,4)),s.$set(s.body_form,i.data.results[n].id,r),t={},r=[],e=i.data.results[n].apiresponse?JSON.parse(i.data.results[n].apiresponse):{},s.$set(s.response,i.data.results[n].id,C()(e,null,4)),e={}}s.pre=i.data.previous,s.pre?s.isPreDisabled=!1:s.isPreDisabled=!0,s.next=i.data.next,s.next?s.isNextDisabled=!1:s.isNextDisabled=!0},function(e){s.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),s.$router.push("/")})},open_edit:function(e){this.dialogFormVisible=!0,this.editObj.id=e.id,this.editObj.apiname=e.apiname,this.editObj.apimethod=e.apimethod,this.editObj.apiurl=e.apiurl,this.editObj.index=e.index},handleEdit:function(e){var t=this,s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!s||e.apiname&&e.apiurl&&e.apimethod){this.dialogFormVisible=!1;var a={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/apiCase/"+e.id+"/",method:"patch",params:a,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),s&&t.get_apiCases())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"名称、URL和请求方法不能为空",type:"error",center:!0})},handleDelete:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/apiCase/"+t.id+"/",method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):(s.$message({message:"删除成功",type:"success",center:!0}),s.get_apiCases())},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(){})},new_apicase:function(){var e=this;if(this.apiname&&this.apiurl&&this.editObj.apimethod){var t={apiname:this.apiname,apiurl:this.apiurl,apimethod:this.editObj.apimethod,testType:this.testType,user:this.userId},s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/apiCase/",method:"post",params:s,data:t}).then(function(t){t.data.errcode?e.$message({message:"新建失败",type:"error",center:!0}):(e.$message({message:"添加成功",type:"success",center:!0}),e.get_apiCases())},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.apiname="",this.apiurl="",this.editObj.apimethod=""}else this.$message({message:"名称、URL和请求方法不能为空",type:"error",center:!0})},cope_apicase:function(e){var t=this;delete e.id,e.testdata="";var s=e,a={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/apiCase/",method:"post",params:a,data:s}).then(function(e){e.data.errcode?t.$message({message:"新建失败",type:"error",center:!0}):(t.$message({message:"添加成功",type:"success",center:!0}),t.get_apiCases())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})},get_pre:function(){var e=this;this.axios.get(this.pre).then(function(t){if(t.data.errcode)e.$message({message:"加载失败",type:"error",center:!0,showClose:!0});else{e.$message({}),e.apiCases=t.data.results;for(var s=0;s<t.data.results.length;s++)t.data.results[s].apiparam?params=JSON.parse(t.data.results[s].apiparam):params={},t.data.results[s].apijson?body=JSON.parse(t.data.results[s].apijson):body={},t.data.results[s].apiresponse?response_obj=JSON.parse(t.data.results[s].apiresponse):response_obj={},e.$set(e.params,t.data.results[s].id,params),e.$set(e.body,t.data.results[s].id,body),e.$set(e.response,t.data.results[s].id,response_obj);e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0}},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_next:function(){var e=this;this.axios.get(this.next).then(function(t){if(t.data.errcode)e.$message({message:"加载失败",type:"error",center:!0,showClose:!0});else{e.$message({}),e.apiCases=t.data.results;for(var s=0;s<t.data.results.length;s++)t.data.results[s].apiparam?params=JSON.parse(t.data.results[s].apiparam):params={},t.data.results[s].apijson?body=JSON.parse(t.data.results[s].apijson):body={},t.data.results[s].apiresponse?response_obj=JSON.parse(t.data.results[s].apiresponse):response_obj={},e.$set(e.params,t.data.results[s].id,params),e.$set(e.body,t.data.results[s].id,body),e.$set(e.response,t.data.results[s].id,response_obj);e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0}},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0})})},isJsonString:function(e){try{if("object"==U()(JSON.parse(e)))return!0}catch(e){}return!1}},beforeCreate:function(){},created:function(){this.get_apiCases(),this.$route.query.projectName},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}}}),L={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级")]),s("br"),s("br"),e._v(" "),s("div",{staticStyle:{"font-size":"17px","margin-bottom":"10px"}},[e._v("\r\n            测试案例："+e._s(this.$route.query.projectName)+" - "+e._s(this.$route.query.apiName)+" - "+e._s(this.$route.query.apiCase)+"\r\n    ")]),e._v(" "),"量产云平台"==this.$route.query.projectName?s("div",{staticStyle:{"font-size":"17px","margin-bottom":"10px"}},[e._v("\r\n            管理员ID："+e._s(e.adminUserId)+"\r\n    ")]):e._e(),e._v(" "),"量产云平台"==this.$route.query.projectName?s("div",{staticStyle:{"font-size":"17px"}},[e._v("\r\n            测试用户ID："+e._s(e.testUserId)+"\r\n    ")]):e._e(),e._v(" "),s("br"),e._v(" "),s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.new_apicase}},[e._v("添加API")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.apiname,callback:function(t){e.apiname=t},expression:"apiname"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入URL"},model:{value:e.apiurl,callback:function(t){e.apiurl=t},expression:"apiurl"}}),e._v(" "),s("el-select",{attrs:{placeholder:"请求方法"},model:{value:e.editObj.apimethod,callback:function(t){e.$set(e.editObj,"apimethod",t)},expression:"editObj.apimethod"}},e._l(e.method_options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",loading:e.allTestLoading},on:{click:e.apiCaseTest}},[e._v(e._s(e.allTestBtn))]),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{border:"",stripe:"",data:e.apiCases.filter(function(t){return!e.search||t.apiname.toLowerCase().includes(e.search.toLowerCase())||t.apiurl.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","default-sort":{prop:"index",order:"ascending"},"header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tabs",{attrs:{type:"border-card"}},[s("el-tab-pane",{attrs:{label:"Params"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.params[t.row.id],"header-cell-style":{background:"#F2F6FC"}}},[s("el-table-column",{attrs:{label:"KEY"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{model:{value:t.row[0],callback:function(s){e.$set(t.row,0,s)},expression:"scope.row[0]"}})]}}],null,!0)}),e._v(" "),s("el-table-column",{attrs:{label:"VALUE"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{model:{value:t.row[1],callback:function(s){e.$set(t.row,1,s)},expression:"scope.row[1]"}})]}}],null,!0)}),e._v(" "),s("el-table-column",{attrs:{width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return s.preventDefault(),e.removeParam(a,t.row.id)}}})]}}],null,!0)})],1),e._v(" "),s("br"),e._v(" "),s("el-button",{staticClass:"el-icon-plus",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.addParam(e.params[t.row.id])}}},[e._v("添加Param\r\n                        ")]),e._v(" "),t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.edit_param(t.row.id,"apiparam",e.params[t.row.id])}}},[e._v(e._s(e.editParam)+"\r\n                        ")]):e._e()],1),e._v(" "),s("el-tab-pane",{attrs:{label:"Body"}},[s("el-select",{staticStyle:{width:"300px"},model:{value:t.row.contentType,callback:function(s){e.$set(t.row,"contentType",s)},expression:"scope.row.contentType"}},e._l(["application/x-www-form-urlencoded","application/json"],function(e){return s("el-option",{key:e,attrs:{value:e}})}),1),e._v(" "),s("br"),s("br"),e._v(" "),"application/json"==t.row.contentType?s("editor",{attrs:{height:"300",options:e.options,lang:"json",theme:"crimson_editor"},on:{input:e.json_change},model:{value:e.body[t.row.id],callback:function(s){e.$set(e.body,t.row.id,s)},expression:"body[scope.row.id]"}}):e._e(),e._v(" "),"application/x-www-form-urlencoded"==t.row.contentType?s("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.body_form[t.row.id],"header-cell-style":{background:"#F2F6FC"}}},[s("el-table-column",{attrs:{label:"KEY"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{model:{value:t.row[0],callback:function(s){e.$set(t.row,0,s)},expression:"scope.row[0]"}})]}}],null,!0)}),e._v(" "),s("el-table-column",{attrs:{label:"Type",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-select",{model:{value:t.row[1],callback:function(s){e.$set(t.row,1,s)},expression:"scope.row[1]"}},e._l(["text","file"],function(e){return s("el-option",{key:e,attrs:{value:e}})}),1)]}}],null,!0)}),e._v(" "),s("el-table-column",{attrs:{label:"VALUE"},scopedSlots:e._u([{key:"default",fn:function(t){return["text"==t.row[1]?s("el-input",{attrs:{type:"text"},model:{value:t.row[2],callback:function(s){e.$set(t.row,2,s)},expression:"scope.row[2]"}}):e._e(),e._v(" "),"file"==t.row[1]?s("input",{attrs:{type:"file"},on:{change:function(s){return e.changefile(s,t.row)}}}):e._e()]}}],null,!0)}),e._v(" "),s("el-table-column",{attrs:{width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return s.preventDefault(),e.removeForm(a,t.row.id)}}})]}}],null,!0)})],1):e._e(),e._v(" "),s("br"),e._v(" "),"application/x-www-form-urlencoded"==t.row.contentType?s("el-button",{staticClass:"el-icon-plus",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.addForm(e.body_form[t.row.id])}}},[e._v("添加表单\r\n                        ")]):e._e(),e._v(" "),t.row.user!=e.userId&&2!=e.userId||"application/x-www-form-urlencoded"!=t.row.contentType?e._e():s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.edit_Form(t.row,"apijson",e.body_form[t.row.id])}}},[e._v(e._s(e.editForm)+"\r\n                        ")]),e._v(" "),t.row.user!=e.userId&&2!=e.userId||"application/json"!=t.row.contentType?e._e():s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.edit_body(t.row,"apijson",e.body[t.row.id])}}},[e._v(e._s(e.editBody)+"\r\n                        ")])],1),e._v(" "),s("el-tab-pane",{attrs:{label:"Response"}},[s("el-input",{attrs:{type:"textarea",autosize:""},on:{change:function(s){return e.response_change(e.response[t.row.id])}},model:{value:e.response[t.row.id],callback:function(s){e.$set(e.response,t.row.id,s)},expression:"response[scope.row.id]"}}),s("br"),s("br"),e._v(" "),t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.edit_response(t.row.id,"apiresponse",e.response[t.row.id])}}},[e._v(e._s(e.editResponse)+"\r\n                        ")]):e._e()],1),e._v(" "),"量产云平台"==e.projectName?s("el-tab-pane",{attrs:{label:"权限管理"}},[s("el-checkbox",{on:{change:function(s){t.row.isAdmin&&(t.row.isAuth=!t.row.isAdmin),e.auth_change()}},model:{value:t.row.isAdmin,callback:function(s){e.$set(t.row,"isAdmin",s)},expression:"scope.row.isAdmin"}},[e._v("管理员")]),e._v(" "),s("el-checkbox",{on:{change:function(s){t.row.isAuth&&(t.row.isAdmin=!t.row.isAuth),e.auth_change()}},model:{value:t.row.isAuth,callback:function(s){e.$set(t.row,"isAuth",s)},expression:"scope.row.isAuth"}},[e._v("授权")]),e._v(" "),s("br"),s("br"),e._v(" "),s("div",[e._v("操作者信息：")]),s("br"),e._v(" "),s("el-form",{attrs:{inline:""}},[s("el-form-item",[s("el-select",{staticClass:"select-type",attrs:{clearable:"",placeholder:"请选择type(必填)",disabled:!t.row.isAuth},on:{change:function(t){return e.auth_change()}},model:{value:t.row.operatorType,callback:function(s){e.$set(t.row,"operatorType",s)},expression:"scope.row.operatorType"}},e._l(["user","role","team"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),s("el-form-item",[s("el-input",{staticClass:"input-item",attrs:{placeholder:"请输入id(必填)",clearable:"",disabled:!t.row.isAuth},on:{change:function(t){return e.auth_change()}},model:{value:t.row.operatorId,callback:function(s){e.$set(t.row,"operatorId",s)},expression:"scope.row.operatorId"}})],1)],1),e._v(" "),s("div",{staticClass:"operator"},[e._v("资源信息：")]),s("br"),e._v(" "),s("el-form",{attrs:{inline:""}},[s("el-form-item",[s("el-input",{staticClass:"select-type",attrs:{placeholder:"请输入type(必填)",clearable:"",disabled:!t.row.isAuth},on:{change:function(t){return e.auth_change()}},model:{value:t.row.objectType,callback:function(s){e.$set(t.row,"objectType",s)},expression:"scope.row.objectType"}})],1),e._v(" "),s("el-form-item",[s("el-input",{staticClass:"input-item",attrs:{placeholder:"请输入id(必填)",clearable:"",disabled:!t.row.isAuth},on:{change:function(t){return e.auth_change()}},model:{value:t.row.objectId,callback:function(s){e.$set(t.row,"objectId",s)},expression:"scope.row.objectId"}})],1)],1),e._v(" "),s("div",{staticClass:"operator"},[e._v("操作信息：")]),s("br"),e._v(" "),s("el-form",{attrs:{inline:""}},[s("el-form-item",[s("el-input",{staticClass:"select-type",attrs:{placeholder:"请输入内容(必填)",clearable:"",disabled:!t.row.isAuth},on:{change:function(t){return e.auth_change()}},model:{value:t.row.actions,callback:function(s){e.$set(t.row,"actions",s)},expression:"scope.row.actions"}})],1)],1),e._v(" "),t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.edit_auth(t.row)}}},[e._v(e._s(e.editAuth)+"\r\n                        ")]):e._e()],1):e._e(),e._v(" "),s("el-tab-pane",{attrs:{label:"测试数据"}},[s("el-button",{attrs:{size:"mini",type:"primary",loading:e.loading},on:{click:function(s){return s.preventDefault(),e.apiTest(t.row)}}},[e._v(e._s(e.testBtn)+"\r\n                        ")]),e._v(" "),s("br"),e._v(" "),s("pre",{staticStyle:{"font-size":"14px"},domProps:{textContent:e._s(t.row.testdata)}})],1)],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"",align:"center",prop:"index",width:"50px",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{label:"名称",align:"center",prop:"apiname"}}),e._v(" "),s("el-table-column",{attrs:{label:"请求方法",align:"center",prop:"apimethod",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{label:"URL",align:"center",prop:"apiurl"}}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"测试结果",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.result?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"快捷复制",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:function(s){return e.cope_apicase(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"名称","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.apiname,callback:function(t){e.$set(e.editObj,"apiname",t)},expression:"editObj.apiname"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"请求方法","label-width":"120px"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editObj.apimethod,callback:function(t){e.$set(e.editObj,"apimethod",t)},expression:"editObj.apimethod"}},e._l(e.method_options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"URL","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.apiurl,callback:function(t){e.$set(e.editObj,"apiurl",t)},expression:"editObj.apiurl"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"Index","label-width":"120px"}},[s("el-input-number",{attrs:{"controls-position":"right"},model:{value:e.editObj.index,callback:function(t){e.$set(e.editObj,"index",t)},expression:"editObj.index"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(e.editObj)}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var F=s("VU/8")(P,L,!1,function(e){s("HjVx")},"data-v-459f5666",null).exports,M={name:"WebCase",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),testBtn:"开始测试",loading:!1,webname:"",search:"",webCases:[],checkWebCases:[],pre:"",next:"",checkPre:"",checkNext:"",testType:this.$route.query.testType,weburl:this.$route.query.weburl,isNextDisabled:!1,isPreDisabled:!1,isCheckNextDisabled:!1,isCheckPreDisabled:!1,dialogFormVisible:!1,editObj:{id:"",webname:"",webcss:"",weboprate:"",webparam:"",index:"",type:"",checktext:""},activeName:""}},methods:{go_back:function(){this.$router.back(-1)},webTest:function(){var e=this;this.$confirm("1 请确认是否已打开浏览器服务端 </br>2 测试大约需几分钟请耐心等待 </br>3 即将开始 "+this.$route.query.webCase+" 测试","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...";var t={userId:e.userId,token:e.token,testType:e.testType,url:e.weburl};e.axios({baseURL:e.url,url:"/api/v1/webCaseTest/",method:"get",params:t}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:"PASS",type:"success",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试"},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},get_webCases:function(){var e=this,t={userId:this.userId,token:this.token,testType:this.testType};this.axios({baseURL:this.url,url:"api/v1/webCase/",method:"get",params:t}).then(function(t){e.webCases=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},get_checkWebCases:function(){var e=this,t={userId:this.userId,token:this.token,testType:this.testType};this.axios({baseURL:this.url,url:"api/v1/checkWebCase/",method:"get",params:t}).then(function(t){e.checkWebCases=t.data.results,e.checkPre=t.data.previous,e.checkPre?e.isCheckPreDisabled=!1:e.isCheckPreDisabled=!0,e.checkNext=t.data.next,e.checkNext?e.isCheckNextDisabled=!1:e.isCheckNextDisabled=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},open_edit:function(e,t){this.dialogFormVisible=!0,this.editObj.id=e.id,this.editObj.webname=e.webname,this.editObj.webcss=e.webcss,this.editObj.weboprate=e.weboprate,this.editObj.webparam=e.webparam,this.editObj.index=e.index,this.editObj.type=t,"check"==t&&(this.editObj.checktext=e.checktext)},handleEdit:function(e){var t=this;if(e.webname||"check"==e.type)if(e.webname||"check"!=e.type){this.dialogFormVisible=!1;var s={userId:this.userId,token:this.token},a="api/v1/webCase/"+e.id+"/";"check"==e.type&&(a="api/v1/checkWebCase/"+e.id+"/"),this.axios({baseURL:this.url,url:a,method:"patch",params:s,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),t.get_webCases(),t.get_checkWebCases())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"验证名称不能为空",type:"error",center:!0});else this.$message({message:"步骤名称不能为空",type:"error",center:!0})},handleDelete:function(e,t,s){var a=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:a.userId,token:a.token},r="api/v1/webCase/"+t.id+"/";"check"==s&&(r="api/v1/checkWebCase/"+t.id+"/"),a.axios({baseURL:a.url,url:r,method:"delete",params:e}).then(function(e){e.data.errcode?a.$message({message:"删除失败",type:"error",center:!0}):(a.$message({message:"删除成功",type:"success",center:!0}),a.get_webCases(),a.get_checkWebCases())},function(e){a.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})})},new_webcase:function(e){var t=this;if(this.webname||"check"==e)if(this.webname||"check"!=e){var s={webname:this.webname,testType:this.testType,user:this.userId},a="api/v1/webCase/";"check"==e&&(a="api/v1/checkWebCase/");var r={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:a,method:"post",params:r,data:s}).then(function(e){e.data.errcode?t.$message({message:"新建失败",type:"error",center:!0}):(t.$message({message:"添加成功",type:"success",center:!0}),t.get_webCases(),t.get_checkWebCases())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.webname=""}else this.$message({message:"验证名称不能为空",type:"error",center:!0});else this.$message({message:"步骤名称不能为空",type:"error",center:!0})},get_pre:function(){var e=this;this.axios.get(this.pre).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.webCases=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_checkPre:function(){var e=this;this.axios.get(this.checkPre).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.checkWebCases=t.data.results,e.checkPre=t.data.previous,e.checkPre?e.isCheckPreDisabled=!1:e.isCheckPreDisabled=!0,e.checkNext=t.data.next,e.checkNext?e.isCheckNextDisabled=!1:e.isCheckNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_next:function(){var e=this;this.axios.get(this.next).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0}):(e.webCases=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0})})},get_checkNext:function(){var e=this;this.axios.get(this.checkNext).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0}):(e.checkWebCases=t.data.results,e.checkPre=t.data.previous,e.checkPre?e.isCheckPreDisabled=!1:e.isCheckPreDisabled=!0,e.checkNext=t.data.next,e.checkNext?e.isCheckNextDisabled=!1:e.isCheckNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0})})}},beforeCreate:function(){},created:function(){this.get_webCases(),this.get_checkWebCases()},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}}},B={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级")]),s("br"),s("br"),e._v(" "),s("div",{staticStyle:{"font-size":"17px","margin-bottom":"10px"}},[e._v("\r\n            项目："+e._s(this.$route.query.projectName)+"\r\n    ")]),e._v(" "),s("div",{staticStyle:{"font-size":"17px","margin-bottom":"10px"}},[e._v("\r\n            测试："+e._s(this.$route.query.webName)+"\r\n    ")]),e._v(" "),s("div",{staticStyle:{"font-size":"17px"}},[e._v("\r\n            案例："+e._s(this.$route.query.webCase)+"\r\n    ")]),s("br"),e._v(" "),s("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.webTest()}}},[e._v(e._s(e.testBtn))]),e._v(" "),s("br"),s("br"),e._v(" "),s("el-collapse",{attrs:{accordion:""},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-collapse-item",{attrs:{title:"操作步骤",name:"1"}},[s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.new_webcase}},[e._v("添加步骤")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.webname,callback:function(t){e.webname=t},expression:"webname"}}),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{border:"",stripe:"",data:e.webCases.filter(function(t){return!e.search||t.webname.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","default-sort":{prop:"index",order:"ascending"},"header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"",align:"center",prop:"index",width:"50px",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{label:"步骤",align:"center",prop:"webname"}}),e._v(" "),s("el-table-column",{attrs:{label:"CSS选择器",align:"center",prop:"webcss"}}),e._v(" "),s("el-table-column",{attrs:{label:"元素操作",align:"center",prop:"weboprate"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作参数",align:"center",prop:"webparam"}}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"操作验证",name:"2"}},[s("div",[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.new_webcase("check")}}},[e._v("添加验证")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.webname,callback:function(t){e.webname=t},expression:"webname"}}),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{border:"",stripe:"",data:e.checkWebCases.filter(function(t){return!e.search||t.webname.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","default-sort":{prop:"index",order:"ascending"},"header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"",align:"center",prop:"index",width:"50px",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{label:"验证",align:"center",prop:"webname"}}),e._v(" "),s("el-table-column",{attrs:{label:"CSS选择器",align:"center",prop:"webcss"}}),e._v(" "),s("el-table-column",{attrs:{label:"元素操作",align:"center",prop:"weboprate"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作参数",align:"center",prop:"webparam"}}),e._v(" "),s("el-table-column",{attrs:{label:"验证数据",align:"center",prop:"checktext"}}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row,"check")}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row,"check")}}}):e._e()],1)]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isCheckPreDisabled},on:{click:e.get_checkPre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isCheckNextDisabled},on:{click:e.get_checkNext}},[e._v("下一页")])],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"步骤","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.webname,callback:function(t){e.$set(e.editObj,"webname",t)},expression:"editObj.webname"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"Css选择器","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.webcss,callback:function(t){e.$set(e.editObj,"webcss",t)},expression:"editObj.webcss"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"元素操作","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.weboprate,callback:function(t){e.$set(e.editObj,"weboprate",t)},expression:"editObj.weboprate"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"操作参数","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.webparam,callback:function(t){e.$set(e.editObj,"webparam",t)},expression:"editObj.webparam"}})],1)],1),e._v(" "),e.editObj.type?s("el-form",[s("el-form-item",{attrs:{label:"验证数据","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.checktext,callback:function(t){e.$set(e.editObj,"checktext",t)},expression:"editObj.checktext"}})],1)],1):e._e(),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"Index","label-width":"120px"}},[s("el-input-number",{attrs:{"controls-position":"right"},model:{value:e.editObj.index,callback:function(t){e.$set(e.editObj,"index",t)},expression:"editObj.index"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(e.editObj)}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var A=s("VU/8")(M,B,!1,function(e){s("pEdj")},"data-v-5fc547d5",null).exports,R={name:"AppCase",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),testBtn:"开始测试",loading:!1,appname:"",search:"",appCases:[],checkAppCases:[],pre:"",next:"",checkPre:"",checkNext:"",testType:this.$route.query.testType,isNextDisabled:!1,isPreDisabled:!1,isCheckNextDisabled:!1,isCheckPreDisabled:!1,dialogFormVisible:!1,editObj:{id:"",appname:"",selectmethod:"",selectparam:"",appoprate:"",appparam:"",index:"",type:"",checktext:""},activeName:""}},methods:{go_back:function(){this.$router.back(-1)},appTest:function(){var e=this;this.$confirm("1 请确认移动端是否开启开发者模式并连接测试PC </br>                 2 请确认是否已打开appium服务端</br>                 3 测试大约需几分钟请耐心等待 </br>                 4 即将开始 "+this.$route.query.appCase+" 测试","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...";var t={userId:e.userId,token:e.token,testType:e.testType};e.axios({baseURL:e.url,url:"/api/v1/appCaseTest/",method:"get",params:t}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:"PASS",type:"success",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试"},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},get_appCases:function(){var e=this,t={userId:this.userId,token:this.token,testType:this.testType};this.axios({baseURL:this.url,url:"api/v1/appCase/",method:"get",params:t}).then(function(t){e.appCases=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},get_checkAppCases:function(){var e=this,t={userId:this.userId,token:this.token,testType:this.testType};this.axios({baseURL:this.url,url:"api/v1/checkAppCase/",method:"get",params:t}).then(function(t){e.checkAppCases=t.data.results,e.checkPre=t.data.previous,e.checkPre?e.isCheckPreDisabled=!1:e.isCheckPreDisabled=!0,e.checkNext=t.data.next,e.checkNext?e.isCheckNextDisabled=!1:e.isCheckNextDisabled=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},open_edit:function(e,t){this.dialogFormVisible=!0,this.editObj.id=e.id,this.editObj.appname=e.appname,this.editObj.selectmethod=e.selectmethod,this.editObj.selectparam=e.selectparam,this.editObj.appoprate=e.appoprate,this.editObj.appparam=e.appparam,this.editObj.index=e.index,this.editObj.type=t,"check"==t&&(this.editObj.checktext=e.checktext)},handleEdit:function(e){var t=this;if(e.appname||"check"==e.type)if(e.appname||"check"!=e.type){this.dialogFormVisible=!1;var s={userId:this.userId,token:this.token},a="api/v1/appCase/"+e.id+"/";"check"==e.type&&(a="api/v1/checkAppCase/"+e.id+"/"),this.axios({baseURL:this.url,url:a,method:"patch",params:s,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),t.get_appCases(),t.get_checkAppCases())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"验证名称不能为空",type:"error",center:!0});else this.$message({message:"步骤名称不能为空",type:"error",center:!0})},handleDelete:function(e,t,s){var a=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:a.userId,token:a.token},r="api/v1/appCase/"+t.id+"/";"check"==s&&(r="api/v1/checkAppCase/"+t.id+"/"),a.axios({baseURL:a.url,url:r,method:"delete",params:e}).then(function(e){e.data.errcode?a.$message({message:"删除失败",type:"error",center:!0}):(a.$message({message:"删除成功",type:"success",center:!0}),a.get_appCases(),a.get_checkAppCases())},function(e){a.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})})},new_appcase:function(e){var t=this;if(this.appname||"check"==e)if(this.appname||"check"!=e){var s={appname:this.appname,testType:this.testType,user:this.userId},a="api/v1/appCase/";"check"==e&&(a="api/v1/checkAppCase/");var r={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:a,method:"post",params:r,data:s}).then(function(e){e.data.errcode?t.$message({message:"新建失败",type:"error",center:!0}):(t.$message({message:"添加成功",type:"success",center:!0}),t.get_appCases(),t.get_checkAppCases())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.appname=""}else this.$message({message:"验证名称不能为空",type:"error",center:!0});else this.$message({message:"步骤名称不能为空",type:"error",center:!0})},get_pre:function(){var e=this;this.axios.get(this.pre).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.appCases=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_checkPre:function(){var e=this;this.axios.get(this.checkPre).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.checkAppCases=t.data.results,e.checkPre=t.data.previous,e.checkPre?e.isCheckPreDisabled=!1:e.isCheckPreDisabled=!0,e.checkNext=t.data.next,e.checkNext?e.isCheckNextDisabled=!1:e.isCheckNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_next:function(){var e=this;this.axios.get(this.next).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0}):(e.appCases=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0})})},get_checkNext:function(){var e=this;this.axios.get(this.checkNext).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0}):(e.checkAppCases=t.data.results,e.checkPre=t.data.previous,e.checkPre?e.isCheckPreDisabled=!1:e.isCheckPreDisabled=!0,e.checkNext=t.data.next,e.checkNext?e.isCheckNextDisabled=!1:e.isCheckNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0})})}},beforeCreate:function(){},created:function(){this.get_appCases(),this.get_checkAppCases()},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}}},q={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级")]),s("br"),s("br"),e._v(" "),s("div",{staticStyle:{"font-size":"17px","margin-bottom":"10px"}},[e._v("\r\n            项目："+e._s(this.$route.query.projectName)+"\r\n    ")]),e._v(" "),s("div",{staticStyle:{"font-size":"17px","margin-bottom":"10px"}},[e._v("\r\n            app："+e._s(this.$route.query.appName)+"\r\n    ")]),e._v(" "),s("div",{staticStyle:{"font-size":"17px"}},[e._v("\r\n            案例："+e._s(this.$route.query.appCase)+"\r\n    ")]),s("br"),e._v(" "),s("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.appTest()}}},[e._v(e._s(e.testBtn))]),e._v(" "),s("br"),s("br"),e._v(" "),s("el-collapse",{attrs:{accordion:""},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-collapse-item",{attrs:{title:"操作步骤",name:"1"}},[s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.new_appcase}},[e._v("添加步骤")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.appname,callback:function(t){e.appname=t},expression:"appname"}}),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{border:"",stripe:"",data:e.appCases.filter(function(t){return!e.search||t.appname.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","default-sort":{prop:"index",order:"ascending"},"header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"",align:"center",prop:"index",width:"50px",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{label:"步骤",align:"center",prop:"appname"}}),e._v(" "),s("el-table-column",{attrs:{label:"元素定位方法",align:"center",prop:"selectmethod"}}),e._v(" "),s("el-table-column",{attrs:{label:"元素定位参数",align:"center",prop:"selectparam"}}),e._v(" "),s("el-table-column",{attrs:{label:"元素操作方法",align:"center",prop:"appoprate"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作参数",align:"center",prop:"appparam"}}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"操作验证",name:"2"}},[s("div",[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.new_appcase("check")}}},[e._v("添加验证")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.appname,callback:function(t){e.appname=t},expression:"appname"}}),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{border:"",stripe:"",data:e.checkAppCases.filter(function(t){return!e.search||t.appname.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","default-sort":{prop:"index",order:"ascending"},"header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"",align:"center",prop:"index",width:"50px",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{label:"验证",align:"center",prop:"appname"}}),e._v(" "),s("el-table-column",{attrs:{label:"元素定位方法",align:"center",prop:"selectmethod"}}),e._v(" "),s("el-table-column",{attrs:{label:"元素定位参数",align:"center",prop:"selectparam"}}),e._v(" "),s("el-table-column",{attrs:{label:"元素操作",align:"center",prop:"appoprate"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作参数",align:"center",prop:"appparam"}}),e._v(" "),s("el-table-column",{attrs:{label:"验证数据",align:"center",prop:"checktext"}}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row,"check")}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row,"check")}}}):e._e()],1)]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isCheckPreDisabled},on:{click:e.get_checkPre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isCheckNextDisabled},on:{click:e.get_checkNext}},[e._v("下一页")])],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"步骤","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.appname,callback:function(t){e.$set(e.editObj,"appname",t)},expression:"editObj.appname"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"元素定位方法","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.selectmethod,callback:function(t){e.$set(e.editObj,"selectmethod",t)},expression:"editObj.selectmethod"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"元素定位参数","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.selectparam,callback:function(t){e.$set(e.editObj,"selectparam",t)},expression:"editObj.selectparam"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"元素操作","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.appoprate,callback:function(t){e.$set(e.editObj,"appoprate",t)},expression:"editObj.appoprate"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"操作参数","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.appparam,callback:function(t){e.$set(e.editObj,"appparam",t)},expression:"editObj.appparam"}})],1)],1),e._v(" "),e.editObj.type?s("el-form",[s("el-form-item",{attrs:{label:"验证数据","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.checktext,callback:function(t){e.$set(e.editObj,"checktext",t)},expression:"editObj.checktext"}})],1)],1):e._e(),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"Index","label-width":"120px"}},[s("el-input-number",{attrs:{"controls-position":"right"},model:{value:e.editObj.index,callback:function(t){e.$set(e.editObj,"index",t)},expression:"editObj.index"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(e.editObj)}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var V=s("VU/8")(R,q,!1,function(e){s("OdAi")},"data-v-071e2288",null).exports,z={name:"WebType",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),testBtn:"开始测试",loading:!1,typename:"",typedes:"",search:"",testtypes:[],pre:"",next:"",isNextDisabled:!1,isPreDisabled:!1,content_type:this.$route.query.content_type,object_id:this.$route.query.object_id,weburl:this.$route.query.weburl,dialogFormVisible:!1,editObj:{id:"",index:"",typename:"",typedes:"",is_test:""}}},methods:{go_back:function(){this.$router.back(-1)},webTest:function(){var e=this;this.$confirm("1 请确认是否已打开浏览器服务端 </br>2 测试大约需几分钟请耐心等待 </br>3 即将开始 "+this.$route.query.webName+" 测试","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...";var t={userId:e.userId,token:e.token,object_id:e.object_id,content_type:e.content_type,url:e.weburl};e.axios({baseURL:e.url,url:"/api/v1/webTypeTest/",method:"get",params:t}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:"PASS",type:"success",center:!0,showClose:!0,duration:0}),e.get_testtypes(),e.loading=!1,e.testBtn="开始测试",e.get_testtypes()},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.get_testtypes(),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},get_testtypes:function(){var e=this,t={userId:this.userId,token:this.token,object_id:this.object_id,content_type:this.content_type};this.axios({baseURL:this.url,url:"api/v1/testType/",method:"get",params:t}).then(function(t){e.testtypes=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},open_edit:function(e){this.dialogFormVisible=!0,this.editObj.id=e.id,this.editObj.index=e.index,this.editObj.typename=e.typename,this.editObj.typedes=e.typedes,this.editObj.is_test=e.is_test},handleEdit:function(e){var t=this;if(e.typename&&e.typedes){this.dialogFormVisible=!1;var s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/testType/"+e.id+"/",method:"patch",params:s,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),t.get_testtypes())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"名称、描述不能为空",type:"error",center:!0})},handleDelete:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/testType/"+t.id+"/",method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):(s.$message({message:"删除成功",type:"success",center:!0}),s.get_testtypes())},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(){})},new_webcase:function(){var e=this;if(this.typename&&this.typedes){var t={typename:this.typename,typedes:this.typedes,object_id:this.object_id,content_type:this.content_type,user:this.userId},s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/testType/",method:"post",params:s,data:t}).then(function(t){t.data.errcode?e.$message({message:"添加失败",type:"error",center:!0}):(e.$message({message:"添加成功",type:"success",center:!0}),e.get_testtypes())},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.typename="",this.typedes=""}else this.$message({message:"名称、描述不能为空",type:"error",center:!0})},get_pre:function(){var e=this;this.axios.get(this.pre).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.testtypes=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_next:function(){var e=this;this.axios.get(this.next).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.testtypes=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},go_webTest:function(e){var t={testType:e.id,weburl:this.weburl,projectName:this.$route.query.projectName,webName:this.$route.query.webName,webCase:e.typename};this.$router.push({path:"/home/webCase/",query:t})}},beforeCreate:function(){},created:function(){this.get_testtypes()},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}}},E={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级"),s("br"),s("br")]),e._v(" "),s("div",{staticStyle:{"font-size":"17px","margin-bottom":"10px"}},[e._v("\r\n            项目："+e._s(this.$route.query.projectName)+"\r\n    ")]),e._v(" "),s("div",{staticStyle:{"font-size":"17px"}},[e._v("\r\n            测试："+e._s(this.$route.query.webName)+"\r\n    ")]),s("br"),e._v(" "),s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.new_webcase}},[e._v("添加分类")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.typename,callback:function(t){e.typename=t},expression:"typename"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入描述"},model:{value:e.typedes,callback:function(t){e.typedes=t},expression:"typedes"}}),e._v(" "),s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",loading:e.loading},on:{click:e.webTest}},[e._v(e._s(e.testBtn))]),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{stripe:"",border:"",data:e.testtypes.filter(function(t){return!e.search||t.typename.toLowerCase().includes(e.search.toLowerCase())||t.typedes.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","header-cell-style":{background:"#ddd"},"default-sort":{prop:"index",order:"ascending"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"",align:"center",prop:"is_test",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("input",{attrs:{type:"checkbox",disabled:""},domProps:{checked:e.row.is_test}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"",align:"center",prop:"index",width:"50px",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{label:"名称",align:"center",prop:"typename"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击查看 "+t.row.typename+" 操作详情",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.go_webTest(t.row)}}},[s("p",[e._v(e._s(t.row.typename))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"描述",align:"center",prop:"typedes"}}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center",prop:"update_time"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"测试",align:"center",prop:"result",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.result?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入名称关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"名称","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.typename,callback:function(t){e.$set(e.editObj,"typename",t)},expression:"editObj.typename"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"描述","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.typedes,callback:function(t){e.$set(e.editObj,"typedes",t)},expression:"editObj.typedes"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"优先级","label-width":"120px"}},[s("el-input-number",{attrs:{"controls-position":"right"},model:{value:e.editObj.index,callback:function(t){e.$set(e.editObj,"index",t)},expression:"editObj.index"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"是否测试","label-width":"120px"}},[s("el-checkbox",{model:{value:e.editObj.is_test,callback:function(t){e.$set(e.editObj,"is_test",t)},expression:"editObj.is_test"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(e.editObj)}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var H=s("VU/8")(z,E,!1,function(e){s("ExMG")},"data-v-5c227c62",null).exports,J={name:"ApiType",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),testUserId:this.storage.getItem("testUserId"),testUserToken:this.storage.getItem("testUserToken"),adminUserId:this.storage.getItem("adminUserId"),adminUserToken:this.storage.getItem("adminUserToken"),testBtn:"开始测试",loading:!1,apiVarFormVisible:!1,varname:"",varvalue:"",typename:"",typedes:"",search:"",testtypes:[],apiVars:[],pre:"",next:"",isNextDisabled:!1,isPreDisabled:!1,content_type:this.$route.query.content_type,object_id:this.$route.query.object_id,apiurl:this.$route.query.apiurl,dialogFormVisible:!1,editObj:{id:"",index:"",typename:"",typedes:"",is_test:""}}},methods:{go_back:function(){this.$router.back(-1)},apiTest:function(){var e=this;this.$confirm("即将开始 "+this.$route.query.apiName+" 模块测试，请耐心等待","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...";var t={userId:e.userId,token:e.token,object_id:e.object_id,content_type:e.content_type,url:e.apiurl},s={};if("量产云平台"==e.$route.query.projectName)s={testUserInfo:{testUserId:e.testUserId,testUserToken:e.testUserToken,adminUserId:e.adminUserId,adminUserToken:e.adminUserToken}};e.axios({baseURL:e.url,url:"/api/v1/apiTypeTest/",method:"post",params:t,data:s}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:e.$route.query.apiName+" 模块测试 PASS",type:"success",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试",e.get_testtypes()},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.get_testtypes(),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},get_testtypes:function(){var e=this,t={userId:this.userId,token:this.token,object_id:this.object_id,content_type:this.content_type};this.axios({baseURL:this.url,url:"api/v1/testType/",method:"get",params:t}).then(function(t){e.testtypes=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},get_apiVars:function(){var e=this,t={userId:this.userId,token:this.token,apiManager:this.object_id};this.axios({baseURL:this.url,url:"api/v1/apiVar/",method:"get",params:t}).then(function(t){e.apiVars=t.data.results},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},set_var:function(){for(var e in this.apiVars)console.log(this.apiVars),this.storage.setItem(this.apiVars[e].varname.slice(1),this.apiVars[e].varvalue)},new_var:function(){var e=this;if(this.varname&&this.varvalue)if(0==this.varname.indexOf("&"))if(""!=this.varname.slice(1)){var t={varname:this.varname,varvalue:this.varvalue,apiManager:this.object_id},s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/apiVar/",method:"post",params:s,data:t}).then(function(t){t.data.errcode?e.$message({message:"添加失败",type:"error",center:!0}):(e.$message({message:"添加成功",type:"success",center:!0}),e.get_apiVars())},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.varname="",this.varvalue=""}else this.$message({message:"名称&后不能为空(错误：&，必须：&abc)",type:"error",center:!0});else this.$message({message:"名称必须以&开头，如&abc",type:"error",center:!0});else this.$message({message:"名称和值不能为空",type:"error",center:!0})},edit_var:function(e){var t=this;if(e.varname&&e.varvalue)if(0==e.varname.indexOf("&"))if(""!=e.varname.slice(1)){var s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/apiVar/"+e.id+"/",method:"patch",params:s,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),t.get_apiVars())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"名称&后不能为空(错误：&，必须：&abc)",type:"error",center:!0});else this.$message({message:"名称必须以&开头，如&abc",type:"error",center:!0});else this.$message({message:"名称和值不能为空",type:"error",center:!0})},delete_var:function(e){var t=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var s={userId:t.userId,token:t.token};t.axios({baseURL:t.url,url:"api/v1/apiVar/"+e.id+"/",method:"delete",params:s}).then(function(e){e.data.errcode?t.$message({message:"删除失败",type:"error",center:!0}):(t.$message({message:"删除成功",type:"success",center:!0}),t.get_apiVars())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(){})},open_edit:function(e){this.dialogFormVisible=!0,this.editObj.id=e.id,this.editObj.index=e.index,this.editObj.typename=e.typename,this.editObj.typedes=e.typedes,this.editObj.is_test=e.is_test},handleEdit:function(e){var t=this;if(e.typename&&e.typedes){this.dialogFormVisible=!1;var s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/testType/"+e.id+"/",method:"patch",params:s,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),t.get_testtypes())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"名称和描述不能为空",type:"error",center:!0})},handleDelete:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/testType/"+t.id+"/",method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):(s.$message({message:"删除成功",type:"success",center:!0}),s.get_testtypes())},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(){})},new_webcase:function(){var e=this;if(this.typename&&this.typedes){var t={typename:this.typename,typedes:this.typedes,object_id:this.object_id,content_type:this.content_type,user:this.userId},s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/testType/",method:"post",params:s,data:t}).then(function(t){t.data.errcode?e.$message({message:"添加失败",type:"error",center:!0}):(e.$message({message:"添加成功",type:"success",center:!0}),e.get_testtypes())},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.typename="",this.typedes=""}else this.$message({message:"名称和描述不能为空",type:"error",center:!0})},get_pre:function(){var e=this;this.axios.get(this.pre).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.testtypes=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_next:function(){var e=this;this.axios.get(this.next).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.testtypes=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},go_apiTest:function(e){var t={testType:e.id,apiurl:this.apiurl,projectName:this.$route.query.projectName,apiName:this.$route.query.apiName,apiCase:e.typename};this.$router.push({path:"/home/apiCase/",query:t})}},beforeCreate:function(){},created:function(){this.get_testtypes(),this.get_apiVars(),this.set_var()},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}}},W={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级"),s("br"),s("br")]),e._v(" "),s("div",{staticStyle:{"font-size":"17px","margin-bottom":"10px"}},[e._v("\r\n            项目："+e._s(this.$route.query.projectName)+"\r\n    ")]),e._v(" "),s("div",{staticStyle:{"font-size":"17px"}},[e._v("\r\n            测试："+e._s(this.$route.query.apiName)+"\r\n    ")]),s("br"),e._v(" "),s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.new_webcase}},[e._v("添加分类")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.typename,callback:function(t){e.typename=t},expression:"typename"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入描述"},model:{value:e.typedes,callback:function(t){e.typedes=t},expression:"typedes"}}),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设置API自定义变量",placement:"top-start"}},["量产云平台"==this.$route.query.projectName?s("el-button",{staticStyle:{float:"right","margin-left":"10px"},attrs:{icon:"el-icon-edit",type:"primary"},on:{click:function(t){e.apiVarFormVisible=!0}}}):e._e()],1),e._v(" "),s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",loading:e.loading},on:{click:e.apiTest}},[e._v(e._s(e.testBtn))]),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{stripe:"",border:"",data:e.testtypes.filter(function(t){return!e.search||t.typename.toLowerCase().includes(e.search.toLowerCase())||t.typedes.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","header-cell-style":{background:"#ddd"},"default-sort":{prop:"index",order:"ascending"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"",align:"center",prop:"is_test",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("input",{attrs:{type:"checkbox",disabled:""},domProps:{checked:e.row.is_test}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"",align:"center",prop:"index",width:"50px",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{label:"名称",align:"center",prop:"typename"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击查看 "+t.row.typename+" 接口",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.go_apiTest(t.row)}}},[s("p",[e._v(e._s(t.row.typename))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"描述",align:"center",prop:"typedes"}}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center",prop:"update_time"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"测试",align:"center",prop:"result",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.result?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入名称关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"名称","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.typename,callback:function(t){e.$set(e.editObj,"typename",t)},expression:"editObj.typename"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"描述","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.typedes,callback:function(t){e.$set(e.editObj,"typedes",t)},expression:"editObj.typedes"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"优先级","label-width":"120px"}},[s("el-input-number",{attrs:{"controls-position":"right"},model:{value:e.editObj.index,callback:function(t){e.$set(e.editObj,"index",t)},expression:"editObj.index"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"是否测试","label-width":"120px"}},[s("el-checkbox",{model:{value:e.editObj.is_test,callback:function(t){e.$set(e.editObj,"is_test",t)},expression:"editObj.is_test"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(e.editObj)}}},[e._v("确 定")])],1)],1),e._v(" "),s("el-dialog",{attrs:{width:"500px",title:"自定义变量",visible:e.apiVarFormVisible},on:{"update:visible":function(t){e.apiVarFormVisible=t}}},[s("div",[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.new_var()}}},[e._v("添加")]),e._v(" "),s("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"请输入变量名"},model:{value:e.varname,callback:function(t){e.varname=t},expression:"varname"}}),e._v(" "),s("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"请输入变量值"},model:{value:e.varvalue,callback:function(t){e.varvalue=t},expression:"varvalue"}}),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.apiVars,"header-cell-style":{background:"#F2F6FC"}}},[s("el-table-column",{attrs:{label:"变量名"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{model:{value:t.row.varname,callback:function(s){e.$set(t.row,"varname",s)},expression:"scope.row.varname"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"变量值"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{model:{value:t.row.varvalue,callback:function(s){e.$set(t.row,"varvalue",s)},expression:"scope.row.varvalue"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.edit_var(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.delete_var(t.row)}}}):e._e()],1)]}}])})],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.apiVarFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.apiVarFormVisible=!1,e.set_var()}}},[e._v("设置")])],1)],1)],1)},staticRenderFns:[]};var Y=s("VU/8")(J,W,!1,function(e){s("j77a")},"data-v-7d4a65e0",null).exports,Z={name:"AppType",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),testBtn:"开始测试",loading:!1,typename:"",typedes:"",search:"",testtypes:[],pre:"",next:"",isNextDisabled:!1,isPreDisabled:!1,content_type:this.$route.query.content_type,object_id:this.$route.query.object_id,weburl:this.$route.query.weburl,dialogFormVisible:!1,editObj:{id:"",index:"",typename:"",typedes:"",is_test:""}}},methods:{go_back:function(){this.$router.back(-1)},appTest:function(){var e=this;this.$confirm("1 请确认移动端是否开启开发者模式并连接测试PC </br>                 2 请确认是否已打开appium服务端 </br>                 3 测试大约需几分钟请耐心等待 </br>                 4 即将开始 "+this.$route.query.appName+" app测试","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...";var t={userId:e.userId,token:e.token,object_id:e.object_id,content_type:e.content_type};e.axios({baseURL:e.url,url:"/api/v1/appTypeTest/",method:"get",params:t}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:"PASS",type:"success",center:!0,showClose:!0,duration:0}),e.get_testtypes(),e.loading=!1,e.testBtn="开始测试",e.get_testtypes()},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.get_testtypes(),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},get_testtypes:function(){var e=this,t={userId:this.userId,token:this.token,object_id:this.object_id,content_type:this.content_type};this.axios({baseURL:this.url,url:"api/v1/testType/",method:"get",params:t}).then(function(t){e.testtypes=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},open_edit:function(e){this.dialogFormVisible=!0,this.editObj.id=e.id,this.editObj.index=e.index,this.editObj.typename=e.typename,this.editObj.typedes=e.typedes,this.editObj.is_test=e.is_test},handleEdit:function(e){var t=this;if(e.typename&&e.typedes){this.dialogFormVisible=!1;var s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/testType/"+e.id+"/",method:"patch",params:s,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),t.get_testtypes())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"名称、描述不能为空",type:"error",center:!0})},handleDelete:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/testType/"+t.id+"/",method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):(s.$message({message:"删除成功",type:"success",center:!0}),s.get_testtypes())},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(){})},new_webcase:function(){var e=this;if(this.typename&&this.typedes){var t={typename:this.typename,typedes:this.typedes,object_id:this.object_id,content_type:this.content_type,user:this.userId},s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/testType/",method:"post",params:s,data:t}).then(function(t){t.data.errcode?e.$message({message:"添加失败",type:"error",center:!0}):(e.$message({message:"添加成功",type:"success",center:!0}),e.get_testtypes())},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.typename="",this.typedes=""}else this.$message({message:"名称、描述不能为空",type:"error",center:!0})},get_pre:function(){var e=this;this.axios.get(this.pre).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.testtypes=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_next:function(){var e=this;this.axios.get(this.next).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.testtypes=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},go_webTest:function(e){var t={testType:e.id,projectName:this.$route.query.projectName,appName:this.$route.query.appName,appCase:e.typename};this.$router.push({path:"/home/appCase/",query:t})}},beforeCreate:function(){},created:function(){this.get_testtypes()},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}}},K={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级"),s("br"),s("br")]),e._v(" "),s("div",{staticStyle:{"font-size":"17px","margin-bottom":"10px"}},[e._v("\r\n            项目："+e._s(this.$route.query.projectName)+"\r\n    ")]),e._v(" "),s("div",{staticStyle:{"font-size":"17px"}},[e._v("\r\n            app："+e._s(this.$route.query.appName)+"\r\n    ")]),s("br"),e._v(" "),s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.new_webcase}},[e._v("添加分类")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.typename,callback:function(t){e.typename=t},expression:"typename"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入描述"},model:{value:e.typedes,callback:function(t){e.typedes=t},expression:"typedes"}}),e._v(" "),s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",loading:e.loading},on:{click:e.appTest}},[e._v(e._s(e.testBtn))]),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{stripe:"",border:"",data:e.testtypes.filter(function(t){return!e.search||t.typename.toLowerCase().includes(e.search.toLowerCase())||t.typedes.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","header-cell-style":{background:"#ddd"},"default-sort":{prop:"index",order:"ascending"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"",align:"center",prop:"is_test",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("input",{attrs:{type:"checkbox",disabled:""},domProps:{checked:e.row.is_test}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"",align:"center",prop:"index",width:"50px",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{label:"名称",align:"center",prop:"typename"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击查看 "+t.row.typename+" 测试详情",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.go_webTest(t.row)}}},[s("p",[e._v(e._s(t.row.typename))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"描述",align:"center",prop:"typedes"}}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center",prop:"update_time"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"测试",align:"center",prop:"result",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.result?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入名称关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"名称","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.typename,callback:function(t){e.$set(e.editObj,"typename",t)},expression:"editObj.typename"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"描述","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.typedes,callback:function(t){e.$set(e.editObj,"typedes",t)},expression:"editObj.typedes"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"优先级","label-width":"120px"}},[s("el-input-number",{attrs:{"controls-position":"right"},model:{value:e.editObj.index,callback:function(t){e.$set(e.editObj,"index",t)},expression:"editObj.index"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"是否测试","label-width":"120px"}},[s("el-checkbox",{model:{value:e.editObj.is_test,callback:function(t){e.$set(e.editObj,"is_test",t)},expression:"editObj.is_test"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(e.editObj)}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var G=s("VU/8")(Z,K,!1,function(e){s("NUfy")},"data-v-1e6cfbb7",null).exports;window.onresize=function(){document.getElementById("myiframe").height=document.documentElement.clientHeight};var Q={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("iframe",{attrs:{id:"myiframe",src:"http://172.16.9.88:8081",height:"720px",width:"100%",scrolling:"no",frameborder:"0"}})])}]};var X=s("VU/8")({name:"Log",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token")}}},Q,!1,function(e){s("K67B")},"data-v-196d835a",null).exports,ee={name:"Report",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),reports:[],project_options:[],projectId:"",search:this.$route.query.projectName,pre:"",next:"",isNextDisabled:!1,isPreDisabled:!1}},methods:{go_back:function(){this.$router.back(-1)},get_reports:function(){var e=this,t={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/report/",method:"get",params:t}).then(function(t){e.reports=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},new_report:function(){if(this.projectId){for(var e=0;e<this.project_options.length;e++)if(console.log(this.project_options[e]),this.project_options[e].value==this.projectId&&"量产云平台"==this.project_options[e].label){var t={projectId:this.projectId,projectName:this.project_options[e].label};return void this.$router.push({path:"/home/mpcloud",query:t})}}else this.$message({message:"请选择项目",type:"error",center:!0})},get_pre:function(){var e=this;this.axios({url:this.pre,method:"get"}).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.projects=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},get_next:function(){var e=this;this.axios({url:this.next,method:"get"}).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.reports=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},open_edit:function(e){if("量产云平台"!=e.proname);else{var t={projectId:e.project,projectName:e.proname,allInfo:JSON.parse(e.allInfo)};this.$router.push({path:"/home/mpcloud",query:t})}},handleDelete:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/report/"+t.id+"/",method:"delete",params:e}).then(function(a){if(a.data.errcode)s.$message({message:"删除失败",type:"error",center:!0});else{var r=s.dateLogFormat(t.update_time);s.axios({baseURL:s.url,url:"api/v1/mpcloudExcel/?fileName="+r,method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):s.$message({message:"删除成功",type:"success",center:!0})},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),s.get_reports()}},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(e){})},get_projects:function(){var e=this,t={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/project/",method:"get",params:t}).then(function(t){if(t.data.errcode)e.$message({message:"加载失败",type:"error",center:!0});else{e.project_options=[];for(var s=0;s<t.data.results.length;s++){var a={value:t.data.results[s].id,label:t.data.results[s].proname};e.project_options.push(a)}e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0}},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},dateLogFormat:function(e){var t=new Date(e);return t.getFullYear()+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+(t.getDate()<10?"0"+t.getDate():t.getDate())+(t.getHours()<10?"0"+t.getHours():t.getHours())+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())+".xlsx"}},created:function(){this.get_reports(),this.get_projects()},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},dateLogFormat:function(e){var t=new Date(e);return"http://172.16.9.88:8081/reports/"+t.getFullYear()+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+(t.getDate()<10?"0"+t.getDate():t.getDate())+(t.getHours()<10?"0"+t.getHours():t.getHours())+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())+".xlsx"}}},te={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[this.$route.query.projectName?s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级"),s("br"),s("br")])]):e._e(),e._v(" "),s("div",[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.new_report()}}},[e._v("添加测试报告")]),e._v(" "),s("el-select",{attrs:{placeholder:"请选择项目"},model:{value:e.projectId,callback:function(t){e.projectId=t},expression:"projectId"}},e._l(e.project_options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),s("br")],1),s("br"),e._v(" "),s("div",[s("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"","empty-text":"暂无项目",data:e.reports.filter(function(t){return!e.search||t.proname.toLowerCase().includes(e.search.toLowerCase())}),"header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("h4",[e._v("测试软件版本信息：")]),e._v(" "),e._l(JSON.parse(t.row.version),function(t,a){return s("span",{key:a},[e._v("\n                        "+e._s(a)+"："+e._s(t)+"\n                            \n                            \n                    ")])}),e._v(" "),s("h4",[e._v("Release Note：")]),e._v(" "),s("pre",[e._v(e._s(t.row.releaseNote))]),e._v(" "),s("h4",[e._v("测试结果汇总：")]),e._v(" "),s("pre",[e._v(e._s(t.row.result))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center",prop:"proname",label:"项目"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",prop:"username",label:"创建人"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"创建时间",prop:"update_time",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center",width:"280"},scopedSlots:e._u([{key:"header",fn:function(t){return[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载报告",placement:"top"}},[s("a",{attrs:{href:e._f("dateLogFormat")(t.row.update_time)}},[s("el-button",{staticClass:"el-icon-download",attrs:{size:"mini",type:"primary"}})],1)]),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])})],1),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1)],1)])},staticRenderFns:[]},se=s("VU/8")(ee,te,!1,null,null,null).exports,ae=(s("2qnb"),s("7Yic"),{name:"Src",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),code:"",old_code:"",testBtn:"开始测试",loading:!1,body_style:{padding:"0px",background:"#eee"},options:{enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0,highlightActiveLine:!0,readOnly:!0}}},methods:{go_back:function(){var e=this;"提交修改*"==this.editBtnText?this.$confirm("脚本未保存，是否确定离开?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){e.$router.back(-1)}).catch(function(){}):this.$router.back(-1)},get_appTest:function(){var e=this;this.$confirm("1 请确认移动端是否开启开发者模式并连接测试PC </br>                 2 请确认是否已打开appium服务端 </br>                 3 测试大约需几分钟请耐心等待 </br>                 4 即将开始全部自定义测试","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...";var t={userId:e.userId,token:e.token,type:e.$route.query.type,id:e.$route.query.id};e.axios({baseURL:e.url,url:"api/v1/saveSrc/",method:"patch",params:t}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:"PASS",type:"success",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试"},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},get_appSrc:function(){var e=this,t={userId:this.userId,token:this.token,type:this.$route.query.type,id:this.$route.query.id};this.axios({baseURL:this.url,url:"api/v1/saveSrc/",method:"get",params:t}).then(function(t){e.code=t.data.src,e.old_code=t.data.src},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},edit_appsrc:function(){var e=this,t={userId:this.userId,token:this.token},s={type:this.$route.query.type,id:this.$route.query.id,src:this.code};this.axios({baseURL:this.url,url:"api/v1/saveSrc/",method:"post",params:t,data:s}).then(function(t){t.data.errcode?e.$message({message:"提交失败",type:"error",center:!0}):(e.$message({message:"提交成功",type:"success",center:!0}),e.old_code=e.code)},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}},components:{editor:O.a},computed:{editBtnText:function(){return this.code!=this.old_code?"提交修改*":"提交修改 "}},created:function(){this.get_appSrc(),this.$route.query.userid!=this.userId&&2!=this.userId||(this.options.readOnly=!1)}}),re={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级"),s("br"),s("br")]),e._v(" "),s("el-card",{staticClass:"box-card",attrs:{shadow:"hover","body-style":e.body_style}},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[this.$route.query.projectName?s("div",{staticStyle:{"font-size":"14px","margin-bottom":"0px",float:"left"}},[e._v("\n                    \n                项目："+e._s(this.$route.query.projectName)+"\n                    \n            ")]):e._e(),e._v(" "),"app"==this.$route.query.type?s("div",{staticStyle:{"font-size":"14px","margin-bottom":"0px",float:"left"}},[e._v("\n                app："+e._s(this.$route.query.appName)+"\n            ")]):e._e(),e._v(" "),"api"==this.$route.query.type?s("div",{staticStyle:{"font-size":"14px","margin-bottom":"0px",float:"left"}},[e._v("\n                后端："+e._s(this.$route.query.appName)+"\n            ")]):e._e(),e._v(" "),"web"==this.$route.query.type?s("div",{staticStyle:{"font-size":"14px",float:"left"}},[e._v("\n                前端："+e._s(this.$route.query.appName)+"\n            ")]):e._e(),e._v(" "),s("div",{staticStyle:{float:"right","margin-bottom":"10px","text-align":"center"}},[this.$route.query.userid==e.userId||2==e.userId?s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.edit_appsrc}},[e._v(e._s(e.editBtnText)+"\n                ")]):e._e(),e._v(" "),s("el-button",{attrs:{type:"primary",size:"mini",loading:e.loading},on:{click:e.get_appTest}},[e._v(e._s(e.testBtn)+"\n                ")])],1)]),e._v(" "),s("div",[s("editor",{attrs:{height:"800",options:e.options,lang:"python",theme:"crimson_editor"},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1)])],1)},staticRenderFns:[]},ie=s("VU/8")(ae,re,!1,null,null,null).exports;a.default.use(n.a);var ne=new n.a({routes:[{path:"/",redirect:"/login/"},{path:"/login/",name:"Login",component:c},{path:"/home/",component:d,children:[{path:"",redirect:"user"},{path:"user",component:m},{path:"project",component:_},{path:"webManager/:projectId?",component:x},{path:"apiManager/:projectId?",component:$},{path:"appManager",component:D},{path:"apiCase/:apiManagerId?",component:F},{path:"webCase/:webManagerId?",component:A},{path:"appCase/:appManagerId?",component:V},{path:"webType/",component:H},{path:"appType/",component:G},{path:"apiType/",component:Y},{path:"log/",component:X},{path:"report",component:se},{path:"src",component:ie}]}]}),oe=s("zL8q"),le=s.n(oe),ce=(s("tvR6"),s("mtWM")),pe=s.n(ce);s("CuRo"),s("7xIN");a.default.use(le.a),a.default.config.productionTip=!1,a.default.prototype.url="http://172.16.9.88/",a.default.prototype.axios=pe.a,a.default.prototype.storage=window.localStorage,a.default.prototype.path="",new a.default({el:"#app",router:ne,components:{App:i},template:"<App/>"})},NUfy:function(e,t){},OdAi:function(e,t){},adur:function(e,t){},asmU:function(e,t){},gmSH:function(e,t){},hdYT:function(e,t){},j77a:function(e,t){},pEdj:function(e,t){},tvR6:function(e,t){},ukAO:function(e,t){},"wZ+D":function(e,t){},"xzo/":function(e,t,s){e.exports=s.p+"static/img/login-img.ca4e6fe.png"}},["NHnr"]);
//# sourceMappingURL=app.aec80ea51f0f73f2de8c.js.map