webpackJsonp([1],{"0nhE":function(e,t){},"4hi3":function(e,t){},"6NAN":function(e,t){},"7xIN":function(e,t){},"992A":function(e,t){},"9X0j":function(e,t){},CuRo:function(e,t){},D80C:function(e,t){},GAJ5:function(e,t){},HxVy:function(e,t){},K67B:function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s("7+uW"),a={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var o=s("VU/8")({name:"App"},a,!1,function(e){s("HxVy")},null,null).exports,n=s("/ocq"),i={name:"Login",data:function(){return{url:this.url,imageUrl:"../assets/img/login-img.png",axios:this.axios,username:"",email:"",password:"",captcha:"",activeName:"",storage:this.storage,is_ok:!1,captcha_button:"获取验证码"}},methods:{login:function(e){var t=this;if("email"!=e||this.check_email(this.email)){if("username"==e){if(!this.username)return void this.$message({message:"用户名不能为空",type:"error",center:!0});if(!this.password)return void this.$message({message:"密码不能为空",type:"error",center:!0})}var s={type:e,username:this.username,password:this.password,email:this.email,captcha:this.captcha};this.axios({baseURL:this.url,url:"api/v1/login/",method:"post",data:s}).then(function(e){e.data.errcode?t.$message({message:e.data.errmsg,type:"error",center:!0}):(t.storage.setItem("userId",e.data.data.id),t.storage.setItem("token",e.data.token),t.$router.push({path:"/home/"}))},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}},get_captcha:function(){var e=this;if(this.check_email(this.email)){var t={email:this.email};this.captcha_button="发送中...",this.axios({baseURL:this.url,url:"api/v1/captcha/",method:"get",params:t}).then(function(t){if(t.data.errcode)e.$message({message:t.data.errmsg,type:"error",center:!0}),e.is_ok=!1;else{e.$message({message:"发送成功",type:"success",center:!0});var s=60;e.captcha_button=s+"s";var r=setInterval(function(){s<=1?(e.is_ok=!1,clearInterval(r),e.captcha_button="获取验证码"):(s--,e.captcha_button=s+"s")},1e3)}},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0}),e.is_ok=!1})}},check_email:function(e){return!!/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/.test(e)||(this.$message({message:"邮箱格式不对，请重新输入",type:"error",center:!0}),!1)}}},l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e._m(0),e._v(" "),s("el-tabs",{attrs:{type:"border-card",value:"first"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"用户名登陆"}},[s("el-input",{attrs:{placeholder:"请输入用户名",clearable:"",required:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),e._v(" "),s("el-input",{attrs:{placeholder:"请输入登陆密码","show-password":"",clearable:""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),e._v(" "),s("el-button",{attrs:{id:"login",type:"primary"},on:{click:function(t){return e.login("username")}}},[e._v("登陆")])],1),e._v(" "),s("el-tab-pane",{attrs:{label:"邮箱登陆",name:"second"}},[s("el-input",{attrs:{type:"email",placeholder:"请输入邮箱",clearable:""},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),e._v(" "),s("el-input",{attrs:{placeholder:"请输入验证码",clearable:""},model:{value:e.captcha,callback:function(t){e.captcha=t},expression:"captcha"}},[s("el-button",{staticStyle:{margin:"-10px 0"},attrs:{slot:"append",disabled:e.is_ok},on:{click:e.get_captcha},slot:"append"},[e._v(e._s(e.captcha_button))])],1),e._v(" "),s("el-button",{attrs:{id:"login",type:"primary"},on:{click:function(t){return e.login("email")}}},[e._v("登陆")])],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"login_img"}},[t("img",{attrs:{src:s("xzo/"),alt:""}})])}]};var c=s("VU/8")(i,l,!1,function(e){s("asmU")},"data-v-219f2d65",null).exports,u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("el-header",[s("el-menu",{attrs:{mode:"horizontal","default-active":e.$route.path,"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b",router:""}},[s("el-menu-item",{attrs:{index:"/home/user"}},[s("i",{staticClass:"el-icon-thirdshanghuhaopeizhi"}),e._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[e._v("用户中心")])]),e._v(" "),s("el-menu-item",{attrs:{index:"/home/project"}},[s("i",{staticClass:"el-icon-menu"}),e._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[e._v("项目中心")])]),e._v(" "),s("el-menu-item",{attrs:{index:"/home/report/"}},[s("i",{staticClass:"el-icon-document"}),e._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[e._v("测试报告")])]),e._v(" "),s("el-menu-item",{attrs:{index:"/home/log/"}},[s("i",{staticClass:"el-icon-document"}),e._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[e._v("测试LOG")])])],1)],1),e._v(" "),s("el-main",[s("router-view")],1)],1)},staticRenderFns:[]};var p=s("VU/8")({name:"Home"},u,!1,function(e){s("adur")},"data-v-6a6f1d10",null).exports,d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-collapse",{attrs:{accordion:""},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-collapse-item",{attrs:{title:"个人资料",name:"1"}},[s("p",[e._v("用户名："+e._s(e.username))]),e._v(" "),s("p",[e._v("邮箱    ："+e._s(e.email))])]),e._v(" "),s("el-collapse-item",{attrs:{title:"修改用户名",name:"2"}},[s("br"),e._v(" "),s("el-input",{attrs:{placeholder:"请输入用户名",clearable:""},model:{value:e.username_new,callback:function(t){e.username_new=t},expression:"username_new"}}),e._v(" "),s("br"),s("br"),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.update_username}},[e._v("确认")])],1),e._v(" "),s("el-collapse-item",{attrs:{title:"修改密码",name:"3"}},[s("br"),e._v(" "),s("el-input",{attrs:{placeholder:"请输入密码，确保两次输入一致","show-password":"",clearable:""},model:{value:e.password_1,callback:function(t){e.password_1=t},expression:"password_1"}},[s("template",{slot:"prepend"},[e._v("密码")])],2),e._v(" "),s("br"),s("br"),e._v(" "),s("el-input",{attrs:{placeholder:"请输入密码，确保两次输入一致","show-password":"",clearable:""},model:{value:e.password_2,callback:function(t){e.password_2=t},expression:"password_2"}},[s("template",{slot:"prepend"},[e._v("密码")])],2),e._v(" "),s("br"),s("br"),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.update_password}},[e._v("修改密码")])],1)],1),e._v(" "),s("br"),s("br"),e._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:e.logout}},[e._v("注销用户")])],1)},staticRenderFns:[]};var m=s("VU/8")({name:"User",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),username:"",username_new:"",email:"",password_1:"",password_2:"",activeName:"1"}},methods:{get_user:function(){var e=this,t={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"v1/user/"+this.userId+"/",method:"get",params:t}).then(function(t){e.username=t.data.data.username,e.email=t.data.data.email},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},update_username:function(){var e=this,t={userId:this.userId,token:this.token},s={username:this.username_new};this.axios({baseURL:this.url,url:"v1/user/"+this.userId+"/",method:"patch",params:t,data:s}).then(function(t){t.data.errcode?e.$message({message:"修改失败",type:"error",center:!0}):(e.$message({message:"修改成功",type:"success",center:!0}),e.username=e.username_new,e.username_new="")},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})},update_password:function(){var e=this;if(this.password_1&&this.password_1==this.password_2){var t={userId:this.userId,token:this.token},s={password:this.password_1};this.axios({baseURL:this.url,url:"v1/user/"+this.userId+"/",method:"patch",params:t,data:s}).then(function(t){t.data.errcode?e.$message({message:"修改失败",type:"error",center:!0}):e.$message({message:"修改成功",type:"success",center:!0})},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"两次密码不一致，请重新输入",type:"error",center:!0});this.password_1=this.password_2=""},logout:function(){this.storage.removeItem("userId"),this.storage.removeItem("token"),this.$router.push("/")}},beforeCreate:function(){},created:function(){this.get_user()}},d,!1,function(e){s("9X0j")},"data-v-4f7c8363",null).exports,h=s("NC6I"),b=s.n(h),f={name:"Project",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),testUserId:this.storage.getItem("testUserId"),testUserToken:this.storage.getItem("testUserToken"),adminUserId:this.storage.getItem("adminUserId"),adminUserToken:this.storage.getItem("adminUserToken"),adminUser:"",adminPsw:"",testUser:"",testPsw:"",testBtn:"开始测试",loading:!1,passText:"PASS",failText:"FAIL",proname:"",prodes:"",projects:[],search:"",pre:"",next:"",isNextDisabled:!1,isPreDisabled:!1,dialogFormVisible:!1,editObj:{id:"",proname:"",prodes:""}}},methods:{get_testUser:function(){var e=this,t="https://mpstest.longsys.com",s={email:this.adminUser,pswmd5:b()(this.adminPsw),timestamp:Date.parse(new Date)},r={email:this.testUser,pswmd5:b()(this.testPsw),timestamp:Date.parse(new Date)};this.axios({baseURL:t,url:"/api/v1/user/login",method:"post",data:s}).then(function(s){"0"==s.data.errcode?(e.storage.setItem("adminUserId",s.data.data.userid),e.storage.setItem("adminUserToken",s.data.data.token),e.adminUserId=s.data.data.userid,e.adminUserToken=s.data.data.token,e.axios({baseURL:t,url:"/api/v1/user/login",method:"post",data:r}).then(function(t){"0"==t.data.errcode?(e.storage.setItem("testUserId",t.data.data.userid),e.storage.setItem("testUserToken",t.data.data.token),e.testUserId=e.storage.getItem("testUserId"),e.testUserToken=e.storage.getItem("testUserToken")):(e.$message({message:"测试用户账户密码异常，请重新设置",type:"error",center:!0,showClose:!0,duration:0}),e.testUserFormVisible=!0)},function(t){e.$message({message:"服务器错误，请检查 "+e.baseurl+" 服务器是否正常",type:"error",center:!0,showClose:!0,duration:0})})):(e.$message({message:"管理员账户密码异常，请重新设置",type:"error",center:!0,showClose:!0,duration:0}),e.testUserFormVisible=!0)},function(t){e.$message({message:"服务器错误，请检查 "+e.baseurl+" 服务器是否正常",type:"error",center:!0,showClose:!0,duration:0})})},projectTest:function(e){var t=this;this.$confirm("项目测试需要等待时间较长, 是否开始测试?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$message({message:"测试开始",type:"success",center:!0,showClose:!0}),t.passText=t.failText='<p class="el-icon-loading"></p>';var s={userId:t.userId,token:t.token,projectId:e.id},r={};if("量产云平台"==e.proname)r={testUserInfo:{testUserId:t.testUserId,testUserToken:t.testUserToken,adminUserId:t.adminUserId,adminUserToken:t.adminUserToken}};t.axios({baseURL:t.url,url:"/api/v1/projectTest/",method:"post",params:s,data:r}).then(function(s){s.data.errcode?t.$message({message:s.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):t.$message({message:e.proname+" 测试 PASS",type:"success",center:!0,showClose:!0,duration:0}),t.passText="PASS",t.failText="FAIL",t.get_projects()},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),t.passText="PASS",t.failText="FAIL",t.testBtn="开始测试"})}).catch(function(){})},get_projects:function(){var e=this,t={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/project/",method:"get",params:t}).then(function(t){e.projects=t.data.results,e.pre=t.data.previous;for(var s=0,r=e.projects.length;s<r;s++)console.log(e.projects),"量产云平台"==e.projects[s].proname&&(e.adminUser=e.projects[s].adminUser,e.adminPsw=e.projects[s].adminPsw,e.testUser=e.projects[s].testUser,e.testPsw=e.projects[s].testPsw,e.get_testUser());e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},open_edit:function(e){this.dialogFormVisible=!0,this.editObj.id=e.id,this.editObj.proname=e.proname,this.editObj.prodes=e.prodes},handleEdit:function(e){var t=this;if(e.proname&&e.prodes){this.dialogFormVisible=!1;var s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/project/"+e.id+"/",method:"patch",params:s,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),t.get_projects())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"项目名称和描述不能为空",type:"error",center:!0})},handleDelete:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/project/"+t.id+"/",method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):s.$message({message:"删除成功",type:"success",center:!0}),s.get_projects()},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(e){})},new_product:function(){var e=this;if(this.proname&&this.prodes){var t={proname:this.proname,prodes:this.prodes,user:this.userId},s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/project/",method:"post",params:s,data:t}).then(function(t){t.data.errcode?e.$message({message:"新建失败",type:"error",center:!0}):(e.$message({message:"新建成功",type:"success",center:!0}),e.get_projects())},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.proname="",this.prodes=""}else this.$message({message:"项目名称和描述不能为空",type:"error",center:!0})},get_pre:function(){var e=this;this.axios({url:this.pre,method:"get"}).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.projects=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},get_next:function(){var e=this;this.axios({url:this.next,method:"get"}).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.projects=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},go_webTest:function(e){var t={projectId:e.id,projectName:e.proname};this.$router.push({path:"/home/webManager/",query:t})},go_apiTest:function(e){var t={projectId:e.id,projectName:e.proname,adminUser:e.adminUser,adminPsw:e.adminPsw,testUser:e.testUser,testPsw:e.testPsw};this.$router.push({path:"/home/apiManager/",query:t})},go_report:function(e){var t={projectName:e.proname};this.$router.push({path:"/home/report/",query:t})}},beforeCreate:function(){},created:function(){this.get_projects()},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}}},g={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{attrs:{id:"add_project"}},[s("el-button",{attrs:{type:"primary"},on:{click:e.new_product}},[e._v("新建项目")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"项目名称"},model:{value:e.proname,callback:function(t){e.proname=t},expression:"proname"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"项目描述"},model:{value:e.prodes,callback:function(t){e.prodes=t},expression:"prodes"}}),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{stripe:"",border:"",data:e.projects.filter(function(t){return!e.search||t.proname.toLowerCase().includes(e.search.toLowerCase())||t.prodes.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"项目名称",align:"center",prop:"proname",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{label:"项目描述",align:"center",prop:"prodes"}}),e._v(" "),s("el-table-column",{attrs:{label:"前端",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击加入前端测试",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.go_webTest(t.row)}}},[t.row.webresult?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"后端",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击加入后端测试",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.go_apiTest(t.row)}}},[t.row.apiresult?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"测试结果",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击开始项目测试(前端+后端)",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.projectTest(t.row)}}},[t.row.result?s("p",{staticStyle:{color:"green"},domProps:{innerHTML:e._s(e.passText)}}):s("p",{staticStyle:{color:"red"},domProps:{innerHTML:e._s(e.failText)}})])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center",prop:"update_time",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"测试报告",placement:"top"}},[s("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-document"},on:{click:function(s){return e.go_report(t.row)}}})],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])})],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"项目名称","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.proname,callback:function(t){e.$set(e.editObj,"proname",t)},expression:"editObj.proname"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"项目描述","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.prodes,callback:function(t){e.$set(e.editObj,"prodes",t)},expression:"editObj.prodes"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(e.editObj)}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var v=s("VU/8")(f,g,!1,function(e){s("4hi3")},"data-v-32b8a879",null).exports,_={name:"WebManager",data:function(){return{activeName:"",axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),testBtn:"开始测试",loading:!1,webname:"",webdes:"",weburl:"",search:"",webManagers:[],webAutoTests:[],project_options:[],pre:"",next:"",isNextDisabled:!1,isPreDisabled:!1,projectId:this.$route.query.projectId,dialogFormVisible:!1,editObj:{id:"",webname:"",webdes:"",weburl:""}}},methods:{go_back:function(){this.$router.back(-1)},selectAll:function(e,t){for(var s,r,a=t.options,o=0,n=a.length;o<n;o++)for(r in s=a[o])s[r]=e},apiManagerTest:function(){var e=this;this.$confirm("1 请确认是否已打开浏览器服务端 </br> 2 测试大约需几分钟请耐心等待 </br>3 即将开始全部自定义测试","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...";var t={userId:e.userId,token:e.token,projectId:e.projectId};e.axios({baseURL:e.url,url:"/api/v1/webManagerTest/",method:"get",params:t}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:"PASS",type:"success",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试",e.get_webManagers()},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.get_webManagers(),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},testMpcloudCase:function(e){var t=this;this.$confirm("1 请确认是否已打开浏览器服务端 </br>2 测试大约需几分钟请耐心等待 </br>3 即将开始 "+e.role+" 测试","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){t.$message({message:"测试开始",type:"success",center:!0}),t.loading=!0,t.testBtn="测试中...",t.axios({baseURL:t.url,url:"/api/v1/webAutoTest/",method:"patch",data:e}).then(function(e){e.data.errcode?t.$message({message:e.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):t.$message({message:e.data.errmsg,type:"success",center:!0,showClose:!0,duration:0}),t.loading=!1,t.testBtn="开始测试"},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),t.loading=!1,t.testBtn="开始测试"})}).catch(function(){})},testMpcloud:function(){var e=this;this.$confirm("1 请确认是否已打开浏览器服务端 </br> 2 测试大约需30分钟请耐心等待 </br>3 即将开始全部角色测试","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...",e.axios({baseURL:e.url,url:"/api/v1/webAutoTest/",method:"post",data:e.webAutoTests}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:"量产云平台测试 PASS",type:"success",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试"},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},get_webAutotest:function(){var e=this,t="api/v1/webAutoTest/";this.$route.query.projectName&&(t=t+"?project="+this.$route.query.projectName);var s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:t,method:"get",params:s}).then(function(t){e.webAutoTests=t.data},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0})})},get_webManagers:function(){var e=this,t="api/v1/webManager/";this.$route.query.projectId&&(t=t+"?project="+this.$route.query.projectId);var s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:t,method:"get",params:s}).then(function(t){e.webManagers=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},open_edit:function(e){this.dialogFormVisible=!0,this.editObj.id=e.id,this.editObj.webname=e.webname,this.editObj.webdes=e.webdes,this.editObj.weburl=e.weburl},handleEdit:function(e){var t=this;if(e.webname&&e.webdes&&e.weburl){this.dialogFormVisible=!1;var s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/webManager/"+e.id+"/",method:"patch",params:s,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),t.get_webManagers())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"名称、描述和URL不能为空",type:"error",center:!0})},handleDelete:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/webManager/"+t.id+"/",method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):(s.$message({message:"删除成功",type:"success",center:!0}),s.get_webManagers())},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(){})},new_webcase:function(){var e=this;if(this.webname&&this.webdes&&this.weburl){var t={webname:this.webname,webdes:this.webdes,weburl:this.weburl,user:this.userId,project:this.projectId},s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/webManager/",method:"post",params:s,data:t}).then(function(t){t.data.errcode?e.$message({message:"添加失败",type:"error",center:!0}):(e.$message({message:"添加成功",type:"success",center:!0}),e.get_webManagers())},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.webname="",this.webdes="",this.weburl=""}else this.$message({message:"名称、描述和URL不能为空",type:"error",center:!0})},get_pre:function(){var e=this;this.axios.get(this.pre).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0}):(e.webManagers=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0})})},get_next:function(){var e=this;this.axios.get(this.next).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0}):(e.webManagers=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0})})},go_webTest:function(e){var t={object_id:e.id,content_type:e.contenttype,weburl:e.weburl,projectName:e.proname,webName:e.webname};this.$router.push({path:"/home/webType/",query:t})},get_projects:function(){var e=this,t={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/project/",method:"get",params:t}).then(function(t){if(t.data.errcode)e.$message({message:"加载失败",type:"error",center:!0,showClose:!0});else{e.project_options=[];for(var s=0;s<t.data.results.length;s++){var r={value:t.data.results[s].id,label:t.data.results[s].proname};e.project_options.push(r)}e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0}},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})}},watch:{"$route.query.projectId":function(e){e||(this.get_projects(),this.get_webManagers())}},beforeCreate:function(){},created:function(){this.get_webManagers(),this.get_webAutotest(),this.$route.query.projectId||this.get_projects()},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}}},y={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[this.$route.query.projectId?s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级"),s("br"),s("br")]),e._v(" "),this.$route.query.projectName?s("span",{staticStyle:{"font-size":"17px"}},[e._v("\r\n            项目："+e._s(this.$route.query.projectName)+"\r\n        ")]):e._e(),s("br"),s("br")]):e._e(),e._v(" "),s("el-collapse",{attrs:{accordion:""},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-collapse-item",{staticStyle:{"font-size":"17px"},attrs:{title:"自动化测试",name:"1"}},[[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.webAutoTests}},[s("el-table-column",{attrs:{prop:"role",label:"角色",width:"180",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"测试项",align:"",width:"800"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-checkbox",{attrs:{checked:""},on:{change:function(s){return e.selectAll(s,t.row)}}},[e._v("全部")]),e._v(" "),e._l(t.row.options,function(t,r){return s("span",{key:r},e._l(t,function(r,a,o){return s("span",{key:o},[s("el-checkbox",{model:{value:t[a],callback:function(s){e.$set(t,a,s)},expression:"option[key]"}},[e._v(e._s(a))]),e._v("\r\n                              \r\n                        ")],1)}),0)})]}}])}),e._v(" "),"量产云平台"==this.$route.query.projectName?s("el-table-column",{attrs:{align:""},scopedSlots:e._u([{key:"header",fn:function(t){return[s("el-button",{attrs:{type:"primary",align:"center",loading:e.loading},on:{click:function(t){return e.testMpcloud()}}},[e._v(e._s(e.testBtn))])]}},{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(s){return e.testMpcloudCase(t.row)}}},[e._v(e._s(e.testBtn))])]}}],null,!1,2711676183)}):e._e()],1)]],2),e._v(" "),s("el-collapse-item",{staticStyle:{"font-size":"17px"},attrs:{title:"自定义测试",name:"2"}},[s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.new_webcase}},[e._v("添加测试")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.webname,callback:function(t){e.webname=t},expression:"webname"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入描述"},model:{value:e.webdes,callback:function(t){e.webdes=t},expression:"webdes"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入URL"},model:{value:e.weburl,callback:function(t){e.weburl=t},expression:"weburl"}}),e._v(" "),this.$route.query.projectId?e._e():s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.projectId,callback:function(t){e.projectId=t},expression:"projectId"}},e._l(e.project_options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),this.$route.query.projectId?s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",loading:e.loading},on:{click:e.apiManagerTest}},[e._v(e._s(e.testBtn))]):e._e(),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{stripe:"",border:"",data:e.webManagers.filter(function(t){return!e.search||t.webname.toLowerCase().includes(e.search.toLowerCase())||t.webdes.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击进入 "+t.row.webname+" 测试项",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.go_webTest(t.row)}}},[s("p",[e._v(e._s(t.row.webname))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"描述",align:"center",prop:"webdes"}}),e._v(" "),s("el-table-column",{attrs:{label:"URL",align:"center",prop:"weburl"}}),e._v(" "),s("el-table-column",{attrs:{label:"项目",align:"center",prop:"proname"}}),e._v(" "),s("el-table-column",{attrs:{label:"测试结果",align:"center",prop:"result"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.result?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center",prop:"update_time"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[s("el-input",{attrs:{size:"mini",placeholder:"输入名称关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])})],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"名称","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.webname,callback:function(t){e.$set(e.editObj,"webname",t)},expression:"editObj.webname"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"描述","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.webdes,callback:function(t){e.$set(e.editObj,"webdes",t)},expression:"editObj.webdes"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"URL","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.weburl,callback:function(t){e.$set(e.editObj,"weburl",t)},expression:"editObj.weburl"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(e.editObj)}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var w=s("VU/8")(_,y,!1,function(e){s("6NAN")},"data-v-44802712",null).exports,k={name:"ApiManager",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),testUserId:this.storage.getItem("testUserId"),testUserToken:this.storage.getItem("testUserToken"),adminUserId:this.storage.getItem("adminUserId"),adminUserToken:this.storage.getItem("adminUserToken"),baseurl:"",testBtn:"开始测试",loading:!1,adminUser:this.$route.query.adminUser,adminPsw:this.$route.query.adminPsw,testUser:this.$route.query.testUser,testPsw:this.$route.query.testPsw,apiname:"",apides:"",apiurl:"",search:"",apiManagers:[],project_options:[],pre:"",next:"",projectId:this.$route.query.projectId,projectName:this.$route.query.projectName,isNextDisabled:!1,isPreDisabled:!1,dialogFormVisible:!1,testUserFormVisible:!1,editObj:{id:"",apiname:"",apides:"",apiurl:""}}},methods:{go_back:function(){this.$router.back(-1)},get_testUser:function(){var e=this,t={email:this.adminUser,pswmd5:b()(this.adminPsw),timestamp:Date.parse(new Date)},s={email:this.testUser,pswmd5:b()(this.testPsw),timestamp:Date.parse(new Date)};this.axios({baseURL:this.baseurl,url:"/api/v1/user/login",method:"post",data:t}).then(function(t){"0"==t.data.errcode?(e.storage.setItem("adminUserId",t.data.data.userid),e.storage.setItem("adminUserToken",t.data.data.token),e.adminUserId=t.data.data.userid,e.adminUserToken=t.data.data.token,e.axios({baseURL:e.baseurl,url:"/api/v1/user/login",method:"post",data:s}).then(function(t){"0"==t.data.errcode?(e.storage.setItem("testUserId",t.data.data.userid),e.storage.setItem("testUserToken",t.data.data.token),e.testUserId=e.storage.getItem("testUserId"),e.testUserToken=e.storage.getItem("testUserToken")):(e.$message({message:"测试用户账户密码异常，请重新设置",type:"error",center:!0,showClose:!0,duration:0}),e.testUserFormVisible=!0)},function(t){e.$message({message:"服务器错误，请检查 "+e.baseurl+" 服务器是否正常",type:"error",center:!0,showClose:!0,duration:0})})):(e.$message({message:"管理员账户密码异常，请重新设置",type:"error",center:!0,showClose:!0,duration:0}),e.testUserFormVisible=!0)},function(t){e.$message({message:"服务器错误，请检查 "+e.baseurl+" 服务器是否正常",type:"error",center:!0,showClose:!0,duration:0})})},setTestUser:function(){var e=this,t={userId:this.userId,token:this.token},s={adminUser:this.adminUser,adminPsw:this.adminPsw,testUser:this.testUser,testPsw:this.testPsw};this.axios({baseURL:this.url,url:"api/v1/project/"+this.projectId+"/",method:"patch",params:t,data:s}).then(function(t){t.data.errcode?e.$message({message:"测试用户设置失败",type:"error",center:!0}):(e.$message({message:"测试用户设置成功",type:"success",center:!0}),e.testUserFormVisible=!1)},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})},add_testUser:function(){var e=this,t={email:this.adminUser,pswmd5:b()(this.adminPsw),timestamp:Date.parse(new Date)},s={email:this.testUser,pswmd5:b()(this.testPsw),timestamp:Date.parse(new Date)};this.axios({baseURL:this.baseurl,url:"/api/v1/user/login",method:"post",data:t}).then(function(t){"0"==t.data.errcode?(e.storage.setItem("adminUserId",t.data.data.userid),e.storage.setItem("adminUserToken",t.data.data.token),e.axios({baseURL:e.baseurl,url:"/api/v1/user/login",method:"post",data:s}).then(function(t){"0"==t.data.errcode?(e.storage.setItem("testUserId",t.data.data.userid),e.storage.setItem("testUserToken",t.data.data.token),e.setTestUser()):(e.$message({message:"测试用户账户密码异常，请重新设置",type:"error",center:!0}),e.testUserFormVisible=!0)},function(t){e.$message({message:"服务器错误，请检查 "+e.baseurl+" 服务器是否正常",type:"error",center:!0})})):(e.$message({message:"管理员账户密码异常，请重新设置",type:"error",center:!0}),e.testUserFormVisible=!0)},function(t){e.$message({message:"服务器错误，请检查 "+e.baseurl+" 服务器是否正常",type:"error",center:!0})})},apiManagerTest:function(){var e=this;this.$confirm("即将开始 "+this.$route.query.projectName+" 后端测试，请耐心等待","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...";var t={userId:e.userId,token:e.token,projectId:e.projectId},s={};if("量产云平台"==e.$route.query.projectName)s={testUserInfo:{testUserId:e.testUserId,testUserToken:e.testUserToken,adminUserId:e.adminUserId,adminUserToken:e.adminUserToken}};e.axios({baseURL:e.url,url:"/api/v1/apiManagerTest/",method:"post",params:t,data:s}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:e.$route.query.projectName+" 后端测试 PASS",type:"success",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试",e.get_apiManagers()},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.get_apiManagers(),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},get_apiManagers:function(){var e=this,t="api/v1/apiManager/";this.$route.query.projectId&&(t=t+"?project="+this.$route.query.projectId);var s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:t,method:"get",params:s}).then(function(t){if(e.apiManagers=t.data.results,e.baseurl=t.data.results[0].apiurl,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0,"量产云平台"==e.$route.query.projectName){if(!(e.$route.query.adminUser&&e.$route.query.adminPsw&&e.$route.query.testUser&&e.$route.query.testPsw))return e.testUserFormVisible=!0,void e.$message({message:"API测试用户不能为空",type:"error",center:!0,showClose:!0,duration:0});e.get_testUser()}},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},open_edit:function(e){this.dialogFormVisible=!0,this.editObj.id=e.id,this.editObj.apiname=e.apiname,this.editObj.apides=e.apides,this.editObj.apiurl=e.apiurl},handleEdit:function(e){var t=this;if(e.apiname&&e.apides&&e.apiurl){this.dialogFormVisible=!1;var s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/apiManager/"+e.id+"/",method:"patch",params:s,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),t.get_apiManagers())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"名称、描述、URL不能为空",type:"error",center:!0})},handleDelete:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/apiManager/"+t.id+"/",method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):(s.$message({message:"删除成功",type:"success",center:!0}),s.get_apiManagers())},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(){})},new_webcase:function(){var e=this;if(this.apiname&&this.apides&&this.apiurl){var t={apiname:this.apiname,apides:this.apides,apiurl:this.apiurl,user:this.userId,project:this.projectId},s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/apiManager/",method:"post",params:s,data:t}).then(function(t){t.data.errcode?e.$message({message:"新建失败",type:"error",center:!0}):(e.$message({message:"添加成功",type:"success",center:!0}),e.get_apiManagers())},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.apiname="",this.apides="",this.apiurl=""}else this.$message({message:"名称、描述、URL不能为空",type:"error",center:!0})},get_pre:function(){var e=this;this.axios.get(this.pre).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.apiManagers=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_next:function(){var e=this;this.axios.get(this.next).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.apiManagers=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},go_apiTest:function(e){var t={object_id:e.id,content_type:e.contenttype,apiurl:e.apiurl,projectName:e.proname,apiName:e.apiname};this.$router.push({path:"/home/ApiType/",query:t})},get_projects:function(){var e=this,t={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/project/",method:"get",params:t}).then(function(t){if(t.data.errcode)e.$message({message:"加载失败",type:"error",center:!0});else{e.project_options=[];for(var s=0;s<t.data.results.length;s++){var r={value:t.data.results[s].id,label:t.data.results[s].proname};e.project_options.push(r)}e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0}},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})}},watch:{"$route.query.projectId":function(e){e||(this.get_projects(),this.get_apiManagers())}},beforeCreate:function(){},created:function(){this.get_apiManagers(),this.$route.query.projectId||this.get_projects()},beforeMount:function(){},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}}},x={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[this.$route.query.projectId?s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级"),s("br"),s("br")]),e._v(" "),this.$route.query.projectName?s("span",{staticStyle:{"font-size":"17px"}},[e._v("\r\n            项目："+e._s(this.$route.query.projectName)+"\r\n        ")]):e._e(),s("br"),s("br")]):e._e(),e._v(" "),s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.new_webcase}},[e._v("添加模块")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.apiname,callback:function(t){e.apiname=t},expression:"apiname"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入描述"},model:{value:e.apides,callback:function(t){e.apides=t},expression:"apides"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入URL"},model:{value:e.apiurl,callback:function(t){e.apiurl=t},expression:"apiurl"}}),e._v(" "),this.$route.query.projectId?e._e():s("el-select",{attrs:{placeholder:"请选择项目"},model:{value:e.projectId,callback:function(t){e.projectId=t},expression:"projectId"}},e._l(e.project_options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"设置API测试用户账号",placement:"top-start"}},["量产云平台"==this.$route.query.projectName?s("el-button",{staticStyle:{float:"right","margin-left":"10px"},attrs:{icon:"el-icon-edit",type:"primary"},on:{click:function(t){e.testUserFormVisible=!0}}}):e._e()],1),e._v(" "),this.$route.query.projectId?s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",loading:e.loading},on:{click:e.apiManagerTest}},[e._v(e._s(e.testBtn))]):e._e(),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{stripe:"",border:"",data:e.apiManagers.filter(function(t){return!e.search||t.apiname.toLowerCase().includes(e.search.toLowerCase())||t.apides.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击进入 "+t.row.apiname+" 模块",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.go_apiTest(t.row)}}},[s("p",[e._v(e._s(t.row.apiname))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"描述",align:"center",prop:"apides"}}),e._v(" "),s("el-table-column",{attrs:{label:"URL",align:"center",prop:"apiurl"}}),e._v(" "),s("el-table-column",{attrs:{label:"项目",align:"center",prop:"proname"}}),e._v(" "),s("el-table-column",{attrs:{label:"测试结果",align:"center",prop:"result"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.result?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center",prop:"update_time"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[s("el-input",{attrs:{size:"mini",placeholder:"输入项目名称关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])})],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"名称","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.apiname,callback:function(t){e.$set(e.editObj,"apiname",t)},expression:"editObj.apiname"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"描述","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.apides,callback:function(t){e.$set(e.editObj,"apides",t)},expression:"editObj.apides"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"URL","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.apiurl,callback:function(t){e.$set(e.editObj,"apiurl",t)},expression:"editObj.apiurl"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(e.editObj)}}},[e._v("确 定")])],1)],1),e._v(" "),s("el-dialog",{attrs:{width:"500px",visible:e.testUserFormVisible},on:{"update:visible":function(t){e.testUserFormVisible=t}}},[s("div",{staticClass:"operator"},[e._v("管理员账户:")]),s("br"),e._v(" "),s("el-form",{attrs:{inline:""}},[s("el-form-item",[s("el-input",{attrs:{autocomplete:"off",placeholder:"请输入邮箱"},model:{value:e.adminUser,callback:function(t){e.adminUser=t},expression:"adminUser"}})],1),e._v(" "),s("el-form-item",[s("el-input",{attrs:{autocomplete:"off",placeholder:"请输入密码"},model:{value:e.adminPsw,callback:function(t){e.adminPsw=t},expression:"adminPsw"}})],1)],1),e._v(" "),s("div",{staticClass:"operator"},[e._v("测试账户:")]),s("br"),e._v(" "),s("el-form",{attrs:{inline:""}},[s("el-form-item",[s("el-input",{attrs:{autocomplete:"off",placeholder:"请输入邮箱"},model:{value:e.testUser,callback:function(t){e.testUser=t},expression:"testUser"}})],1),e._v(" "),s("el-form-item",[s("el-input",{attrs:{autocomplete:"off",placeholder:"请输入密码"},model:{value:e.testPsw,callback:function(t){e.testPsw=t},expression:"testPsw"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.testUserFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.add_testUser()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var I=s("VU/8")(k,x,!1,function(e){s("0nhE")},"data-v-3b6a8757",null).exports,$=s("pFYg"),S=s.n($),C=s("mvHQ"),j=s.n(C),T={name:"ApiCase",data:function(){return{projectName:this.$route.query.projectName,axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),testUserId:this.storage.getItem("testUserId"),testUserToken:this.storage.getItem("testUserToken"),adminUserId:this.storage.getItem("adminUserId"),adminUserToken:this.storage.getItem("adminUserToken"),testUser:"",testBtn:"开始测试",loading:!1,allTestBtn:"开始测试",allTestLoading:!1,apiname:"",apiurl:"",apiparams:{},apibody:{},search:"",apiCases:[],pre:"",next:"",error:{},editParam:"提交修改",editBody:"提交修改",editResponse:"提交修改",editAuth:"提交修改",testType:this.$route.query.testType,baseurl:this.$route.query.apiurl,isNextDisabled:!1,isPreDisabled:!1,dialogFormVisible:!1,editObj:{id:"",apiname:"",apimethod:"",apiurl:"",index:""},method_options:[{label:"get",value:"get"},{label:"post",value:"post"},{label:"patch",value:"patch"},{label:"delete",value:"delete"}],params:{},body:{},response:{}}},methods:{go_back:function(){this.$router.back(-1)},testUserLogin:function(){var e=this,t={email:"17388730192@163.com",pswmd5:"202cb962ac59075b964b07152d234b70",timestamp:Date.parse(new Date)};this.axios({baseURL:this.baseurl,url:"/api/v1/user/login",method:"post",data:t}).then(function(t){e.testUser=t.data,"0"==t.data.errcode?(e.testUserId=t.data.data.userid,e.testToken=t.data.data.token):e.$message({message:"测试用户登陆 FAIL-errcode 不一致",type:"error",center:!0,showClose:!0,duration:0})},function(t){e.$message({message:"测试用户登陆 FAIL-服务器错误，请检查 "+e.baseurl+" 服务器是否正常",type:"error",center:!0,showClose:!0,duration:0})})},adminLogin:function(){var e=this,t={email:"linzhifu221@163.com",pswmd5:"c313b271b06b2b50ad9a3e93e8744029",timestamp:Date.parse(new Date)};this.axios({baseURL:this.baseurl,url:"/api/v1/user/login",method:"post",data:t}).then(function(t){e.testUser=t.data,"0"==t.data.errcode?(e.adminUserId=t.data.data.userid,e.adminUserToken=t.data.data.token):e.$message({message:"管理员登陆 FAIL-errocde 不一致",type:"error",center:!0,showClose:!0,duration:0})},function(t){e.$message({message:"管理员登陆 FAIL-服务器错误，请检查 "+e.baseurl+" 服务器是否正常",type:"error",center:!0,showClose:!0,duration:0})})},deleteAdmin:function(e){var t=this,s={userid:this.adminUserId,token:this.adminUserToken},r={roleid:1,userid:Number(this.testUserId)};this.axios({baseURL:this.baseurl,url:"/api/v1/role/user",method:"delete",params:s,data:r}).then(function(s){return 0==s.data.errcode?void 0:void t.$message({message:e.apiname+" 删除管理员权限失败-errcode不一致",type:"error",center:!0,showClose:!0,duration:0})}).catch(function(s){t.$message({message:e.apiname+" 删除管理员权限失败-服务器错误，请检查 "+t.baseurl+" 服务器是否正常",type:"error",center:!0,showClose:!0,duration:0})})},deleteAuth:function(e){var t=this;if(""!=e.operatorType&&""!=e.operatorId&&""!=e.objectType&&""!=e.objectId&&""!=e.actions){var s={userid:this.adminUserId,token:this.adminUserToken},r={operator:{type:e.operatorType,id:Number(e.objectId)},object:{type:e.objectType,id:Number(e.objectId)},actions:e.actions.split(",")};this.axios({baseURL:this.baseurl,url:"/api/v1/role/permission",method:"delete",params:s,data:r}).then(function(s){return 0==s.data.errcode?void 0:void t.$message({message:e.apiname+" 删除权限失败-errcode不一致",type:"error",center:!0,showClose:!0,duration:0})}).catch(function(s){t.$message({message:e.apiname+" 删除权限失败-服务器错误，请检查 "+t.baseurl+" 服务器是否正常",type:"error",center:!0,showClose:!0,duration:0})})}else this.$message({message:"请确保必填项都已填写",type:"warning"})},apiTest:function(e){var t=this;if(this.isJsonString(this.body[e.id]))if(this.isJsonString(this.response[e.id]))if(this.loading=!0,this.testBtn="测试中...",e.isAdmin){var s={userid:this.adminUserId,token:this.adminUserToken},r={roleid:1,userid:Number(this.testUserId)};this.axios({baseURL:this.baseurl,url:"/api/v1/role/user",method:"post",params:s,data:r}).then(function(s){if(0!=s.data.errcode)return t.$message({message:e.apiname+" 授予管理员权限失败",type:"error",center:!0}),t.loading=!1,void(t.testBtn="开始测试");var r={};for(var a in t.params[e.id])""!=t.params[e.id][a][0]&&""!=t.params[e.id][a][1]&&(r[t.params[e.id][a][0]]=t.params[e.id][a][1]);var o=r,n={"Content-Type":e.contentType},i=JSON.parse(t.body[e.id]);s=JSON.parse(t.response[e.id]);i.hasOwnProperty("timestamp")&&(i.timestamp=Date.parse(new Date)),t.axios({baseURL:t.baseurl,url:e.apiurl,method:e.apimethod,params:o,data:i,headers:n}).then(function(r){if(e.testdata=r.data,r.data.errcode==s.errcode){if("data"in s)for(var a in s.data)if(s.data[a]!=r.data.data[a])return t.$message({message:e.apiname+" data不一致",type:"error",center:!0}),t.deleteAdmin(e),t.loading=!1,void(t.testBtn="开始测试");return"errmsg"in s&&s.errmsg!=r.data.errmsg?(t.$message({message:e.apiname+" errmsg不一致",type:"error",center:!0}),t.deleteAdmin(e),t.loading=!1,void(t.testBtn="开始测试")):(t.$message({message:e.apiname+" 测试 PASS",type:"success",center:!0}),t.deleteAdmin(e),t.loading=!1,void(t.testBtn="开始测试"))}return t.$message({message:e.apiname+" errcode不一致",type:"error",center:!0}),t.deleteAdmin(e),t.loading=!1,void(t.testBtn="开始测试")},function(s){console.log(s.response.data),e.testdata=s.response.data,t.$message({message:e.apiname+" 测试失败-服务器错误，请检查 "+t.baseurl+" 服务器是否正常",type:"error",center:!0}),t.deleteAdmin(e),t.loading=!1,t.testBtn="开始测试"})},function(s){t.$message({message:e.apiname+" 授予管理员权限失败-服务器错误，请检查 "+t.baseurl+" 服务器是否正常",type:"error",center:!0}),t.loading=!1,t.testBtn="开始测试"})}else if(e.isAuth){if(""==e.operatorType||""==e.operatorId||""==e.objectType||""==e.objectId||""==e.actions)return this.$message({message:"请确保必填项都已填写",type:"warning"}),this.loading=!1,void(this.testBtn="开始测试");var a={userid:this.adminUserId,token:this.adminUserToken},o={operator:{type:e.operatorType,id:Number(e.operatorId)},object:{type:e.objectType,id:Number(e.objectId)},actions:e.actions.split(",")};this.axios({baseURL:this.baseurl,url:"/api/v1/role/permission",method:"post",params:a,data:o}).then(function(s){if(0!=s.data.errcode)return t.$message({message:e.apiname+" 授予权限失败",type:"error",center:!0}),t.loading=!1,void(t.testBtn="开始测试");var r={};for(var a in t.params[e.id])""!=t.params[e.id][a][0]&&""!=t.params[e.id][a][1]&&(r[t.params[e.id][a][0]]=t.params[e.id][a][1]);var o=r;o.hasOwnProperty("userid")&&o.hasOwnProperty("token")&&(o.userid=t.testUserId,o.token=t.testUserToken);var n={"Content-Type":e.contentType},i=JSON.parse(t.body[e.id]);s=JSON.parse(t.response[e.id]);i.hasOwnProperty("timestamp")&&(i.timestamp=Date.parse(new Date)),t.axios({baseURL:t.baseurl,url:e.apiurl,method:e.apimethod,params:o,data:i,headers:n}).then(function(r){if(e.testdata=r.data,r.data.errcode==s.errcode){if("data"in s)for(var a in s.data)if(s.data[a]!=r.data.data[a])return t.$message({message:e.apiname+" data不一致",type:"error",center:!0}),t.deleteAuth(e),t.loading=!1,void(t.testBtn="开始测试");return"errmsg"in s&&s.errmsg!=r.data.errmsg?(t.$message({message:e.apiname+" errmsg不一致",type:"error",center:!0}),t.deleteAuth(e),t.loading=!1,void(t.testBtn="开始测试")):(t.$message({message:e.apiname+" 测试 PASS",type:"success",center:!0}),t.deleteAuth(e),t.loading=!1,void(t.testBtn="开始测试"))}return t.$message({message:e.apiname+" errcode不一致",type:"error",center:!0}),t.deleteAuth(e),t.loading=!1,void(t.testBtn="开始测试")},function(s){console.log(s.response.data),e.testdata=s.response.data,t.$message({message:"请检查 "+t.baseurl+" 服务器是否正常",type:"error",center:!0}),t.deleteAuth(e),t.loading=!1,t.testBtn="开始测试"})},function(s){t.$message({message:e.apiname+" 授予权限失败-服务器错误，请检查 "+t.baseurl+" 服务器是否正常",type:"error",center:!0}),t.loading=!1,t.testBtn="开始测试"})}else{var n={};for(var i in this.params[e.id])""!=this.params[e.id][i][0]&&""!=this.params[e.id][i][1]&&(n[this.params[e.id][i][0]]=this.params[e.id][i][1]);var l=n,c={"Content-Type":e.contentType},u=JSON.parse(this.body[e.id]),p=JSON.parse(this.response[e.id]);u.hasOwnProperty("timestamp")&&(u.timestamp=Date.parse(new Date)),this.axios({baseURL:this.baseurl,url:e.apiurl,method:e.apimethod,params:l,data:u,headers:c}).then(function(s){if(e.testdata=s.data,s.data.errcode==p.errcode){if("data"in p)for(var r in p.data)if(p.data[r]!=s.data.data[r])return t.$message({message:e.apiname+" data不一致",type:"error",center:!0}),t.loading=!1,void(t.testBtn="开始测试");return"errmsg"in p&&p.errmsg!=s.data.errmsg?(t.$message({message:e.apiname+" errmsg不一致",type:"error",center:!0}),t.loading=!1,void(t.testBtn="开始测试")):(t.$message({message:e.apiname+" 测试 PASS",type:"success",center:!0}),t.loading=!1,void(t.testBtn="开始测试"))}return t.$message({message:e.apiname+" errcode不一致",type:"error",center:!0}),t.loading=!1,void(t.testBtn="开始测试")},function(s){console.log(s.response.data),e.testdata=s.response.data,t.$message({message:"请检查 "+t.baseurl+" 服务器是否正常",type:"error",center:!0}),t.loading=!1,t.testBtn="开始测试"})}else this.$message.error("response数据不符合json格式");else this.$message.error("body数据不符合json格式")},apiCaseTest:function(){var e=this;this.$confirm("即将开始 "+this.$route.query.apiCase+" api测试，请耐心等待","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.allTestLoading=!0,e.allTestBtn="测试中...";var t={userId:e.userId,token:e.token,testType:e.testType,url:e.baseurl},s={};if("量产云平台"==e.$route.query.projectName)s={testUserInfo:{testUserId:e.testUserId,testUserToken:e.testUserToken,adminUserId:e.adminUserId,adminUserToken:e.adminUserToken}};e.axios({baseURL:e.url,url:"/api/v1/apiCaseTest/",method:"post",params:t,data:s}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:e.$route.query.apiCase+" 测试 PASS",type:"success",center:!0,showClose:!0,duration:0}),e.allTestLoading=!1,e.allTestBtn="开始测试",e.get_apiCases()},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.allTestLoading=!1,e.allTestBtn="开始测试"})}).catch(function(){})},addParam:function(e){e.push(["",""]),this.editParam="提交修改*"},removeParam:function(e,t){var s=this;this.$confirm("提交修改后将永久删除, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){s.$delete(s.params[t],e.$index),s.editParam="提交修改*"}).catch(function(){})},edit_param:function(e,t,s){var r={};r.id=e;var a={};for(var o in s)""!=s[o][0]&&""!=s[o][1]&&(a[s[o][0]]=s[o][1]);r[t]=j()(a),this.handleEdit(r,!1),this.editParam="提交修改"},body_change:function(e){this.editBody="提交修改*",this.isJsonString(e)||this.$message({message:"body数据不符合json格式",type:"warning"})},edit_body:function(e,t,s){var r={};r.id=e.id,this.isJsonString(s)?(r[t]=s,r.contentType=e.contentType,this.handleEdit(r,!1),this.editBody="提交修改"):this.$message.error("body数据不符合json格式")},response_change:function(e){this.editResponse="提交修改*",this.isJsonString(e)||this.$message({message:"response数据不符合json格式",type:"warning"})},edit_response:function(e,t,s){var r={};r.id=e,this.isJsonString(s)?(r[t]=s,this.handleEdit(r,!1),this.editResponse="提交修改"):this.$message.error("response数据不符合json格式")},auth_change:function(e){this.editAuth="提交修改*"},edit_auth:function(e){var t={};t.id=e.id,t.isAdmin=e.isAdmin,t.isAuth=e.isAuth,t.operatorType=e.operatorType,t.operatorId=e.operatorId,t.objectType=e.objectType,t.objectId=e.objectId,t.actions=e.actions,this.handleEdit(t,!1),this.editAuth="提交修改"},get_apiCases:function(){var e,t,s=this,r=[],a={userId:this.userId,token:this.token,testType:this.testType};this.axios({baseURL:this.url,url:"api/v1/apiCase/",method:"get",params:a}).then(function(a){s.apiCases=a.data.results;for(var o=0;o<a.data.results.length;o++){if(a.data.results[o].apiparam){var n=JSON.parse(a.data.results[o].apiparam);for(var i in n)r.push([i,n[i]])}else r=[];t=a.data.results[o].apijson?JSON.parse(a.data.results[o].apijson):{},e=a.data.results[o].apiresponse?JSON.parse(a.data.results[o].apiresponse):{},s.$set(s.params,a.data.results[o].id,r),s.$set(s.body,a.data.results[o].id,j()(t,null,4)),s.$set(s.response,a.data.results[o].id,j()(e,null,4))}s.pre=a.data.previous,s.pre?s.isPreDisabled=!1:s.isPreDisabled=!0,s.next=a.data.next,s.next?s.isNextDisabled=!1:s.isNextDisabled=!0},function(e){s.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),s.$router.push("/")})},open_edit:function(e){this.dialogFormVisible=!0,this.editObj.id=e.id,this.editObj.apiname=e.apiname,this.editObj.apimethod=e.apimethod,this.editObj.apiurl=e.apiurl,this.editObj.index=e.index},handleEdit:function(e){var t=this,s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!s||e.apiname&&e.apiurl&&e.apimethod){this.dialogFormVisible=!1;var r={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/apiCase/"+e.id+"/",method:"patch",params:r,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),s&&t.get_apiCases())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"名称、URL和请求方法不能为空",type:"error",center:!0})},handleDelete:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/apiCase/"+t.id+"/",method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):(s.$message({message:"删除成功",type:"success",center:!0}),s.get_apiCases())},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(){})},new_apicase:function(){var e=this;if(this.apiname&&this.apiurl&&this.editObj.apimethod){var t={apiname:this.apiname,apiurl:this.apiurl,apimethod:this.editObj.apimethod,testType:this.testType,user:this.userId},s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/apiCase/",method:"post",params:s,data:t}).then(function(t){t.data.errcode?e.$message({message:"新建失败",type:"error",center:!0}):(e.$message({message:"添加成功",type:"success",center:!0}),e.get_apiCases())},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.apiname="",this.apiurl="",this.editObj.apimethod=""}else this.$message({message:"名称、URL和请求方法不能为空",type:"error",center:!0})},get_pre:function(){var e=this;this.axios.get(this.pre).then(function(t){if(t.data.errcode)e.$message({message:"加载失败",type:"error",center:!0,showClose:!0});else{e.$message({}),e.apiCases=t.data.results;for(var s=0;s<t.data.results.length;s++)t.data.results[s].apiparam?params=JSON.parse(t.data.results[s].apiparam):params={},t.data.results[s].apijson?body=JSON.parse(t.data.results[s].apijson):body={},t.data.results[s].apiresponse?response_obj=JSON.parse(t.data.results[s].apiresponse):response_obj={},e.$set(e.params,t.data.results[s].id,params),e.$set(e.body,t.data.results[s].id,body),e.$set(e.response,t.data.results[s].id,response_obj);e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0}},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_next:function(){var e=this;this.axios.get(this.next).then(function(t){if(t.data.errcode)e.$message({message:"加载失败",type:"error",center:!0,showClose:!0});else{e.$message({}),e.apiCases=t.data.results;for(var s=0;s<t.data.results.length;s++)t.data.results[s].apiparam?params=JSON.parse(t.data.results[s].apiparam):params={},t.data.results[s].apijson?body=JSON.parse(t.data.results[s].apijson):body={},t.data.results[s].apiresponse?response_obj=JSON.parse(t.data.results[s].apiresponse):response_obj={},e.$set(e.params,t.data.results[s].id,params),e.$set(e.body,t.data.results[s].id,body),e.$set(e.response,t.data.results[s].id,response_obj);e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0}},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0})})},isJsonString:function(e){try{if("object"==S()(JSON.parse(e)))return!0}catch(e){}return!1}},beforeCreate:function(){},created:function(){this.get_apiCases(),this.$route.query.projectName},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}}},N={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级")]),s("br"),s("br"),e._v(" "),s("div",{staticStyle:{"font-size":"17px","margin-bottom":"10px"}},[e._v("\r\n            测试案例："+e._s(this.$route.query.projectName)+" - "+e._s(this.$route.query.apiName)+" - "+e._s(this.$route.query.apiCase)+"\r\n    ")]),e._v(" "),"量产云平台"==this.$route.query.projectName?s("div",{staticStyle:{"font-size":"17px","margin-bottom":"10px"}},[e._v("\r\n            管理员ID："+e._s(e.adminUserId)+"\r\n    ")]):e._e(),e._v(" "),"量产云平台"==this.$route.query.projectName?s("div",{staticStyle:{"font-size":"17px"}},[e._v("\r\n            测试用户ID："+e._s(e.testUserId)+"\r\n    ")]):e._e(),e._v(" "),s("br"),e._v(" "),s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.new_apicase}},[e._v("添加API")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.apiname,callback:function(t){e.apiname=t},expression:"apiname"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入URL"},model:{value:e.apiurl,callback:function(t){e.apiurl=t},expression:"apiurl"}}),e._v(" "),s("el-select",{attrs:{placeholder:"请求方法"},model:{value:e.editObj.apimethod,callback:function(t){e.$set(e.editObj,"apimethod",t)},expression:"editObj.apimethod"}},e._l(e.method_options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",loading:e.allTestLoading},on:{click:e.apiCaseTest}},[e._v(e._s(e.allTestBtn))]),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{border:"",stripe:"",data:e.apiCases.filter(function(t){return!e.search||t.apiname.toLowerCase().includes(e.search.toLowerCase())||t.apiurl.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","default-sort":{prop:"index",order:"ascending"},"header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tabs",{attrs:{type:"border-card"}},[s("el-tab-pane",{attrs:{label:"Params"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.params[t.row.id],"header-cell-style":{background:"#F2F6FC"}}},[s("el-table-column",{attrs:{label:"KEY"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{model:{value:t.row[0],callback:function(s){e.$set(t.row,0,s)},expression:"scope.row[0]"}})]}}],null,!0)}),e._v(" "),s("el-table-column",{attrs:{label:"VALUE"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{model:{value:t.row[1],callback:function(s){e.$set(t.row,1,s)},expression:"scope.row[1]"}})]}}],null,!0)}),e._v(" "),s("el-table-column",{attrs:{width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(r){return[s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return s.preventDefault(),e.removeParam(r,t.row.id)}}})]}}],null,!0)})],1),e._v(" "),s("br"),e._v(" "),s("el-button",{staticClass:"el-icon-plus",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.addParam(e.params[t.row.id])}}},[e._v("添加Param\r\n                        ")]),e._v(" "),t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.edit_param(t.row.id,"apiparam",e.params[t.row.id])}}},[e._v(e._s(e.editParam)+"\r\n                        ")]):e._e()],1),e._v(" "),s("el-tab-pane",{attrs:{label:"Body"}},[s("el-select",{staticStyle:{width:"300px"},model:{value:t.row.contentType,callback:function(s){e.$set(t.row,"contentType",s)},expression:"scope.row.contentType"}},e._l(["application/x-www-form-urlencoded","application/json"],function(e){return s("el-option",{key:e,attrs:{value:e}})}),1),s("br"),s("br"),e._v(" "),s("el-input",{attrs:{type:"textarea",autosize:""},on:{change:function(s){return e.body_change(e.body[t.row.id])}},model:{value:e.body[t.row.id],callback:function(s){e.$set(e.body,t.row.id,s)},expression:"body[scope.row.id]"}}),s("br"),s("br"),e._v(" "),t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.edit_body(t.row,"apijson",e.body[t.row.id])}}},[e._v(e._s(e.editBody)+"\r\n                        ")]):e._e()],1),e._v(" "),s("el-tab-pane",{attrs:{label:"Response"}},[s("el-input",{attrs:{type:"textarea",autosize:""},on:{change:function(s){return e.response_change(e.response[t.row.id])}},model:{value:e.response[t.row.id],callback:function(s){e.$set(e.response,t.row.id,s)},expression:"response[scope.row.id]"}}),s("br"),s("br"),e._v(" "),t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.edit_response(t.row.id,"apiresponse",e.response[t.row.id])}}},[e._v(e._s(e.editResponse)+"\r\n                        ")]):e._e()],1),e._v(" "),"量产云平台"==e.projectName?s("el-tab-pane",{attrs:{label:"权限管理"}},[s("el-checkbox",{on:{change:function(s){t.row.isAuth=!t.row.isAdmin,e.auth_change()}},model:{value:t.row.isAdmin,callback:function(s){e.$set(t.row,"isAdmin",s)},expression:"scope.row.isAdmin"}},[e._v("管理员")]),e._v(" "),s("el-checkbox",{on:{change:function(s){t.row.isAdmin=!t.row.isAuth,e.auth_change()}},model:{value:t.row.isAuth,callback:function(s){e.$set(t.row,"isAuth",s)},expression:"scope.row.isAuth"}},[e._v("授权")]),e._v(" "),s("br"),s("br"),e._v(" "),s("div",[e._v("操作者信息：")]),s("br"),e._v(" "),s("el-form",{attrs:{inline:""}},[s("el-form-item",[s("el-select",{staticClass:"select-type",attrs:{clearable:"",placeholder:"请选择type(必填)",disabled:!t.row.isAuth},on:{change:function(t){return e.auth_change()}},model:{value:t.row.operatorType,callback:function(s){e.$set(t.row,"operatorType",s)},expression:"scope.row.operatorType"}},e._l(["user","role","team"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),s("el-form-item",[s("el-input",{staticClass:"input-item",attrs:{placeholder:"请输入id(必填)",clearable:"",disabled:!t.row.isAuth},on:{change:function(t){return e.auth_change()}},model:{value:t.row.operatorId,callback:function(s){e.$set(t.row,"operatorId",s)},expression:"scope.row.operatorId"}})],1)],1),e._v(" "),s("div",{staticClass:"operator"},[e._v("资源信息：")]),s("br"),e._v(" "),s("el-form",{attrs:{inline:""}},[s("el-form-item",[s("el-input",{staticClass:"select-type",attrs:{placeholder:"请输入type(必填)",clearable:"",disabled:!t.row.isAuth},on:{change:function(t){return e.auth_change()}},model:{value:t.row.objectType,callback:function(s){e.$set(t.row,"objectType",s)},expression:"scope.row.objectType"}})],1),e._v(" "),s("el-form-item",[s("el-input",{staticClass:"input-item",attrs:{placeholder:"请输入id(必填)",clearable:"",disabled:!t.row.isAuth},on:{change:function(t){return e.auth_change()}},model:{value:t.row.objectId,callback:function(s){e.$set(t.row,"objectId",s)},expression:"scope.row.objectId"}})],1)],1),e._v(" "),s("div",{staticClass:"operator"},[e._v("操作信息：")]),s("br"),e._v(" "),s("el-form",{attrs:{inline:""}},[s("el-form-item",[s("el-input",{staticClass:"select-type",attrs:{placeholder:"请输入内容(必填)",clearable:"",disabled:!t.row.isAuth},on:{change:function(t){return e.auth_change()}},model:{value:t.row.actions,callback:function(s){e.$set(t.row,"actions",s)},expression:"scope.row.actions"}})],1)],1),e._v(" "),t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.edit_auth(t.row)}}},[e._v(e._s(e.editAuth)+"\r\n                        ")]):e._e()],1):e._e(),e._v(" "),s("el-tab-pane",{attrs:{label:"测试数据"}},[s("el-button",{attrs:{size:"mini",type:"primary",loading:e.loading},on:{click:function(s){return s.preventDefault(),e.apiTest(t.row)}}},[e._v(e._s(e.testBtn)+"\r\n                        ")]),e._v(" "),s("br"),e._v(" "),s("pre",{staticStyle:{"font-size":"14px"},domProps:{textContent:e._s(t.row.testdata)}})],1)],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"",align:"center",prop:"index",width:"50px",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{label:"名称",align:"center",prop:"apiname"}}),e._v(" "),s("el-table-column",{attrs:{label:"请求方法",align:"center",prop:"apimethod"}}),e._v(" "),s("el-table-column",{attrs:{label:"URL",align:"center",prop:"apiurl"}}),e._v(" "),s("el-table-column",{attrs:{label:"测试结果",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.result?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])},[s("template",{slot:"header"},[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"名称","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.apiname,callback:function(t){e.$set(e.editObj,"apiname",t)},expression:"editObj.apiname"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"请求方法","label-width":"120px"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editObj.apimethod,callback:function(t){e.$set(e.editObj,"apimethod",t)},expression:"editObj.apimethod"}},e._l(e.method_options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"URL","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.apiurl,callback:function(t){e.$set(e.editObj,"apiurl",t)},expression:"editObj.apiurl"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"Index","label-width":"120px"}},[s("el-input-number",{attrs:{"controls-position":"right"},model:{value:e.editObj.index,callback:function(t){e.$set(e.editObj,"index",t)},expression:"editObj.index"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(e.editObj)}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var P=s("VU/8")(T,N,!1,function(e){s("992A")},"data-v-f5251b9e",null).exports,U={name:"WebCase",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),testBtn:"开始测试",loading:!1,webname:"",search:"",webCases:[],checkWebCases:[],pre:"",next:"",checkPre:"",checkNext:"",testType:this.$route.query.testType,weburl:this.$route.query.weburl,isNextDisabled:!1,isPreDisabled:!1,isCheckNextDisabled:!1,isCheckPreDisabled:!1,dialogFormVisible:!1,editObj:{id:"",webname:"",webcss:"",weboprate:"",webparam:"",index:"",type:"",checktext:""},activeName:""}},methods:{go_back:function(){this.$router.back(-1)},webTest:function(){var e=this;this.$confirm("1 请确认是否已打开浏览器服务端 </br>2 测试大约需几分钟请耐心等待 </br>3 即将开始 "+this.$route.query.webCase+" 测试","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...";var t={userId:e.userId,token:e.token,testType:e.testType,url:e.weburl};e.axios({baseURL:e.url,url:"/api/v1/webCaseTest/",method:"get",params:t}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:"PASS",type:"success",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试"},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},get_webCases:function(){var e=this,t={userId:this.userId,token:this.token,testType:this.testType};this.axios({baseURL:this.url,url:"api/v1/webCase/",method:"get",params:t}).then(function(t){e.webCases=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},get_checkWebCases:function(){var e=this,t={userId:this.userId,token:this.token,testType:this.testType};this.axios({baseURL:this.url,url:"api/v1/checkWebCase/",method:"get",params:t}).then(function(t){e.checkWebCases=t.data.results,e.checkPre=t.data.previous,e.checkPre?e.isCheckPreDisabled=!1:e.isCheckPreDisabled=!0,e.checkNext=t.data.next,e.checkNext?e.isCheckNextDisabled=!1:e.isCheckNextDisabled=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},open_edit:function(e,t){this.dialogFormVisible=!0,this.editObj.id=e.id,this.editObj.webname=e.webname,this.editObj.webcss=e.webcss,this.editObj.weboprate=e.weboprate,this.editObj.webparam=e.webparam,this.editObj.index=e.index,this.editObj.type=t,"check"==t&&(this.editObj.checktext=e.checktext)},handleEdit:function(e){var t=this;if(e.webname||"check"==e.type)if(e.webname||"check"!=e.type){this.dialogFormVisible=!1;var s={userId:this.userId,token:this.token},r="api/v1/webCase/"+e.id+"/";"check"==e.type&&(r="api/v1/checkWebCase/"+e.id+"/"),this.axios({baseURL:this.url,url:r,method:"patch",params:s,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),t.get_webCases(),t.get_checkWebCases())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"验证名称不能为空",type:"error",center:!0});else this.$message({message:"步骤名称不能为空",type:"error",center:!0})},handleDelete:function(e,t,s){var r=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:r.userId,token:r.token},a="api/v1/webCase/"+t.id+"/";"check"==s&&(a="api/v1/checkWebCase/"+t.id+"/"),r.axios({baseURL:r.url,url:a,method:"delete",params:e}).then(function(e){e.data.errcode?r.$message({message:"删除失败",type:"error",center:!0}):(r.$message({message:"删除成功",type:"success",center:!0}),r.get_webCases(),r.get_checkWebCases())},function(e){r.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})})},new_webcase:function(e){var t=this;if(this.webname||"check"==e)if(this.webname||"check"!=e){var s={webname:this.webname,testType:this.testType,user:this.userId},r="api/v1/webCase/";"check"==e&&(r="api/v1/checkWebCase/");var a={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:r,method:"post",params:a,data:s}).then(function(e){e.data.errcode?t.$message({message:"新建失败",type:"error",center:!0}):(t.$message({message:"添加成功",type:"success",center:!0}),t.get_webCases(),t.get_checkWebCases())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.webname=""}else this.$message({message:"验证名称不能为空",type:"error",center:!0});else this.$message({message:"步骤名称不能为空",type:"error",center:!0})},get_pre:function(){var e=this;this.axios.get(this.pre).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.webCases=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_checkPre:function(){var e=this;this.axios.get(this.checkPre).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.checkWebCases=t.data.results,e.checkPre=t.data.previous,e.checkPre?e.isCheckPreDisabled=!1:e.isCheckPreDisabled=!0,e.checkNext=t.data.next,e.checkNext?e.isCheckNextDisabled=!1:e.isCheckNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_next:function(){var e=this;this.axios.get(this.next).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0}):(e.webCases=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0})})},get_checkNext:function(){var e=this;this.axios.get(this.checkNext).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0}):(e.checkWebCases=t.data.results,e.checkPre=t.data.previous,e.checkPre?e.isCheckPreDisabled=!1:e.isCheckPreDisabled=!0,e.checkNext=t.data.next,e.checkNext?e.isCheckNextDisabled=!1:e.isCheckNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0})})}},beforeCreate:function(){},created:function(){this.get_webCases(),this.get_checkWebCases()},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}}},D={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级")]),s("br"),s("br"),e._v(" "),s("div",{staticStyle:{"font-size":"17px","margin-bottom":"10px"}},[e._v("\r\n            项目："+e._s(this.$route.query.projectName)+"\r\n    ")]),e._v(" "),s("div",{staticStyle:{"font-size":"17px","margin-bottom":"10px"}},[e._v("\r\n            测试："+e._s(this.$route.query.webName)+"\r\n    ")]),e._v(" "),s("div",{staticStyle:{"font-size":"17px"}},[e._v("\r\n            案例："+e._s(this.$route.query.webCase)+"\r\n    ")]),s("br"),e._v(" "),s("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.webTest()}}},[e._v(e._s(e.testBtn))]),e._v(" "),s("br"),s("br"),e._v(" "),s("el-collapse",{attrs:{accordion:""},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-collapse-item",{attrs:{title:"操作步骤",name:"1"}},[s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.new_webcase}},[e._v("添加步骤")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.webname,callback:function(t){e.webname=t},expression:"webname"}}),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{border:"",stripe:"",data:e.webCases.filter(function(t){return!e.search||t.webname.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","default-sort":{prop:"index",order:"ascending"},"header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"",align:"center",prop:"index",width:"50px",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{label:"步骤",align:"center",prop:"webname"}}),e._v(" "),s("el-table-column",{attrs:{label:"CSS选择器",align:"center",prop:"webcss"}}),e._v(" "),s("el-table-column",{attrs:{label:"元素操作",align:"center",prop:"weboprate"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作参数",align:"center",prop:"webparam"}}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])})],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"操作验证",name:"2"}},[s("div",[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.new_webcase("check")}}},[e._v("添加验证")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.webname,callback:function(t){e.webname=t},expression:"webname"}}),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{border:"",stripe:"",data:e.checkWebCases.filter(function(t){return!e.search||t.webname.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","default-sort":{prop:"index",order:"ascending"},"header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"",align:"center",prop:"index",width:"50px",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{label:"验证",align:"center",prop:"webname"}}),e._v(" "),s("el-table-column",{attrs:{label:"CSS选择器",align:"center",prop:"webcss"}}),e._v(" "),s("el-table-column",{attrs:{label:"元素操作",align:"center",prop:"weboprate"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作参数",align:"center",prop:"webparam"}}),e._v(" "),s("el-table-column",{attrs:{label:"验证数据",align:"center",prop:"checktext"}}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row,"check")}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row,"check")}}}):e._e()],1)]}}])})],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isCheckPreDisabled},on:{click:e.get_checkPre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isCheckNextDisabled},on:{click:e.get_checkNext}},[e._v("下一页")])],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"步骤","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.webname,callback:function(t){e.$set(e.editObj,"webname",t)},expression:"editObj.webname"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"Css选择器","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.webcss,callback:function(t){e.$set(e.editObj,"webcss",t)},expression:"editObj.webcss"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"元素操作","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.weboprate,callback:function(t){e.$set(e.editObj,"weboprate",t)},expression:"editObj.weboprate"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"操作参数","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.webparam,callback:function(t){e.$set(e.editObj,"webparam",t)},expression:"editObj.webparam"}})],1)],1),e._v(" "),e.editObj.type?s("el-form",[s("el-form-item",{attrs:{label:"验证数据","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.checktext,callback:function(t){e.$set(e.editObj,"checktext",t)},expression:"editObj.checktext"}})],1)],1):e._e(),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"Index","label-width":"120px"}},[s("el-input-number",{attrs:{"controls-position":"right"},model:{value:e.editObj.index,callback:function(t){e.$set(e.editObj,"index",t)},expression:"editObj.index"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(e.editObj)}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var R=s("VU/8")(U,D,!1,function(e){s("tMnE")},"data-v-520fa342",null).exports,A={name:"WebType",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),testBtn:"开始测试",loading:!1,typename:"",typedes:"",search:"",testtypes:[],pre:"",next:"",isNextDisabled:!1,isPreDisabled:!1,content_type:this.$route.query.content_type,object_id:this.$route.query.object_id,weburl:this.$route.query.weburl,dialogFormVisible:!1,editObj:{id:"",index:"",typename:"",typedes:"",is_test:""}}},methods:{go_back:function(){this.$router.back(-1)},webTest:function(){var e=this;this.$confirm("1 请确认是否已打开浏览器服务端 </br>2 测试大约需几分钟请耐心等待 </br>3 即将开始 "+this.$route.query.webName+" 测试","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...";var t={userId:e.userId,token:e.token,object_id:e.object_id,content_type:e.content_type,url:e.weburl};e.axios({baseURL:e.url,url:"/api/v1/webTypeTest/",method:"get",params:t}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:"PASS",type:"success",center:!0,showClose:!0,duration:0}),e.get_testtypes(),e.loading=!1,e.testBtn="开始测试",e.get_testtypes()},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.get_testtypes(),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},get_testtypes:function(){var e=this,t={userId:this.userId,token:this.token,object_id:this.object_id,content_type:this.content_type};this.axios({baseURL:this.url,url:"api/v1/testType/",method:"get",params:t}).then(function(t){e.testtypes=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},open_edit:function(e){this.dialogFormVisible=!0,this.editObj.id=e.id,this.editObj.index=e.index,this.editObj.typename=e.typename,this.editObj.typedes=e.typedes,this.editObj.is_test=e.is_test},handleEdit:function(e){var t=this;if(e.typename&&e.typedes){this.dialogFormVisible=!1;var s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/testType/"+e.id+"/",method:"patch",params:s,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),t.get_testtypes())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"名称、描述不能为空",type:"error",center:!0})},handleDelete:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/testType/"+t.id+"/",method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):(s.$message({message:"删除成功",type:"success",center:!0}),s.get_testtypes())},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(){})},new_webcase:function(){var e=this;if(this.typename&&this.typedes){var t={typename:this.typename,typedes:this.typedes,object_id:this.object_id,content_type:this.content_type,user:this.userId},s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/testType/",method:"post",params:s,data:t}).then(function(t){t.data.errcode?e.$message({message:"添加失败",type:"error",center:!0}):(e.$message({message:"添加成功",type:"success",center:!0}),e.get_testtypes())},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.typename="",this.typedes=""}else this.$message({message:"名称、描述不能为空",type:"error",center:!0})},get_pre:function(){var e=this;this.axios.get(this.pre).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.testtypes=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_next:function(){var e=this;this.axios.get(this.next).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.testtypes=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},go_webTest:function(e){var t={testType:e.id,weburl:this.weburl,projectName:this.$route.query.projectName,webName:this.$route.query.webName,webCase:e.typename};this.$router.push({path:"/home/webCase/",query:t})}},beforeCreate:function(){},created:function(){this.get_testtypes()},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}}},L={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级"),s("br"),s("br")]),e._v(" "),s("div",{staticStyle:{"font-size":"17px","margin-bottom":"10px"}},[e._v("\r\n            项目："+e._s(this.$route.query.projectName)+"\r\n    ")]),e._v(" "),s("div",{staticStyle:{"font-size":"17px"}},[e._v("\r\n            测试："+e._s(this.$route.query.webName)+"\r\n    ")]),s("br"),e._v(" "),s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.new_webcase}},[e._v("添加分类")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.typename,callback:function(t){e.typename=t},expression:"typename"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入描述"},model:{value:e.typedes,callback:function(t){e.typedes=t},expression:"typedes"}}),e._v(" "),s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",loading:e.loading},on:{click:e.webTest}},[e._v(e._s(e.testBtn))]),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{stripe:"",border:"",data:e.testtypes.filter(function(t){return!e.search||t.typename.toLowerCase().includes(e.search.toLowerCase())||t.typedes.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","header-cell-style":{background:"#ddd"},"default-sort":{prop:"index",order:"ascending"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"",align:"center",prop:"is_test",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("input",{attrs:{type:"checkbox",disabled:""},domProps:{checked:e.row.is_test}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"",align:"center",prop:"index",width:"50px",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{label:"名称",align:"center",prop:"typename"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击查看 "+t.row.typename+" 操作详情",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.go_webTest(t.row)}}},[s("p",[e._v(e._s(t.row.typename))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"描述",align:"center",prop:"typedes"}}),e._v(" "),s("el-table-column",{attrs:{label:"测试",align:"center",prop:"result"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.result?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center",prop:"update_time"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[s("el-input",{attrs:{size:"mini",placeholder:"输入名称关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])})],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"名称","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.typename,callback:function(t){e.$set(e.editObj,"typename",t)},expression:"editObj.typename"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"描述","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.typedes,callback:function(t){e.$set(e.editObj,"typedes",t)},expression:"editObj.typedes"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"优先级","label-width":"120px"}},[s("el-input-number",{attrs:{"controls-position":"right"},model:{value:e.editObj.index,callback:function(t){e.$set(e.editObj,"index",t)},expression:"editObj.index"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"是否测试","label-width":"120px"}},[s("el-checkbox",{model:{value:e.editObj.is_test,callback:function(t){e.$set(e.editObj,"is_test",t)},expression:"editObj.is_test"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(e.editObj)}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var M=s("VU/8")(A,L,!1,function(e){s("D80C")},"data-v-8d15e78c",null).exports,F={name:"ApiType",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),testUserId:this.storage.getItem("testUserId"),testUserToken:this.storage.getItem("testUserToken"),adminUserId:this.storage.getItem("adminUserId"),adminUserToken:this.storage.getItem("adminUserToken"),testBtn:"开始测试",loading:!1,typename:"",typedes:"",search:"",testtypes:[],pre:"",next:"",isNextDisabled:!1,isPreDisabled:!1,content_type:this.$route.query.content_type,object_id:this.$route.query.object_id,apiurl:this.$route.query.apiurl,dialogFormVisible:!1,editObj:{id:"",index:"",typename:"",typedes:"",is_test:""}}},methods:{go_back:function(){this.$router.back(-1)},apiTest:function(){var e=this;this.$confirm("即将开始 "+this.$route.query.apiName+" 模块测试，请耐心等待","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$message({message:"测试开始",type:"success",center:!0}),e.loading=!0,e.testBtn="测试中...";var t={userId:e.userId,token:e.token,object_id:e.object_id,content_type:e.content_type,url:e.apiurl},s={};if("量产云平台"==e.$route.query.projectName)s={testUserInfo:{testUserId:e.testUserId,testUserToken:e.testUserToken,adminUserId:e.adminUserId,adminUserToken:e.adminUserToken}};e.axios({baseURL:e.url,url:"/api/v1/apiTypeTest/",method:"post",params:t,data:s}).then(function(t){t.data.errcode?e.$message({message:t.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}):e.$message({message:e.$route.query.apiName+" 模块测试 PASS",type:"success",center:!0,showClose:!0,duration:0}),e.loading=!1,e.testBtn="开始测试",e.get_testtypes()},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),e.get_testtypes(),e.loading=!1,e.testBtn="开始测试"})}).catch(function(){})},get_testtypes:function(){var e=this,t={userId:this.userId,token:this.token,object_id:this.object_id,content_type:this.content_type};this.axios({baseURL:this.url,url:"api/v1/testType/",method:"get",params:t}).then(function(t){e.testtypes=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},open_edit:function(e){this.dialogFormVisible=!0,this.editObj.id=e.id,this.editObj.index=e.index,this.editObj.typename=e.typename,this.editObj.typedes=e.typedes,this.editObj.is_test=e.is_test},handleEdit:function(e){var t=this;if(e.typename&&e.typedes){this.dialogFormVisible=!1;var s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/testType/"+e.id+"/",method:"patch",params:s,data:e}).then(function(e){e.data.errcode?t.$message({message:"修改失败",type:"error",center:!0}):(t.$message({message:"修改成功",type:"success",center:!0}),t.get_testtypes())},function(e){t.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"名称和描述不能为空",type:"error",center:!0})},handleDelete:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/testType/"+t.id+"/",method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):(s.$message({message:"删除成功",type:"success",center:!0}),s.get_testtypes())},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(){})},new_webcase:function(){var e=this;if(this.typename&&this.typedes){var t={typename:this.typename,typedes:this.typedes,object_id:this.object_id,content_type:this.content_type,user:this.userId},s={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/testType/",method:"post",params:s,data:t}).then(function(t){t.data.errcode?e.$message({message:"添加失败",type:"error",center:!0}):(e.$message({message:"添加成功",type:"success",center:!0}),e.get_testtypes())},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),this.typename="",this.typedes=""}else this.$message({message:"名称和描述不能为空",type:"error",center:!0})},get_pre:function(){var e=this;this.axios.get(this.pre).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.testtypes=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},get_next:function(){var e=this;this.axios.get(this.next).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.testtypes=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:t.response.data,type:"error",center:!0,showClose:!0})})},go_apiTest:function(e){var t={testType:e.id,apiurl:this.apiurl,projectName:this.$route.query.projectName,apiName:this.$route.query.apiName,apiCase:e.typename};this.$router.push({path:"/home/apiCase/",query:t})}},beforeCreate:function(){},created:function(){this.get_testtypes()},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}}},O={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级"),s("br"),s("br")]),e._v(" "),s("div",{staticStyle:{"font-size":"17px","margin-bottom":"10px"}},[e._v("\r\n            项目："+e._s(this.$route.query.projectName)+"\r\n    ")]),e._v(" "),s("div",{staticStyle:{"font-size":"17px"}},[e._v("\r\n            测试："+e._s(this.$route.query.apiName)+"\r\n    ")]),s("br"),e._v(" "),s("div",[s("el-button",{attrs:{type:"primary"},on:{click:e.new_webcase}},[e._v("添加分类")]),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入名称"},model:{value:e.typename,callback:function(t){e.typename=t},expression:"typename"}}),e._v(" "),s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入描述"},model:{value:e.typedes,callback:function(t){e.typedes=t},expression:"typedes"}}),e._v(" "),s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",loading:e.loading},on:{click:e.apiTest}},[e._v(e._s(e.testBtn))]),e._v(" "),s("br"),s("br")],1),e._v(" "),s("el-table",{attrs:{stripe:"",border:"",data:e.testtypes.filter(function(t){return!e.search||t.typename.toLowerCase().includes(e.search.toLowerCase())||t.typedes.toLowerCase().includes(e.search.toLowerCase())}),"empty-text":"暂无项目","header-cell-style":{background:"#ddd"},"default-sort":{prop:"index",order:"ascending"},"highlight-current-row":""}},[s("el-table-column",{attrs:{label:"",align:"center",prop:"is_test",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("input",{attrs:{type:"checkbox",disabled:""},domProps:{checked:e.row.is_test}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"",align:"center",prop:"index",width:"50px",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{label:"名称",align:"center",prop:"typename"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"点击查看 "+t.row.typename+" 接口",placement:"top"}},[s("a",{attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.go_apiTest(t.row)}}},[s("p",[e._v(e._s(t.row.typename))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"描述",align:"center",prop:"typedes"}}),e._v(" "),s("el-table-column",{attrs:{label:"测试",align:"center",prop:"result"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.result?s("p",{staticStyle:{color:"green"}},[e._v("PASS")]):s("p",{staticStyle:{color:"red"}},[e._v("FAIL")])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"最近修改",align:"center",prop:"update_time"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[s("el-input",{attrs:{size:"mini",placeholder:"输入名称关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[t.row.user!=e.userId&&2!=e.userId?s("span",[e._v("暂无权限操作")]):e._e(),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])})],1),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"名称","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.typename,callback:function(t){e.$set(e.editObj,"typename",t)},expression:"editObj.typename"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"描述","label-width":"120px"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.editObj.typedes,callback:function(t){e.$set(e.editObj,"typedes",t)},expression:"editObj.typedes"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"优先级","label-width":"120px"}},[s("el-input-number",{attrs:{"controls-position":"right"},model:{value:e.editObj.index,callback:function(t){e.$set(e.editObj,"index",t)},expression:"editObj.index"}})],1)],1),e._v(" "),s("el-form",[s("el-form-item",{attrs:{label:"是否测试","label-width":"120px"}},[s("el-checkbox",{model:{value:e.editObj.is_test,callback:function(t){e.$set(e.editObj,"is_test",t)},expression:"editObj.is_test"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(e.editObj)}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var B=s("VU/8")(F,O,!1,function(e){s("X8Ss")},"data-v-f2653a32",null).exports;window.onresize=function(){document.getElementById("myiframe").height=document.documentElement.clientHeight};var q={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("iframe",{attrs:{id:"myiframe",src:"http://172.16.9.88:8081",height:"720px",width:"100%",scrolling:"no",frameborder:"0"}})])}]};var V=s("VU/8")({name:"Log",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token")}}},q,!1,function(e){s("K67B")},"data-v-196d835a",null).exports,z={name:"Report",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),reports:[],project_options:[],projectId:"",search:this.$route.query.projectName,pre:"",next:"",isNextDisabled:!1,isPreDisabled:!1}},methods:{go_back:function(){this.$router.back(-1)},get_reports:function(){var e=this,t={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/report/",method:"get",params:t}).then(function(t){e.reports=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},new_report:function(){if(this.projectId){for(var e=0;e<this.project_options.length;e++)if(console.log(this.project_options[e]),this.project_options[e].value==this.projectId&&"量产云平台"==this.project_options[e].label){var t={projectId:this.projectId,projectName:this.project_options[e].label};return void this.$router.push({path:"/home/mpcloud",query:t})}}else this.$message({message:"请选择项目",type:"error",center:!0})},get_pre:function(){var e=this;this.axios({url:this.pre,method:"get"}).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.projects=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},get_next:function(){var e=this;this.axios({url:this.next,method:"get"}).then(function(t){t.data.errcode?e.$message({message:"加载失败",type:"error",center:!0,showClose:!0}):(e.reports=t.data.results,e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0)},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},open_edit:function(e){if("量产云平台"!=e.proname);else{var t={projectId:e.project,projectName:e.proname,allInfo:JSON.parse(e.allInfo)};this.$router.push({path:"/home/mpcloud",query:t})}},handleDelete:function(e,t){var s=this;this.$confirm("此操作将永久删除该项, 是否继续?","提示",{distinguishCancelAndClose:!0,type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var e={userId:s.userId,token:s.token};s.axios({baseURL:s.url,url:"api/v1/report/"+t.id+"/",method:"delete",params:e}).then(function(r){if(r.data.errcode)s.$message({message:"删除失败",type:"error",center:!0});else{var a=s.dateLogFormat(t.update_time);s.axios({baseURL:s.url,url:"api/v1/mpcloudExcel/?fileName="+a,method:"delete",params:e}).then(function(e){e.data.errcode?s.$message({message:"删除失败",type:"error",center:!0}):s.$message({message:"删除成功",type:"success",center:!0})},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})}),s.get_reports()}},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}).catch(function(e){})},get_projects:function(){var e=this,t={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/project/",method:"get",params:t}).then(function(t){if(t.data.errcode)e.$message({message:"加载失败",type:"error",center:!0});else{e.project_options=[];for(var s=0;s<t.data.results.length;s++){var r={value:t.data.results[s].id,label:t.data.results[s].proname};e.project_options.push(r)}e.pre=t.data.previous,e.pre?e.isPreDisabled=!1:e.isPreDisabled=!0,e.next=t.data.next,e.next?e.isNextDisabled=!1:e.isNextDisabled=!0}},function(t){e.$message({message:"匿名用户，请先登录",type:"error",center:!0,showClose:!0}),e.$router.push("/")})},dateLogFormat:function(e){var t=new Date(e);return t.getFullYear()+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+(t.getDate()<10?"0"+t.getDate():t.getDate())+(t.getHours()<10?"0"+t.getHours():t.getHours())+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())+".xlsx"}},created:function(){this.get_reports(),this.get_projects()},filters:{dateFormat:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},dateLogFormat:function(e){var t=new Date(e);return"http://172.16.9.88:8081/reports/"+t.getFullYear()+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+(t.getDate()<10?"0"+t.getDate():t.getDate())+(t.getHours()<10?"0"+t.getHours():t.getHours())+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())+".xlsx"}}},H={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[this.$route.query.projectName?s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级"),s("br"),s("br")])]):e._e(),e._v(" "),s("div",[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.new_report()}}},[e._v("添加测试报告")]),e._v(" "),s("el-select",{attrs:{placeholder:"请选择项目"},model:{value:e.projectId,callback:function(t){e.projectId=t},expression:"projectId"}},e._l(e.project_options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),s("br")],1),s("br"),e._v(" "),s("div",[s("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"","empty-text":"暂无项目",data:e.reports.filter(function(t){return!e.search||t.proname.toLowerCase().includes(e.search.toLowerCase())}),"header-cell-style":{background:"#ddd"},"highlight-current-row":""}},[s("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("h4",[e._v("测试软件版本信息：")]),e._v(" "),e._l(JSON.parse(t.row.version),function(t,r){return s("span",{key:r},[e._v("\n                        "+e._s(r)+"："+e._s(t)+"\n                            \n                            \n                    ")])}),e._v(" "),s("h4",[e._v("Release Note：")]),e._v(" "),s("pre",[e._v(e._s(t.row.releaseNote))]),e._v(" "),s("h4",[e._v("测试结果汇总：")]),e._v(" "),s("pre",[e._v(e._s(t.row.result))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center",prop:"proname",label:"项目"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",prop:"username",label:"创建人"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"创建时间",prop:"update_time",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e._f("dateFormat")(t.row.update_time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center",width:"280"},scopedSlots:e._u([{key:"header",fn:function(t){return[s("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑修改",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{staticClass:"el-icon-edit",attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.open_edit(t.row)}}}):e._e()],1),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载报告",placement:"top"}},[s("a",{attrs:{href:e._f("dateLogFormat")(t.row.update_time)}},[s("el-button",{staticClass:"el-icon-download",attrs:{size:"mini",type:"primary"}})],1)]),e._v(" "),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[t.row.user==e.userId||2==e.userId?s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.handleDelete(t.$index,t.row)}}}):e._e()],1)]}}])})],1),s("br"),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",disabled:e.isPreDisabled},on:{click:e.get_pre}},[e._v("上一页")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.isNextDisabled},on:{click:e.get_next}},[e._v("下一页")])],1)],1)])},staticRenderFns:[]},E=s("VU/8")(z,H,!1,null,null,null).exports,J={name:"Mpcloud",data:function(){return{axios:this.axios,url:this.url,userId:this.storage.getItem("userId"),token:this.storage.getItem("token"),projectId:this.$route.query.projectId,projectName:this.$route.query.projectName,mpcloudReport:{version:{"量产云平台":"","电流板":"",MPTool:"","离线Key授权工具":"",syncAgent:"",transferStation:""},releaseNote:"",product_pm:[{testInfo:"个人资料",step:["登陆账户","修改个人资料和密码后退出登陆","用新的密码登陆","核对修改好的个人资料","测试5次"],result:"NT",note:""},{testInfo:"我的群组",step:["登陆账户","添加一个新的群组","修改群名称和描述","删除本人并添加同一群组的所有成员","核对群组成员显示是否正确","删除新建群组","测试次数为5次"],result:"NT",note:""},{testInfo:"添加项目",step:["登陆账户","添加新的项目","添加后前往添加项目角色和成员","测试次数5次"],result:"NT",note:""},{testInfo:"产品列表",step:["登陆账户","修改产品名称和描述","查询核对产品列表","添加新的项目，并修改名称和描述","添加项目角色和成员","核对产品角色和成员","删除新建项目","测试次数5次"],result:"NT",note:""},{testInfo:"订单列表",step:["登陆账户","查询订单","核对订单列表","关联量产工具","测试次数5次"],result:"NT",note:""}],model_pm:[{testInfo:"个人资料",step:["登陆账户","修改个人资料和密码后退出登陆","用新的密码登陆","核对修改好的个人资料","测试5次"],result:"NT",note:""},{testInfo:"我的群组",step:["登陆账户","添加一个新的群组","修改群名称和描述","删除本人并添加同一群组的所有成员","核对群组成员显示是否正确","删除新建群组","测试次数为5次"],result:"NT",note:""},{testInfo:"产品列表",step:["登陆账户","查询产品列表并核对","查询项目列表并核对","添加项目角色和成员","核对产品角色和成员","测试次数5次"],result:"NT",note:""},{testInfo:"订单列表",step:["登陆账户","查询订单","核对订单列表","关联量产工具","测试次数5次"],result:"NT",note:""}],product_rd:[{testInfo:"个人资料",step:["登陆账户","修改个人资料和密码后退出登陆","用新的密码登陆","核对修改好的个人资料","测试5次"],result:"NT",note:""},{testInfo:"我的群组",step:["登陆账户","添加一个新的群组","修改群名称和描述","删除本人并添加同一群组的所有成员","核对群组成员显示是否正确","删除新建群组","测试次数为5次"],result:"NT",note:""},{testInfo:"产品列表",step:["登陆账户","查询产品列表并核对","查询项目列表并核对","核对产品角色和成员","测试次数5次"],result:"NT",note:""},{testInfo:"订单列表",step:["登陆账户","查询订单","核对订单列表","下载测试软件","测试次数5次"],result:"NT",note:""},{testInfo:"添加样品",step:["登陆账户","添加样品和样品记录","测试次数5次"],result:"NT",note:""}],model_rd:[{testInfo:"个人资料",step:["登陆账户","修改个人资料和密码后退出登陆","用新的密码登陆","核对修改好的个人资料","测试5次"],result:"NT",note:""},{testInfo:"我的群组",step:["登陆账户","添加一个新的群组","修改群名称和描述","删除本人并添加同一群组的所有成员","核对群组成员显示是否正确","删除新建群组","测试次数为5次"],result:"NT",note:""},{testInfo:"产品列表",step:["登陆账户","查询产品列表并核对","查询项目列表并核对","核对产品角色和成员","测试次数5次"],result:"NT",note:""},{testInfo:"订单列表",step:["登陆账户","查询订单","核对订单列表","下载测试软件","测试次数5次"],result:"NT",note:""},{testInfo:"添加样品",step:["登陆账户","添加样品和样品记录","测试次数5次"],result:"NT",note:""}],product_te:[{testInfo:"个人资料",step:["登陆账户","修改个人资料和密码后退出登陆","用新的密码登陆","核对修改好的个人资料","测试5次"],result:"NT",note:""},{testInfo:"我的群组",step:["登陆账户","添加一个新的群组","修改群名称和描述","删除本人并添加同一群组的所有成员","核对群组成员显示是否正确","删除新建群组","测试次数为5次"],result:"NT",note:""},{testInfo:"产品列表",step:["登陆账户","查询产品列表并核对","查询项目列表并核对","核对产品角色和成员","测试次数5次"],result:"NT",note:""},{testInfo:"订单列表",step:["登陆账户","查询订单","核对订单列表","下载测试软件","测试次数5次"],result:"NT",note:""},{testInfo:"添加样品",step:["登陆账户","添加样品和样品记录","测试次数5次"],result:"NT",note:""}],model_te:[{testInfo:"个人资料",step:["登陆账户","修改个人资料和密码后退出登陆","用新的密码登陆","核对修改好的个人资料","测试5次"],result:"NT",note:""},{testInfo:"我的群组",step:["登陆账户","添加一个新的群组","修改群名称和描述","删除本人并添加同一群组的所有成员","核对群组成员显示是否正确","删除新建群组","测试次数为5次"],result:"NT",note:""},{testInfo:"产品列表",step:["登陆账户","查询产品列表并核对","查询项目列表并核对","核对产品角色和成员","测试次数5次"],result:"NT",note:""},{testInfo:"订单列表",step:["登陆账户","查询订单","核对订单列表","下载测试软件","测试次数5次"],result:"NT",note:""},{testInfo:"添加样品",step:["登陆账户","添加样品和样品记录","测试次数5次"],result:"NT",note:""}],product_pmc:[{testInfo:"个人资料",step:["登陆账户","修改个人资料和密码后退出登陆","用新的密码登陆","核对修改好的个人资料","测试5次"],result:"NT",note:""},{testInfo:"我的群组",step:["登陆账户","添加一个新的群组","修改群名称和描述","删除本人并添加同一群组的所有成员","核对群组成员显示是否正确","删除新建群组","测试次数为5次"],result:"NT",note:""},{testInfo:"产品列表",step:["登陆账户","查询产品列表并核对","查询项目列表并核对","核对产品角色和成员","测试次数5次"],result:"NT",note:""},{testInfo:"创建订单",step:["登陆账户","创建新的订单","核对新订单列表","测试次数5次"],result:"NT",note:""},{testInfo:"订单列表",step:["登陆账户","查询订单","核对订单列表","进行在线和离线授权","测试次数5次"],result:"NT",note:""}],model_pmc:[{testInfo:"个人资料",step:["登陆账户","修改个人资料和密码后退出登陆","用新的密码登陆","核对修改好的个人资料","测试5次"],result:"NT",note:""},{testInfo:"我的群组",step:["登陆账户","添加一个新的群组","修改群名称和描述","删除本人并添加同一群组的所有成员","核对群组成员显示是否正确","删除新建群组","测试次数为5次"],result:"NT",note:""},{testInfo:"产品列表",step:["登陆账户","查询产品列表并核对","查询项目列表并核对","核对产品角色和成员","测试次数5次"],result:"NT",note:""},{testInfo:"创建订单",step:["登陆账户","创建新的订单","核对新订单列表","测试次数5次"],result:"NT",note:""},{testInfo:"订单列表",step:["登陆账户","查询订单","核对订单列表","进行在线和离线授权","测试次数5次"],result:"NT",note:""}],product_pe:[{testInfo:"个人资料",step:["登陆账户","修改个人资料和密码后退出登陆","用新的密码登陆","核对修改好的个人资料","测试5次"],result:"NT",note:""},{testInfo:"我的群组",step:["登陆账户","添加一个新的群组","修改群名称和描述","删除本人并添加同一群组的所有成员","核对群组成员显示是否正确","删除新建群组","测试次数为5次"],result:"NT",note:""},{testInfo:"订单列表",step:["登陆账户","查询订单","核对订单列表","下载测试软件","测试次数5次"],result:"NT",note:""}],model_pe:[{testInfo:"个人资料",step:["登陆账户","修改个人资料和密码后退出登陆","用新的密码登陆","核对修改好的个人资料","测试5次"],result:"NT",note:""},{testInfo:"我的群组",step:["登陆账户","添加一个新的群组","修改群名称和描述","删除本人并添加同一群组的所有成员","核对群组成员显示是否正确","删除新建群组","测试次数为5次"],result:"NT",note:""},{testInfo:"订单列表",step:["登陆账户","查询订单","核对订单列表","下载测试软件","测试次数5次"],result:"NT",note:""}],product_pj:[{testInfo:"个人资料",step:["登陆账户","修改个人资料和密码后退出登陆","用新的密码登陆","核对修改好的个人资料","测试5次"],result:"NT",note:""},{testInfo:"我的群组",step:["登陆账户","添加一个新的群组","修改群名称和描述","删除本人并添加同一群组的所有成员","核对群组成员显示是否正确","删除新建群组","测试次数为5次"],result:"NT",note:""},{testInfo:"产品列表",step:["登陆账户","查询产品列表并核对","查询项目列表并核对","核对产品项目成员","测试次数5次"],result:"NT",note:""},{testInfo:"订单列表",step:["登陆账户","查询订单","核对订单列表","测试次数5次"],result:"NT",note:""}],model_pj:[{testInfo:"个人资料",step:["登陆账户","修改个人资料和密码后退出登陆","用新的密码登陆","核对修改好的个人资料","测试5次"],result:"NT",note:""},{testInfo:"我的群组",step:["登陆账户","添加一个新的群组","修改群名称和描述","删除本人并添加同一群组的所有成员","核对群组成员显示是否正确","删除新建群组","测试次数为5次"],result:"NT",note:""},{testInfo:"产品列表",step:["登陆账户","查询产品列表并核对","查询项目列表并核对","核对产品项目成员","测试次数5次"],result:"NT",note:""},{testInfo:"订单列表",step:["登陆账户","查询订单","核对订单列表","测试次数5次"],result:"NT",note:""}],collectLogFile:[{testInfo:"单台测试PC",step:["从MPS订单的软件列表上下载MPTool到测试PC上","按测试架开始测试","测试完后5分钟左右在云平台后台日志存放目录查找是否有AGENT_<测试PC网卡MAC号>目录，且该目录下有.txt日志文件","如果3步骤正常，则对比服务器的.txt是否和测试PC上的.txt完全一致","测试10次"],result:"NT",note:""},{testInfo:"多台测试PC",step:["4台PC，每台4个测试架","每台测试PC测试步骤同单台测试PC的步骤","测试次数为200次"],result:"NT",note:""},{testInfo:"测试完立即关闭MPTool",step:["从MPS订单的软件列表上下载MPTool到测试PC上","按测试架开始测试","测试完后立即关闭MPTool","等待5分钟左右在云平台后台日志存放目录查找是否有AGENT_<测试PC网卡MAC号>目录，且该目录下有.txt日志文件","如果4步骤正常，则对比服务器的.txt是否和测试PC上的.txt完全一致","测试次数2次"],result:"NT",note:""},{testInfo:"断网测试",step:["从MPS订单的软件列表上下载MPTool到测试PC上","断掉测试PC  WIFI","按测试架开始测试","测试完后连接测试PC网络，2分钟左右在云平台生产记录查询页面是否可以查到与测试相同的条目","如果4步骤正常，则对比服务器的.txt是否和测试PC上的.txt完全一致","测试次数2次"],result:"NT",note:""}],collectLogRecord:[{testInfo:"单台测试PC",step:["从MPS订单的软件列表上下载MPTool到测试PC上","按测试架开始测试","测试完后2分钟左右在云平台生产记录查询页面是否可以查到与测试相同的条目","测试10次"],result:"NT",note:""},{testInfo:"多台测试PC",step:["4台PC，每台4个测试架","每台测试PC测试步骤同单台测试PC的步骤","测试次数为200次"],result:"NT",note:""},{testInfo:"测试完立即关闭MPTool",step:["从MPS订单的软件列表上下载MPTool到测试PC上","按测试架开始测试","测试完后立即关闭MPTool","测试完后2分钟左右在云平台生产记录查询页面是否可以查到与测试相同的条目","测试次数2次"],result:"NT",note:""},{testInfo:"断网测试",step:["从MPS订单的软件列表上下载MPTool到测试PC上","断掉测试PC  WIFI","按测试架开始测试","测试完后连接测试PC网络，2分钟左右在云平台生产记录查询页面是否可以查到与测试相同的条目","测试次数2次"],result:"NT",note:""}],offlineTest:[{testInfo:"登陆、查看订单(离线Key授权工具使用)",step:["填入云平台帐号密码点击登陆","无错误弹框出现，并可以在订单栏看到订单"],result:"NT",note:""},{testInfo:"查找设备(离线Key授权工具使用)",step:["插入Ukey","等待USB设备上盘点击查找设备","在设备盘符处出现Ukey在windows系统中的盘符"],result:"NT",note:""},{testInfo:"查看订单权限(离线Key授权工具使用)",step:["用两个用户登陆，其中一个在云平台可以查看到一个订单；另一个在云平台可以看到三个订单","在授权工具上登陆这两个帐号，看看显示的订单数是否能云平台上相同"],result:"NT",note:""},{testInfo:"授权(离线Key授权工具使用)",step:["登陆后，查找设备后，点击相应的订单，然后在申请数量填写一个数字","点击授权","使用Ukey到Mptool使用，查看离线剩余授权数是否和申请的一致","从云平台查看剩余离线授权总数是否与等于总离线授权总数和步骤3申请数量之差"],result:"NT",note:""},{testInfo:"正常使用",step:["从MPS订单的软件列表上下载MPTool到测试PC上","插上授权好的离线Key，断开测试PC网络","运行MPTool，查看Mptool下端离线授权数量","按测试架开始测试","查看测试是否正常进行，Mptool下端离线授权数量是否减了1个","测试10次"],result:"NT",note:""},{testInfo:"Ukey没授权数量",step:["从MPS订单的软件列表上下载MPTool到测试PC上","插上未授权好的离线Key，断开测试PC网络","运行MPTool，查看Mptool下端离线授权数量","按测试架开始测试","查看测试是否有弹出提示框“授权不足或验证失败”","测试1次"],result:"NT",note:""},{testInfo:"Ukey授权订单和MPTool配置订单不一致",step:["从MPS订单的软件列表上下载MPTool到测试PC上","插上授权好的离线Key（授权的是另一个订单），断开测试PC网络","运行MPTool，查看Mptool下端离线授权数量","按测试架开始测试","查看测试是否有弹出提示框“授权不足或验证失败","测试1次"],result:"NT",note:""},{testInfo:"离线在线授权切换",step:["从MPS订单的软件列表上下载MPTool到测试PC上","插上授权好的离线Key（授权的是另一个订单），断开测试PC网络","运行MPTool，查看Mptool下端离线授权数量","按测试架开始测试","Mptool下端离线授权数量是否减了1个","连上网络，按测试架开始测试","Mptool下端在线授权数量是否减了1个","再次断开网络依次测试","轮流测试6次"],result:"NT",note:""}],onlineTest:[{testInfo:"单台测试PC",step:["从MPS订单的软件列表上下载MPTool到测试PC上","确保测试连接网络正常，按测试架开始测试","测试完后5分钟左右在云平台后台日志存放目录查找是否有AGENT_<测试PC网卡MAC号>目录，且该目录下有.txt日志文件","查看测试是否正常进行，Mptool下端在线授权数量是否有减少1个","测试10次"],result:"NT",note:""},{testInfo:"多台测试PC",step:["4台PC，每台4个测试架","每台测试PC测试步骤同单台测试PC的步骤","观察Mptool下端在线授权数量是否有所减少","测试次数为200次"],result:"NT",note:"多台测试时，MPTool下端显示的剩余授权数量不是完全                            准确的，这是由于工具请求完授权显示数量在那里                            ，而另一台电脑去请求授权了，这个时候第一台电                            脑应该还没有进行下一次授权，所以没刷新，这个                            问题不好影响生产"}],pressureTest:[{testInfo:"获取授权API压力测试",step:["172.16.9.229服务器运行测试程序（229配置：24核CPU/32Gbytes内存）","测试程序运行3000个协程，每个线程不休眠持续完成一个向服务器取授权的动作","测试订单在线总授权数：10000000","跑完测试订单授权数约：900000","测试时间约11小时"],result:"NT",note:""}],result:""},activeName:"first",activeTestName:"0",activeFunName:"",activeRoleName:"0",testBtn:"开始测试",loading:!1}},methods:{go_back:function(){this.$router.back(-1)},testRole:function(e,t){var s=this;if(1==this.activeRoleName)var r={role:"产品-产品工程师",options:[{"个人资料":!1},{"我的群组":!1},{"添加项目":!1},{"产品列表":!1},{"订单列表":!1}]};if(2==this.activeRoleName)r={role:"项目-产品工程师",options:[{"个人资料":!1},{"我的群组":!1},{"产品列表":!1},{"订单列表":!1}]};if(3==this.activeRoleName)r={role:"产品-研发工程师",options:[{"个人资料":!1},{"我的群组":!1},{"产品列表":!1},{"订单列表":!1},{"添加样品":!1}]};if(4==this.activeRoleName)r={role:"项目-研发工程师",options:[{"个人资料":!1},{"我的群组":!1},{"产品列表":!1},{"订单列表":!1},{"添加样品":!1}]};if(5==this.activeRoleName)r={role:"产品-测试工程师",options:[{"个人资料":!1},{"我的群组":!1},{"产品列表":!1},{"订单列表":!1},{"添加样品":!1}]};if(6==this.activeRoleName)r={role:"项目-测试工程师",options:[{"个人资料":!1},{"我的群组":!1},{"产品列表":!1},{"订单列表":!1},{"添加样品":!1}]};if(7==this.activeRoleName)r={role:"产品-pmc",options:[{"个人资料":!1},{"我的群组":!1},{"产品列表":!1},{"创建订单":!1},{"订单列表":!1}]};if(8==this.activeRoleName)r={role:"项目-pmc",options:[{"个人资料":!1},{"我的群组":!1},{"产品列表":!1},{"创建订单":!1},{"订单列表":!1}]};if(9==this.activeRoleName)r={role:"产品-产线工程师",options:[{"个人资料":!1},{"我的群组":!1},{"订单列表":!1}]};if(10==this.activeRoleName)r={role:"项目-产线工程师",options:[{"个人资料":!1},{"我的群组":!1},{"订单列表":!1}]};if(11==this.activeRoleName)r={role:"产品-项目工程师",options:[{"个人资料":!1},{"我的群组":!1},{"产品列表":!1},{"订单列表":!1}]};if(12==this.activeRoleName)r={role:"项目-项目工程师",options:[{"个人资料":!1},{"我的群组":!1},{"产品列表":!1},{"订单列表":!1}]};for(var a=0;a<r.options.length;a++)e in r.options[a]&&(r.options[a][e]=!0);this.$confirm("1 请确认是否已打开浏览器服务端 </br>2 测试大约需几分钟请耐心等待 </br>3 即将开始 "+e+" 测试","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then(function(){s.$message({message:"测试开始",type:"success",center:!0}),s.loading=!0,s.testBtn="测试中...",s.axios({baseURL:s.url,url:"/api/v1/webAutoTest/",method:"patch",data:r}).then(function(e){e.data.errcode?(s.$message({message:e.data.errmsg,type:"error",center:!0,showClose:!0,duration:0}),t.result="FAIL"):(s.$message({message:e.data.errmsg,type:"success",center:!0,showClose:!0,duration:0}),t.result="PASS"),s.loading=!1,s.testBtn="开始测试"},function(e){s.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0,showClose:!0,duration:0}),t.result="FAIL",s.loading=!1,s.testBtn="开始测试"})}).catch(function(){})},handleDelete:function(e){var t={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/report/"+e+"/",method:"delete",params:t})},new_report:function(){var e=this;for(var t in this.mpcloudReport.version)if(!this.mpcloudReport.version[t])return void this.$message({message:t+" 版本不能为空",type:"error",center:!0});if(this.mpcloudReport.releaseNote)if(this.mpcloudReport.result){var s={project:this.projectId,user:this.userId,version:j()(this.mpcloudReport.version),releaseNote:this.mpcloudReport.releaseNote,result:this.mpcloudReport.result,allInfo:j()(this.mpcloudReport)},r={userId:this.userId,token:this.token};this.axios({baseURL:this.url,url:"api/v1/report/",method:"post",params:r,data:s}).then(function(t){if(t.data.errcode)e.$message({message:t.data.errmsg,type:"error",center:!0});else{var s=t.data.data.id,r=t.data.data.update_time,a=e.dateLogFormat(r),o={mpcloudReport:e.mpcloudReport,fileName:a},n={userId:e.userId,token:e.token};e.axios({baseURL:e.url,url:"api/v1/mpcloudExcel/",method:"post",params:n,data:o}).then(function(t){if(t.data.errcode)e.$message({message:t.data.errmsg,type:"error",center:!0}),e.handleDelete(s);else{e.$message({message:"创建成功",type:"success",center:!0});e.$router.push({path:"/home/report/",query:{}})}},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0}),e.handleDelete(s)})}},function(t){e.$message({message:"自动化测试平台异常，请检查网络",type:"error",center:!0})})}else this.$message({message:"测试结果汇总不能为空",type:"error",center:!0});else this.$message({message:"Release Note 不能为空",type:"error",center:!0})},dateLogFormat:function(e){var t=new Date(e);return t.getFullYear()+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+(t.getDate()<10?"0"+t.getDate():t.getDate())+(t.getHours()<10?"0"+t.getHours():t.getHours())+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())+".xlsx"}},created:function(){this.$route.query.allInfo&&(this.mpcloudReport=this.$route.query.allInfo)}},W={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",[s("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.go_back(t)}}},[s("i",{staticClass:"el-icon-d-arrow-left"}),e._v("返回上一级"),s("br"),s("br")]),e._v(" "),s("div",[e._v("项目："+e._s(this.$route.query.projectName))]),s("br"),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.new_report}},[e._v("提交")])],1),s("br"),e._v(" "),s("div",[s("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"平台版本",name:"first"}},[s("el-form",{attrs:{"label-position":"right","label-width":"150px",model:e.mpcloudReport}},[s("el-form-item",{attrs:{label:"量产云平台"}},[s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"如:V1.0 (必填)",width:"100"},model:{value:e.mpcloudReport.version["量产云平台"],callback:function(t){e.$set(e.mpcloudReport.version,"量产云平台",t)},expression:"mpcloudReport.version['量产云平台']"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"电流板"}},[s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"如:V1.0.1_190112 (必填)"},model:{value:e.mpcloudReport.version["电流板"],callback:function(t){e.$set(e.mpcloudReport.version,"电流板",t)},expression:"mpcloudReport.version['电流板']"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"MPTool"}},[s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"如:V1.2.0.4 (必填)"},model:{value:e.mpcloudReport.version.MPTool,callback:function(t){e.$set(e.mpcloudReport.version,"MPTool",t)},expression:"mpcloudReport.version['MPTool']"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"离线Key授权工具"}},[s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"如:V1.1.3.0 (必填)"},model:{value:e.mpcloudReport.version["离线Key授权工具"],callback:function(t){e.$set(e.mpcloudReport.version,"离线Key授权工具",t)},expression:"mpcloudReport.version['离线Key授权工具']"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"syncAgent"}},[s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"如:V0.0.11 (必填)"},model:{value:e.mpcloudReport.version.syncAgent,callback:function(t){e.$set(e.mpcloudReport.version,"syncAgent",t)},expression:"mpcloudReport.version['syncAgent']"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"TransferStation"}},[s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"如:V0.0.01 (必填)"},model:{value:e.mpcloudReport.version.transferStation,callback:function(t){e.$set(e.mpcloudReport.version,"transferStation",t)},expression:"mpcloudReport.version['transferStation']"}})],1)],1)],1)],1),e._v(" "),s("el-tab-pane",{attrs:{label:"Release Note",name:"second"}},[s("el-input",{attrs:{type:"textarea",rows:15,placeholder:"请输入Release Note (必填)"},model:{value:e.mpcloudReport.releaseNote,callback:function(t){e.$set(e.mpcloudReport,"releaseNote",t)},expression:"mpcloudReport.releaseNote"}})],1),e._v(" "),s("el-tab-pane",{attrs:{label:"测试汇总",name:"third"}},[s("el-collapse",{attrs:{accordion:""},model:{value:e.activeTestName,callback:function(t){e.activeTestName=t},expression:"activeTestName"}},[s("el-collapse-item",{attrs:{title:"权限测试",name:"1"}},[s("el-collapse",{staticClass:"funtest",attrs:{accordion:""},model:{value:e.activeRoleName,callback:function(t){e.activeRoleName=t},expression:"activeRoleName"}},[s("el-collapse-item",{attrs:{title:"产品-产品经理",name:"1"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mpcloudReport.product_pm,border:""}},[s("el-table-column",{attrs:{prop:"testInfo",label:"测试内容",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"step",label:"测试步骤"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.step,function(t,r){return s("div",{key:r},[e._v("\n                                                "+e._s(r+1)+"."+e._s(t)+"\n                                            ")])})}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"result",label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-col",{attrs:{span:6}},[s("el-select",{class:{pass:"PASS"==t.row.result,fail:"FAIL"==t.row.result},attrs:{placeholder:"必填"},model:{value:t.row.result,callback:function(s){e.$set(t.row,"result",s)},expression:"scope.row.result"}},e._l(["PASS","FAIL"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:5,offset:1}},[s("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(s){return e.testRole(t.row.testInfo,t.row)}}},[e._v(e._s(e.testBtn))])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"note",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"选填"},model:{value:t.row.note,callback:function(s){e.$set(t.row,"note",s)},expression:"scope.row.note"}})]}}])})],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"项目-产品经理",name:"2"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mpcloudReport.model_pm,border:""}},[s("el-table-column",{attrs:{prop:"testInfo",label:"测试内容",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"step",label:"测试步骤"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.step,function(t,r){return s("div",{key:r},[e._v("\n                                                "+e._s(r+1)+"."+e._s(t)+"\n                                            ")])})}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"result",label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-col",{attrs:{span:6}},[s("el-select",{class:{pass:"PASS"==t.row.result,fail:"FAIL"==t.row.result},attrs:{placeholder:"必填"},model:{value:t.row.result,callback:function(s){e.$set(t.row,"result",s)},expression:"scope.row.result"}},e._l(["PASS","FAIL"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:5,offset:1}},[s("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(s){return e.testRole(t.row.testInfo,t.row)}}},[e._v(e._s(e.testBtn))])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"note",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"选填"},model:{value:t.row.note,callback:function(s){e.$set(t.row,"note",s)},expression:"scope.row.note"}})]}}])})],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"产品-研发工程师",name:"3"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mpcloudReport.product_rd,border:""}},[s("el-table-column",{attrs:{prop:"testInfo",label:"测试内容",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"step",label:"测试步骤"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.step,function(t,r){return s("div",{key:r},[e._v("\n                                                "+e._s(r+1)+"."+e._s(t)+"\n                                            ")])})}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"result",label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-col",{attrs:{span:6}},[s("el-select",{class:{pass:"PASS"==t.row.result,fail:"FAIL"==t.row.result},attrs:{placeholder:"必填"},model:{value:t.row.result,callback:function(s){e.$set(t.row,"result",s)},expression:"scope.row.result"}},e._l(["PASS","FAIL"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:5,offset:1}},[s("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(s){return e.testRole(t.row.testInfo,t.row)}}},[e._v(e._s(e.testBtn))])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"note",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"选填"},model:{value:t.row.note,callback:function(s){e.$set(t.row,"note",s)},expression:"scope.row.note"}})]}}])})],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"项目-研发工程师",name:"4"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mpcloudReport.model_rd,border:""}},[s("el-table-column",{attrs:{prop:"testInfo",label:"测试内容",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"step",label:"测试步骤"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.step,function(t,r){return s("div",{key:r},[e._v("\n                                                "+e._s(r+1)+"."+e._s(t)+"\n                                            ")])})}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"result",label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-col",{attrs:{span:6}},[s("el-select",{class:{pass:"PASS"==t.row.result,fail:"FAIL"==t.row.result},attrs:{placeholder:"必填"},model:{value:t.row.result,callback:function(s){e.$set(t.row,"result",s)},expression:"scope.row.result"}},e._l(["PASS","FAIL"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:5,offset:1}},[s("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(s){return e.testRole(t.row.testInfo,t.row)}}},[e._v(e._s(e.testBtn))])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"note",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"选填"},model:{value:t.row.note,callback:function(s){e.$set(t.row,"note",s)},expression:"scope.row.note"}})]}}])})],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"产品-测试工程师",name:"5"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mpcloudReport.product_te,border:""}},[s("el-table-column",{attrs:{prop:"testInfo",label:"测试内容",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"step",label:"测试步骤"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.step,function(t,r){return s("div",{key:r},[e._v("\n                                                "+e._s(r+1)+"."+e._s(t)+"\n                                            ")])})}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"result",label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-col",{attrs:{span:6}},[s("el-select",{class:{pass:"PASS"==t.row.result,fail:"FAIL"==t.row.result},attrs:{placeholder:"必填"},model:{value:t.row.result,callback:function(s){e.$set(t.row,"result",s)},expression:"scope.row.result"}},e._l(["PASS","FAIL"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:5,offset:1}},[s("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(s){return e.testRole(t.row.testInfo,t.row)}}},[e._v(e._s(e.testBtn))])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"note",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"选填"},model:{value:t.row.note,callback:function(s){e.$set(t.row,"note",s)},expression:"scope.row.note"}})]}}])})],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"项目-测试工程师",name:"6"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mpcloudReport.model_te,border:""}},[s("el-table-column",{attrs:{prop:"testInfo",label:"测试内容",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"step",label:"测试步骤"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.step,function(t,r){return s("div",{key:r},[e._v("\n                                                "+e._s(r+1)+"."+e._s(t)+"\n                                            ")])})}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"result",label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-col",{attrs:{span:6}},[s("el-select",{class:{pass:"PASS"==t.row.result,fail:"FAIL"==t.row.result},attrs:{placeholder:"必填"},model:{value:t.row.result,callback:function(s){e.$set(t.row,"result",s)},expression:"scope.row.result"}},e._l(["PASS","FAIL"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:5,offset:1}},[s("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(s){return e.testRole(t.row.testInfo,t.row)}}},[e._v(e._s(e.testBtn))])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"note",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"选填"},model:{value:t.row.note,callback:function(s){e.$set(t.row,"note",s)},expression:"scope.row.note"}})]}}])})],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"产品-PMC",name:"7"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mpcloudReport.product_pmc,border:""}},[s("el-table-column",{attrs:{prop:"testInfo",label:"测试内容",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"step",label:"测试步骤"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.step,function(t,r){return s("div",{key:r},[e._v("\n                                                "+e._s(r+1)+"."+e._s(t)+"\n                                            ")])})}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"result",label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-col",{attrs:{span:6}},[s("el-select",{class:{pass:"PASS"==t.row.result,fail:"FAIL"==t.row.result},attrs:{placeholder:"必填"},model:{value:t.row.result,callback:function(s){e.$set(t.row,"result",s)},expression:"scope.row.result"}},e._l(["PASS","FAIL"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:5,offset:1}},[s("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(s){return e.testRole(t.row.testInfo,t.row)}}},[e._v(e._s(e.testBtn))])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"note",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"选填"},model:{value:t.row.note,callback:function(s){e.$set(t.row,"note",s)},expression:"scope.row.note"}})]}}])})],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"项目-PMC",name:"8"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mpcloudReport.model_pmc,border:""}},[s("el-table-column",{attrs:{prop:"testInfo",label:"测试内容",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"step",label:"测试步骤"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.step,function(t,r){return s("div",{key:r},[e._v("\n                                                "+e._s(r+1)+"."+e._s(t)+"\n                                            ")])})}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"result",label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-col",{attrs:{span:6}},[s("el-select",{class:{pass:"PASS"==t.row.result,fail:"FAIL"==t.row.result},attrs:{placeholder:"必填"},model:{value:t.row.result,callback:function(s){e.$set(t.row,"result",s)},expression:"scope.row.result"}},e._l(["PASS","FAIL"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:5,offset:1}},[s("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(s){return e.testRole(t.row.testInfo,t.row)}}},[e._v(e._s(e.testBtn))])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"note",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"选填"},model:{value:t.row.note,callback:function(s){e.$set(t.row,"note",s)},expression:"scope.row.note"}})]}}])})],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"产品-产线工程师",name:"9"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mpcloudReport.product_pe,border:""}},[s("el-table-column",{attrs:{prop:"testInfo",label:"测试内容",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"step",label:"测试步骤"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.step,function(t,r){return s("div",{key:r},[e._v("\n                                                "+e._s(r+1)+"."+e._s(t)+"\n                                            ")])})}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"result",label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-col",{attrs:{span:6}},[s("el-select",{class:{pass:"PASS"==t.row.result,fail:"FAIL"==t.row.result},attrs:{placeholder:"必填"},model:{value:t.row.result,callback:function(s){e.$set(t.row,"result",s)},expression:"scope.row.result"}},e._l(["PASS","FAIL"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:5,offset:1}},[s("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(s){return e.testRole(t.row.testInfo,t.row)}}},[e._v(e._s(e.testBtn))])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"note",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"选填"},model:{value:t.row.note,callback:function(s){e.$set(t.row,"note",s)},expression:"scope.row.note"}})]}}])})],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"项目-产线工程师",name:"10"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mpcloudReport.model_pe,border:""}},[s("el-table-column",{attrs:{prop:"testInfo",label:"测试内容",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"step",label:"测试步骤"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.step,function(t,r){return s("div",{key:r},[e._v("\n                                                "+e._s(r+1)+"."+e._s(t)+"\n                                            ")])})}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"result",label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-col",{attrs:{span:6}},[s("el-select",{class:{pass:"PASS"==t.row.result,fail:"FAIL"==t.row.result},attrs:{placeholder:"必填"},model:{value:t.row.result,callback:function(s){e.$set(t.row,"result",s)},expression:"scope.row.result"}},e._l(["PASS","FAIL"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:5,offset:1}},[s("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(s){return e.testRole(t.row.testInfo,t.row)}}},[e._v(e._s(e.testBtn))])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"note",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"选填"},model:{value:t.row.note,callback:function(s){e.$set(t.row,"note",s)},expression:"scope.row.note"}})]}}])})],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"产品-项目工程师",name:"11"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mpcloudReport.product_pj,border:""}},[s("el-table-column",{attrs:{prop:"testInfo",label:"测试内容",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"step",label:"测试步骤"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.step,function(t,r){return s("div",{key:r},[e._v("\n                                                "+e._s(r+1)+"."+e._s(t)+"\n                                            ")])})}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"result",label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-col",{attrs:{span:6}},[s("el-select",{class:{pass:"PASS"==t.row.result,fail:"FAIL"==t.row.result},attrs:{placeholder:"必填"},model:{value:t.row.result,callback:function(s){e.$set(t.row,"result",s)},expression:"scope.row.result"}},e._l(["PASS","FAIL"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:5,offset:1}},[s("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(s){return e.testRole(t.row.testInfo,t.row)}}},[e._v(e._s(e.testBtn))])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"note",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"选填"},model:{value:t.row.note,callback:function(s){e.$set(t.row,"note",s)},expression:"scope.row.note"}})]}}])})],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"项目-项目工程师",name:"12"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mpcloudReport.model_pj,border:""}},[s("el-table-column",{attrs:{prop:"testInfo",label:"测试内容",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"step",label:"测试步骤"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.step,function(t,r){return s("div",{key:r},[e._v("\n                                                "+e._s(r+1)+"."+e._s(t)+"\n                                            ")])})}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"result",label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-col",{attrs:{span:6}},[s("el-select",{class:{pass:"PASS"==t.row.result,fail:"FAIL"==t.row.result},attrs:{placeholder:"必填"},model:{value:t.row.result,callback:function(s){e.$set(t.row,"result",s)},expression:"scope.row.result"}},e._l(["PASS","FAIL"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:5,offset:1}},[s("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(s){return e.testRole(t.row.testInfo,t.row)}}},[e._v(e._s(e.testBtn))])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"note",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"选填"},model:{value:t.row.note,callback:function(s){e.$set(t.row,"note",s)},expression:"scope.row.note"}})]}}])})],1)],1)],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"功能测试",name:"2"}},[s("el-collapse",{staticClass:"funtest",attrs:{accordion:""},model:{value:e.activeFunName,callback:function(t){e.activeFunName=t},expression:"activeFunName"}},[s("el-collapse-item",{attrs:{title:"收集生产日志文件",name:"1"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mpcloudReport.collectLogFile,border:""}},[s("el-table-column",{attrs:{prop:"testInfo",label:"测试内容",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"step",label:"测试步骤"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.step,function(t,r){return s("div",{key:r},[e._v("\n                                                "+e._s(r+1)+"."+e._s(t)+"\n                                            ")])})}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"result",label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-col",{attrs:{span:10}},[s("el-select",{class:{pass:"PASS"==t.row.result,fail:"FAIL"==t.row.result},attrs:{placeholder:"必填"},model:{value:t.row.result,callback:function(s){e.$set(t.row,"result",s)},expression:"scope.row.result"}},e._l(["PASS","FAIL"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"note",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"选填"},model:{value:t.row.note,callback:function(s){e.$set(t.row,"note",s)},expression:"scope.row.note"}})]}}])})],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"收集生产记录功能",name:"2"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mpcloudReport.collectLogRecord,border:""}},[s("el-table-column",{attrs:{prop:"testInfo",label:"测试内容",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"step",label:"测试步骤"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.step,function(t,r){return s("div",{key:r},[e._v("\n                                                "+e._s(r+1)+"."+e._s(t)+"\n                                            ")])})}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"result",label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-col",{attrs:{span:10}},[s("el-select",{class:{pass:"PASS"==t.row.result,fail:"FAIL"==t.row.result},attrs:{placeholder:"必填"},model:{value:t.row.result,callback:function(s){e.$set(t.row,"result",s)},expression:"scope.row.result"}},e._l(["PASS","FAIL"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"note",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"选填"},model:{value:t.row.note,callback:function(s){e.$set(t.row,"note",s)},expression:"scope.row.note"}})]}}])})],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"离线授权测试",name:"3"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mpcloudReport.offlineTest,border:""}},[s("el-table-column",{attrs:{prop:"testInfo",label:"测试内容",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"step",label:"测试步骤"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.step,function(t,r){return s("div",{key:r},[e._v("\n                                                "+e._s(r+1)+"."+e._s(t)+"\n                                            ")])})}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"result",label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-col",{attrs:{span:10}},[s("el-select",{class:{pass:"PASS"==t.row.result,fail:"FAIL"==t.row.result},attrs:{placeholder:"必填"},model:{value:t.row.result,callback:function(s){e.$set(t.row,"result",s)},expression:"scope.row.result"}},e._l(["PASS","FAIL"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"note",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"选填"},model:{value:t.row.note,callback:function(s){e.$set(t.row,"note",s)},expression:"scope.row.note"}})]}}])})],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"在线授权测试",name:"4"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mpcloudReport.onlineTest,border:""}},[s("el-table-column",{attrs:{prop:"testInfo",label:"测试内容",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"step",label:"测试步骤"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.step,function(t,r){return s("div",{key:r},[e._v("\n                                                "+e._s(r+1)+"."+e._s(t)+"\n                                            ")])})}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"result",label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-col",{attrs:{span:10}},[s("el-select",{class:{pass:"PASS"==t.row.result,fail:"FAIL"==t.row.result},attrs:{placeholder:"必填"},model:{value:t.row.result,callback:function(s){e.$set(t.row,"result",s)},expression:"scope.row.result"}},e._l(["PASS","FAIL"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"note",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"选填"},model:{value:t.row.note,callback:function(s){e.$set(t.row,"note",s)},expression:"scope.row.note"}})]}}])})],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"中转软件测试",name:"5"}},[s("p",[e._v("以上测试都是使用中转软件转发的方案以和工厂的网络模式匹配")])])],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"压力测试",name:"3"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.mpcloudReport.pressureTest,border:""}},[s("el-table-column",{attrs:{prop:"testInfo",label:"测试内容",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"step",label:"测试步骤"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.step,function(t,r){return s("div",{key:r},[e._v("\n                                        "+e._s(r+1)+"."+e._s(t)+"\n                                    ")])})}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"result",label:"测试结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-col",{attrs:{span:10}},[s("el-select",{class:{pass:"PASS"==t.row.result,fail:"FAIL"==t.row.result},attrs:{placeholder:"必填"},model:{value:t.row.result,callback:function(s){e.$set(t.row,"result",s)},expression:"scope.row.result"}},e._l(["PASS","FAIL"],function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"note",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"选填"},model:{value:t.row.note,callback:function(s){e.$set(t.row,"note",s)},expression:"scope.row.note"}})]}}])})],1)],1),e._v(" "),s("el-collapse-item",{attrs:{title:"测试结果汇总",name:"4"}},[s("el-input",{attrs:{type:"textarea",placeholder:"必填（如：此次测试通过，该版本符合量产要求）"},model:{value:e.mpcloudReport.result,callback:function(t){e.$set(e.mpcloudReport,"result",t)},expression:"mpcloudReport.result"}})],1)],1)],1)],1)],1)])},staticRenderFns:[]};var K=s("VU/8")(J,W,!1,function(e){s("GAJ5")},"data-v-19b87d80",null).exports;r.default.use(n.a);var Y=new n.a({routes:[{path:"/",redirect:"/login/"},{path:"/login/",name:"Login",component:c},{path:"/home/",component:p,children:[{path:"",redirect:"user"},{path:"user",component:m},{path:"project",component:v},{path:"webManager/:projectId?",component:w},{path:"apiManager/:projectId?",component:I},{path:"apiCase/:apiManagerId?",component:P},{path:"webCase/:webManagerId?",component:R},{path:"webType/",component:M},{path:"apiType/",component:B},{path:"log/",component:V},{path:"report",component:E},{path:"mpcloud/",component:K}]}]}),G=s("zL8q"),X=s.n(G),Z=(s("tvR6"),s("mtWM")),Q=s.n(Z),ee=(s("CuRo"),s("7xIN"),s("vO7p")),te=s.n(ee);r.default.use(X.a),r.default.use(te.a),r.default.config.productionTip=!1,r.default.prototype.url="http://172.16.9.88/",r.default.prototype.axios=Q.a,r.default.prototype.storage=window.localStorage,r.default.prototype.path="",new r.default({el:"#app",router:Y,components:{App:o},template:"<App/>"})},X8Ss:function(e,t){},adur:function(e,t){},asmU:function(e,t){},tMnE:function(e,t){},tvR6:function(e,t){},"xzo/":function(e,t,s){e.exports=s.p+"static/img/login-img.ca4e6fe.png"}},["NHnr"]);
//# sourceMappingURL=app.d95172a92235c211397c.js.map